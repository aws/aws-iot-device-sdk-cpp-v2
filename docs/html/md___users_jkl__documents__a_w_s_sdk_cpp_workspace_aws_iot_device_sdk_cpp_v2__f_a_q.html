<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS IoT Device SDK C++ v2: Frequently Asked Questions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Device SDK C++ v2<span id="projectnumber">&#160;1.14.0</span>
   </div>
   <div id="projectbrief">AWS IoT Device SDK C++ v2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Frequently Asked Questions </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md14"></a>
Where should I start?</h2>
<p >If you are just getting started make sure you <a href="https://github.com/aws/aws-iot-device-sdk-cpp-v2#installation">install this sdk</a> and then build and run the <a href="https://github.com/aws/aws-iot-device-sdk-cpp-v2/tree/main/samples#basic-mqtt-pub-sub">basic PubSub</a></p>
<h2><a class="anchor" id="autotoc_md15"></a>
I keep getting AWS_ERROR_MQTT_UNEXPECTED_HANGUP</h2>
<p >This could be many different things but it most likely is a policy issue. Start with using a super permissive IAM policy called AWSIOTFullAccess which looks like this:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;Version&quot;: &quot;2012-10-17&quot;,</div>
<div class="line">    &quot;Statement&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;Effect&quot;: &quot;Allow&quot;,</div>
<div class="line">            &quot;Action&quot;: [</div>
<div class="line">                &quot;iot:*&quot;</div>
<div class="line">            ],</div>
<div class="line">            &quot;Resource&quot;: &quot;*&quot;</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><p >After getting it working make sure to only allow the actions and resources that you need. More info about IoT IAM policies can be found <a href="https://docs.aws.amazon.com/iot/latest/developerguide/security_iam_service-with-iam.html">here</a>.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Dependencies are bad.</h2>
<p >If you get the following Error: </p><div class="fragment"><div class="line">CMake Error at CMakeLists.txt:46 (include):</div>
<div class="line"> include could not find load file:</div>
<div class="line">  AwsFindPackage</div>
</div><!-- fragment --><p> Make sure to use <code>--recursive</code> in the git clone command</p>
<p ><code>git clone --recursive <a href="https://github.com/aws/aws-iot-device-sdk-cpp-v2.git">https://github.com/aws/aws-iot-device-sdk-cpp-v2.git</a></code></p>
<h2><a class="anchor" id="autotoc_md17"></a>
Detecting connection loss (tldr use keepAliveTimeSecs and pingTimeoutMs)</h2>
<p >There are 3 mechanisms for detecting connection loss:</p><ol type="1">
<li>The keepAliveTimeSecs and pingTimeoutMs arguments passed to MqttConnection::Connect(). These control how often the SDK sends a PINGREQ, and how long the SDK will wait for a PINGRESP before assuming the connection is lost. YOU SHOULD USE THIS TO RELIABLY DETECT CONNECTION LOSS.</li>
<li>If the OS socket says it's closed, the SDK immediately tries to reconnect. The timing of this is not reliable, it depends on the OS and how the connection is lost, it can take many minutes.</li>
<li>The various TcpKeepAlive controls on the MqttClientConnectionConfigBuilder. These control a similar mechanism at the TCP layer, rather than the MQTT layer, but is implemented in the OS and behavior may vary across platforms</li>
</ol>
<h2><a class="anchor" id="autotoc_md18"></a>
How to use a Pre-Built aws-crt-cpp (Most useful for development of this package)</h2>
<div class="fragment"><div class="line">mkdir aws-iot-device-sdk-cpp-v2-build</div>
<div class="line">cd aws-iot-device-sdk-cpp-v2-build</div>
<div class="line">cmake -DCMAKE_INSTALL_PREFIX=&quot;&lt;absolute path sdk-cpp-workspace dir&gt;&quot;  -DCMAKE_PREFIX_PATH=&quot;&lt;absolute path sdk-cpp-workspace dir&gt;&quot; -DBUILD_DEPS=OFF ../aws-iot-device-sdk-cpp-v2</div>
<div class="line">cmake --build . --target install</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md19"></a>
Mac-Only TLS Behavior</h2>
<p >Please note that on Mac, once a private key is used with a certificate, that certificate-key pair is imported into the Mac Keychain. All subsequent uses of that certificate will use the stored private key and ignore anything passed in programmatically. Beginning in v1.7.3, when a stored private key from the Keychain is used, the following will be logged at the "info" log level:</p>
<div class="fragment"><div class="line">static: certificate has an existing certificate-key pair that was previously imported into the Keychain.  Using key from Keychain instead of the one provided.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
