<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS IoT Device SDK C++ v2: crt/aws-crt-cpp/crt/s2n/tls/s2n_x509_validator.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Device SDK C++ v2<span id="projectnumber">&#160;1.14.0</span>
   </div>
   <div id="projectbrief">AWS IoT Device SDK C++ v2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_affb495f978f3575eca2eeb81eb7736b.html">crt</a></li><li class="navelem"><a class="el" href="dir_eb065311872385a3a1227a6ede2c108c.html">aws-crt-cpp</a></li><li class="navelem"><a class="el" href="dir_c68d83f7493c97e50c45ec06f21e3081.html">crt</a></li><li class="navelem"><a class="el" href="dir_86803797a27855cb00fc6184eb5aafb0.html">s2n</a></li><li class="navelem"><a class="el" href="dir_9e57a4b02e75e23acd816280c5b4869d.html">tls</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">s2n_x509_validator.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="s2n__openssl_8h_source.html">crypto/s2n_openssl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="s2n__openssl__x509_8h_source.html">crypto/s2n_openssl_x509.h</a>&quot;</code><br />
<code>#include &quot;utils/s2n_asn1_time.h&quot;</code><br />
<code>#include &quot;utils/s2n_result.h&quot;</code><br />
<code>#include &quot;utils/s2n_safety.h&quot;</code><br />
<code>#include &quot;utils/s2n_rfc5952.h&quot;</code><br />
<code>#include &quot;<a class="el" href="s2n__extension__list_8h_source.html">tls/extensions/s2n_extension_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="s2n__config_8h_source.html">tls/s2n_config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="s2n__connection_8h_source.html">tls/s2n_connection.h</a>&quot;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;sys/socket.h&gt;</code><br />
<code>#include &lt;openssl/err.h&gt;</code><br />
<code>#include &lt;openssl/asn1.h&gt;</code><br />
<code>#include &lt;openssl/ocsp.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a471f0fe074ef5c1620ad661086249dbb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a471f0fe074ef5c1620ad661086249dbb">X509_V_FLAG_PARTIAL_CHAIN</a>&#160;&#160;&#160;0x80000</td></tr>
<tr class="separator:a471f0fe074ef5c1620ad661086249dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0b0a7ec728adf09e312a414898a5ff1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#ad0b0a7ec728adf09e312a414898a5ff1">DEFAULT_MAX_CHAIN_DEPTH</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:ad0b0a7ec728adf09e312a414898a5ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d4d7f73e12c4a07000db10fa16033b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a9d4d7f73e12c4a07000db10fa16033b1">DEFAULT_OCSP_NEXT_UPDATE_PERIOD</a>&#160;&#160;&#160;3600000000000</td></tr>
<tr class="separator:a9d4d7f73e12c4a07000db10fa16033b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:abfd35f225f4b7fc495ebb1c5f7976ffc"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#abfd35f225f4b7fc495ebb1c5f7976ffc">validator_state</a> { <a class="el" href="s2n__x509__validator_8c.html#abfd35f225f4b7fc495ebb1c5f7976ffca2a68f51b73db179a30b6a8aea11f7485">UNINIT</a>
, <a class="el" href="s2n__x509__validator_8c.html#abfd35f225f4b7fc495ebb1c5f7976ffca0cb1b2c6a7db1f1084886c98909a3f36">INIT</a>
, <a class="el" href="s2n__x509__validator_8c.html#abfd35f225f4b7fc495ebb1c5f7976ffca8daa9f7da396ee1daa4747035feff4ec">VALIDATED</a>
, <a class="el" href="s2n__x509__validator_8c.html#abfd35f225f4b7fc495ebb1c5f7976ffca0ee8a0c210661d337874478738885da9">OCSP_VALIDATED</a>
 }</td></tr>
<tr class="separator:abfd35f225f4b7fc495ebb1c5f7976ffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a288e4c79746a86e09ee8a398bb14c512"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a288e4c79746a86e09ee8a398bb14c512">s2n_x509_ocsp_stapling_supported</a> (void)</td></tr>
<tr class="separator:a288e4c79746a86e09ee8a398bb14c512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9420691912d2b27885e752cf5e3a255d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a9420691912d2b27885e752cf5e3a255d">s2n_x509_trust_store_init_empty</a> (struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *store)</td></tr>
<tr class="separator:a9420691912d2b27885e752cf5e3a255d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab79d51c6a30bb86a6ff1ac773d0e38ea"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#ab79d51c6a30bb86a6ff1ac773d0e38ea">s2n_x509_trust_store_has_certs</a> (struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *store)</td></tr>
<tr class="separator:ab79d51c6a30bb86a6ff1ac773d0e38ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f058ecf0f93d94b6eecb634050be58"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#ab1f058ecf0f93d94b6eecb634050be58">s2n_x509_trust_store_from_system_defaults</a> (struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *store)</td></tr>
<tr class="separator:ab1f058ecf0f93d94b6eecb634050be58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d1721ad7ba85938d51914e70ab93d64"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a9d1721ad7ba85938d51914e70ab93d64">s2n_x509_trust_store_add_pem</a> (struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *store, const char *pem)</td></tr>
<tr class="separator:a9d1721ad7ba85938d51914e70ab93d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f94f7855f8de1ba96cf0358ec9d69d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a02f94f7855f8de1ba96cf0358ec9d69d">s2n_x509_trust_store_from_ca_file</a> (struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *store, const char *ca_pem_filename, const char *ca_dir)</td></tr>
<tr class="separator:a02f94f7855f8de1ba96cf0358ec9d69d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad80262ea13eecda7dbec5812576dc732"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#ad80262ea13eecda7dbec5812576dc732">s2n_x509_trust_store_wipe</a> (struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *store)</td></tr>
<tr class="separator:ad80262ea13eecda7dbec5812576dc732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c01448c0eba6f3da070efca52a9beb1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a3c01448c0eba6f3da070efca52a9beb1">s2n_x509_validator_init_no_x509_validation</a> (struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *validator)</td></tr>
<tr class="separator:a3c01448c0eba6f3da070efca52a9beb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14de21f9d6b7b411e1eee66a98d64feb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a14de21f9d6b7b411e1eee66a98d64feb">s2n_x509_validator_init</a> (struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *validator, struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *trust_store, uint8_t check_ocsp)</td></tr>
<tr class="separator:a14de21f9d6b7b411e1eee66a98d64feb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bb65909f7e2156383aeb1c9d03b49c8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a2bb65909f7e2156383aeb1c9d03b49c8">wipe_cert_chain</a> (STACK_OF(X509) *cert_chain)</td></tr>
<tr class="separator:a2bb65909f7e2156383aeb1c9d03b49c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9cb1ed3f0786296ad988185adce278"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a7a9cb1ed3f0786296ad988185adce278">s2n_x509_validator_wipe</a> (struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *validator)</td></tr>
<tr class="separator:a7a9cb1ed3f0786296ad988185adce278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4f3e82ce716b7f639c01dfa333c5b10"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#ae4f3e82ce716b7f639c01dfa333c5b10">s2n_x509_validator_set_max_chain_depth</a> (struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *validator, uint16_t max_depth)</td></tr>
<tr class="separator:ae4f3e82ce716b7f639c01dfa333c5b10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade587be2414188b349cb89c0b94b4b1c"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#ade587be2414188b349cb89c0b94b4b1c">s2n_verify_host_information</a> (struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *validator, struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, X509 *public_cert)</td></tr>
<tr class="separator:ade587be2414188b349cb89c0b94b4b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f135290f89f1c43d55f9b7667543aca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="s2n__x509__validator_8h.html#a9a57c107b797f4467cbc9f5d359e4145">s2n_cert_validation_code</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a3f135290f89f1c43d55f9b7667543aca">s2n_x509_validator_validate_cert_chain</a> (struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *validator, struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, uint8_t *cert_chain_in, uint32_t cert_chain_len, <a class="el" href="s2n__pkey_8h.html#a9f8ffb59dc71a9fab8e636972279d441">s2n_pkey_type</a> *pkey_type, struct <a class="el" href="structs2n__pkey.html">s2n_pkey</a> *public_key_out)</td></tr>
<tr class="separator:a3f135290f89f1c43d55f9b7667543aca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed4a60b0e3393d1c7d0fb0399a348f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="s2n__x509__validator_8h.html#a9a57c107b797f4467cbc9f5d359e4145">s2n_cert_validation_code</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__x509__validator_8c.html#a0ed4a60b0e3393d1c7d0fb0399a348f6">s2n_x509_validator_validate_cert_stapled_ocsp_response</a> (struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *validator, struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, const uint8_t *ocsp_response_raw, uint32_t ocsp_response_length)</td></tr>
<tr class="separator:a0ed4a60b0e3393d1c7d0fb0399a348f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad0b0a7ec728adf09e312a414898a5ff1" name="ad0b0a7ec728adf09e312a414898a5ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0b0a7ec728adf09e312a414898a5ff1">&#9670;&nbsp;</a></span>DEFAULT_MAX_CHAIN_DEPTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_MAX_CHAIN_DEPTH&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9d4d7f73e12c4a07000db10fa16033b1" name="a9d4d7f73e12c4a07000db10fa16033b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d4d7f73e12c4a07000db10fa16033b1">&#9670;&nbsp;</a></span>DEFAULT_OCSP_NEXT_UPDATE_PERIOD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_OCSP_NEXT_UPDATE_PERIOD&#160;&#160;&#160;3600000000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a471f0fe074ef5c1620ad661086249dbb" name="a471f0fe074ef5c1620ad661086249dbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a471f0fe074ef5c1620ad661086249dbb">&#9670;&nbsp;</a></span>X509_V_FLAG_PARTIAL_CHAIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define X509_V_FLAG_PARTIAL_CHAIN&#160;&#160;&#160;0x80000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="abfd35f225f4b7fc495ebb1c5f7976ffc" name="abfd35f225f4b7fc495ebb1c5f7976ffc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfd35f225f4b7fc495ebb1c5f7976ffc">&#9670;&nbsp;</a></span>validator_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="s2n__x509__validator_8c.html#abfd35f225f4b7fc495ebb1c5f7976ffc">validator_state</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="abfd35f225f4b7fc495ebb1c5f7976ffca2a68f51b73db179a30b6a8aea11f7485" name="abfd35f225f4b7fc495ebb1c5f7976ffca2a68f51b73db179a30b6a8aea11f7485"></a>UNINIT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abfd35f225f4b7fc495ebb1c5f7976ffca0cb1b2c6a7db1f1084886c98909a3f36" name="abfd35f225f4b7fc495ebb1c5f7976ffca0cb1b2c6a7db1f1084886c98909a3f36"></a>INIT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abfd35f225f4b7fc495ebb1c5f7976ffca8daa9f7da396ee1daa4747035feff4ec" name="abfd35f225f4b7fc495ebb1c5f7976ffca8daa9f7da396ee1daa4747035feff4ec"></a>VALIDATED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abfd35f225f4b7fc495ebb1c5f7976ffca0ee8a0c210661d337874478738885da9" name="abfd35f225f4b7fc495ebb1c5f7976ffca0ee8a0c210661d337874478738885da9"></a>OCSP_VALIDATED&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ade587be2414188b349cb89c0b94b4b1c" name="ade587be2414188b349cb89c0b94b4b1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade587be2414188b349cb89c0b94b4b1c">&#9670;&nbsp;</a></span>s2n_verify_host_information()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t s2n_verify_host_information </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *&#160;</td>
          <td class="paramname"><em>validator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>public_cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a288e4c79746a86e09ee8a398bb14c512" name="a288e4c79746a86e09ee8a398bb14c512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288e4c79746a86e09ee8a398bb14c512">&#9670;&nbsp;</a></span>s2n_x509_ocsp_stapling_supported()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t s2n_x509_ocsp_stapling_supported </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Some libcrypto implementations do not support OCSP validation. Returns 1 if supported, 0 otherwise. </p>

</div>
</div>
<a id="a9d1721ad7ba85938d51914e70ab93d64" name="a9d1721ad7ba85938d51914e70ab93d64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d1721ad7ba85938d51914e70ab93d64">&#9670;&nbsp;</a></span>s2n_x509_trust_store_add_pem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_x509_trust_store_add_pem </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialize trust store from a PEM. This will allocate memory, and load PEM into the Trust Store </p>

</div>
</div>
<a id="a02f94f7855f8de1ba96cf0358ec9d69d" name="a02f94f7855f8de1ba96cf0358ec9d69d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f94f7855f8de1ba96cf0358ec9d69d">&#9670;&nbsp;</a></span>s2n_x509_trust_store_from_ca_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_x509_trust_store_from_ca_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ca_pem_filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ca_dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialize trust store from a CA file. This will allocate memory, and load each cert in the file into the trust store Returns 0 on success, or S2N error codes on failure. </p>

</div>
</div>
<a id="ab1f058ecf0f93d94b6eecb634050be58" name="ab1f058ecf0f93d94b6eecb634050be58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1f058ecf0f93d94b6eecb634050be58">&#9670;&nbsp;</a></span>s2n_x509_trust_store_from_system_defaults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_x509_trust_store_from_system_defaults </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *&#160;</td>
          <td class="paramname"><em>store</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initializes the trust store to default system paths </p>

</div>
</div>
<a id="ab79d51c6a30bb86a6ff1ac773d0e38ea" name="ab79d51c6a30bb86a6ff1ac773d0e38ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab79d51c6a30bb86a6ff1ac773d0e38ea">&#9670;&nbsp;</a></span>s2n_x509_trust_store_has_certs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t s2n_x509_trust_store_has_certs </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *&#160;</td>
          <td class="paramname"><em>store</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Returns TRUE if the trust store has certificates installed, FALSE otherwise </p>

</div>
</div>
<a id="a9420691912d2b27885e752cf5e3a255d" name="a9420691912d2b27885e752cf5e3a255d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9420691912d2b27885e752cf5e3a255d">&#9670;&nbsp;</a></span>s2n_x509_trust_store_init_empty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void s2n_x509_trust_store_init_empty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *&#160;</td>
          <td class="paramname"><em>store</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialize the trust store to empty defaults (no allocations happen here) </p>

</div>
</div>
<a id="ad80262ea13eecda7dbec5812576dc732" name="ad80262ea13eecda7dbec5812576dc732"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad80262ea13eecda7dbec5812576dc732">&#9670;&nbsp;</a></span>s2n_x509_trust_store_wipe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void s2n_x509_trust_store_wipe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *&#160;</td>
          <td class="paramname"><em>store</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Cleans up, and frees any underlying memory in the trust store. </p>

</div>
</div>
<a id="a14de21f9d6b7b411e1eee66a98d64feb" name="a14de21f9d6b7b411e1eee66a98d64feb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14de21f9d6b7b411e1eee66a98d64feb">&#9670;&nbsp;</a></span>s2n_x509_validator_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_x509_validator_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *&#160;</td>
          <td class="paramname"><em>validator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__trust__store.html">s2n_x509_trust_store</a> *&#160;</td>
          <td class="paramname"><em>trust_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>check_ocsp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialize the validator in safe mode. Will use trust store to validate x.509 cerficiates, ocsp responses, and will call the verify host callback to determine if a subject name or alternative name from the cert should be trusted. Returns 0 on success, and an S2N_ERR_* on failure. </p>

</div>
</div>
<a id="a3c01448c0eba6f3da070efca52a9beb1" name="a3c01448c0eba6f3da070efca52a9beb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c01448c0eba6f3da070efca52a9beb1">&#9670;&nbsp;</a></span>s2n_x509_validator_init_no_x509_validation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_x509_validator_init_no_x509_validation </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *&#160;</td>
          <td class="paramname"><em>validator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialize the validator in unsafe mode. No validity checks for OCSP, host checks, or X.509 will be performed. </p>

</div>
</div>
<a id="ae4f3e82ce716b7f639c01dfa333c5b10" name="ae4f3e82ce716b7f639c01dfa333c5b10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4f3e82ce716b7f639c01dfa333c5b10">&#9670;&nbsp;</a></span>s2n_x509_validator_set_max_chain_depth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_x509_validator_set_max_chain_depth </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *&#160;</td>
          <td class="paramname"><em>validator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>max_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Sets the maximum depth for a cert chain that can be used at validation. </p>

</div>
</div>
<a id="a3f135290f89f1c43d55f9b7667543aca" name="a3f135290f89f1c43d55f9b7667543aca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f135290f89f1c43d55f9b7667543aca">&#9670;&nbsp;</a></span>s2n_x509_validator_validate_cert_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="s2n__x509__validator_8h.html#a9a57c107b797f4467cbc9f5d359e4145">s2n_cert_validation_code</a> s2n_x509_validator_validate_cert_chain </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *&#160;</td>
          <td class="paramname"><em>validator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>cert_chain_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>cert_chain_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="s2n__pkey_8h.html#a9f8ffb59dc71a9fab8e636972279d441">s2n_pkey_type</a> *&#160;</td>
          <td class="paramname"><em>pkey_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__pkey.html">s2n_pkey</a> *&#160;</td>
          <td class="paramname"><em>public_key_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Validates a certificate chain against the configured trust store in safe mode. In unsafe mode, it will find the public key and return it but not validate the certificates. Alternative Names and Subject Name will be passed to the host verification callback. The verification callback will be possibly called multiple times depending on how many names are found. If any of those calls return TRUE, that stage of the validation will continue, otherwise once all names are tried and none matched as trusted, the chain will be considered UNTRUSTED.</p>
<p >This function can only be called once per instance of an <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a>. If must be called prior to calling <a class="el" href="s2n__x509__validator_8h.html#aac701ea2519babd138e34ee9089f8a6f">s2n_x509_validator_validate_cert_stapled_ocsp_response()</a>. </p>

</div>
</div>
<a id="a0ed4a60b0e3393d1c7d0fb0399a348f6" name="a0ed4a60b0e3393d1c7d0fb0399a348f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed4a60b0e3393d1c7d0fb0399a348f6">&#9670;&nbsp;</a></span>s2n_x509_validator_validate_cert_stapled_ocsp_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="s2n__x509__validator_8h.html#a9a57c107b797f4467cbc9f5d359e4145">s2n_cert_validation_code</a> s2n_x509_validator_validate_cert_stapled_ocsp_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *&#160;</td>
          <td class="paramname"><em>validator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>ocsp_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Validates an ocsp response against the most recent certificate chain. Also verifies the timestamps on the response. This function can only be called once per instance of an <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> and only after a successful call to <a class="el" href="s2n__x509__validator_8h.html#a3f135290f89f1c43d55f9b7667543aca">s2n_x509_validator_validate_cert_chain()</a>. </p>

</div>
</div>
<a id="a7a9cb1ed3f0786296ad988185adce278" name="a7a9cb1ed3f0786296ad988185adce278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a9cb1ed3f0786296ad988185adce278">&#9670;&nbsp;</a></span>s2n_x509_validator_wipe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void s2n_x509_validator_wipe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__x509__validator.html">s2n_x509_validator</a> *&#160;</td>
          <td class="paramname"><em>validator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Cleans up underlying memory and data members. Struct can be reused afterwards. </p>

</div>
</div>
<a id="a2bb65909f7e2156383aeb1c9d03b49c8" name="a2bb65909f7e2156383aeb1c9d03b49c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bb65909f7e2156383aeb1c9d03b49c8">&#9670;&nbsp;</a></span>wipe_cert_chain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void wipe_cert_chain </td>
          <td>(</td>
          <td class="paramtype">STACK_OF(X509) *&#160;</td>
          <td class="paramname"><em>cert_chain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
