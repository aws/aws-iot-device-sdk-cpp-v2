<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS IoT Device SDK C++ v2: crt/aws-crt-cpp/crt/aws-c-io/source/retry_strategy.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Device SDK C++ v2<span id="projectnumber">&#160;1.14.0</span>
   </div>
   <div id="projectbrief">AWS IoT Device SDK C++ v2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_affb495f978f3575eca2eeb81eb7736b.html">crt</a></li><li class="navelem"><a class="el" href="dir_eb065311872385a3a1227a6ede2c108c.html">aws-crt-cpp</a></li><li class="navelem"><a class="el" href="dir_c68d83f7493c97e50c45ec06f21e3081.html">crt</a></li><li class="navelem"><a class="el" href="dir_38639adb496917e811387c759039569e.html">aws-c-io</a></li><li class="navelem"><a class="el" href="dir_f4dbc368f58b978af8c3f3f8c1515802.html">source</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">retry_strategy.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="retry__strategy_8h_source.html">aws/io/retry_strategy.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abb2ca1ff67a72849da98ed0a0aed2f5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="retry__strategy_8c.html#abb2ca1ff67a72849da98ed0a0aed2f5d">aws_retry_strategy_acquire</a> (struct <a class="el" href="structaws__retry__strategy.html">aws_retry_strategy</a> *retry_strategy)</td></tr>
<tr class="separator:abb2ca1ff67a72849da98ed0a0aed2f5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e88e3d3d2da7e551eaa6452ff9ebb7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="retry__strategy_8c.html#a97e88e3d3d2da7e551eaa6452ff9ebb7">aws_retry_strategy_release</a> (struct <a class="el" href="structaws__retry__strategy.html">aws_retry_strategy</a> *retry_strategy)</td></tr>
<tr class="separator:a97e88e3d3d2da7e551eaa6452ff9ebb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72bb5210cd0203a7baba13d7241e74c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="retry__strategy_8c.html#ab72bb5210cd0203a7baba13d7241e74c">aws_retry_strategy_acquire_retry_token</a> (struct <a class="el" href="structaws__retry__strategy.html">aws_retry_strategy</a> *retry_strategy, const struct <a class="el" href="structaws__byte__cursor.html">aws_byte_cursor</a> *partition_id, <a class="el" href="retry__strategy_8h.html#a840055993c2a9788207792f45db2e27f">aws_retry_strategy_on_retry_token_acquired_fn</a> *on_acquired, void *<a class="el" href="event__stream__rpc__server__connection__test_8c.html#af1abaca9a982b3cdb0b118914416c39b">user_data</a>, uint64_t timeout_ms)</td></tr>
<tr class="separator:ab72bb5210cd0203a7baba13d7241e74c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c990dc3c3f6f3b7574d6435c23a5269"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="retry__strategy_8c.html#a5c990dc3c3f6f3b7574d6435c23a5269">aws_retry_strategy_schedule_retry</a> (struct <a class="el" href="structaws__retry__token.html">aws_retry_token</a> *<a class="el" href="event__stream__rpc__server__connection__test_8c.html#a3f037ea767197698bc0b4c14fa155431">token</a>, enum <a class="el" href="retry__strategy_8h.html#af89c6cafd32c7015ca7157a0c36ecb0c">aws_retry_error_type</a> error_type, <a class="el" href="retry__strategy_8h.html#ade4a870a92bb428e8688ec1c07273220">aws_retry_strategy_on_retry_ready_fn</a> *retry_ready, void *<a class="el" href="event__stream__rpc__server__connection__test_8c.html#af1abaca9a982b3cdb0b118914416c39b">user_data</a>)</td></tr>
<tr class="separator:a5c990dc3c3f6f3b7574d6435c23a5269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11a355c471ed49dbefd6f7f932569862"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="retry__strategy_8c.html#a11a355c471ed49dbefd6f7f932569862">aws_retry_token_record_success</a> (struct <a class="el" href="structaws__retry__token.html">aws_retry_token</a> *<a class="el" href="event__stream__rpc__server__connection__test_8c.html#a3f037ea767197698bc0b4c14fa155431">token</a>)</td></tr>
<tr class="separator:a11a355c471ed49dbefd6f7f932569862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a784d5374b01e37389ae351d52e72472a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="retry__strategy_8c.html#a784d5374b01e37389ae351d52e72472a">aws_retry_token_acquire</a> (struct <a class="el" href="structaws__retry__token.html">aws_retry_token</a> *<a class="el" href="event__stream__rpc__server__connection__test_8c.html#a3f037ea767197698bc0b4c14fa155431">token</a>)</td></tr>
<tr class="separator:a784d5374b01e37389ae351d52e72472a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ca474deb7e9b25086b4de6b7719dde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="retry__strategy_8c.html#a60ca474deb7e9b25086b4de6b7719dde">aws_retry_token_release</a> (struct <a class="el" href="structaws__retry__token.html">aws_retry_token</a> *<a class="el" href="event__stream__rpc__server__connection__test_8c.html#a3f037ea767197698bc0b4c14fa155431">token</a>)</td></tr>
<tr class="separator:a60ca474deb7e9b25086b4de6b7719dde"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abb2ca1ff67a72849da98ed0a0aed2f5d" name="abb2ca1ff67a72849da98ed0a0aed2f5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb2ca1ff67a72849da98ed0a0aed2f5d">&#9670;&nbsp;</a></span>aws_retry_strategy_acquire()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aws_retry_strategy_acquire </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaws__retry__strategy.html">aws_retry_strategy</a> *&#160;</td>
          <td class="paramname"><em>retry_strategy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved. SPDX-License-Identifier: Apache-2.0. </p>

</div>
</div>
<a id="ab72bb5210cd0203a7baba13d7241e74c" name="ab72bb5210cd0203a7baba13d7241e74c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab72bb5210cd0203a7baba13d7241e74c">&#9670;&nbsp;</a></span>aws_retry_strategy_acquire_retry_token()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_retry_strategy_acquire_retry_token </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaws__retry__strategy.html">aws_retry_strategy</a> *&#160;</td>
          <td class="paramname"><em>retry_strategy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structaws__byte__cursor.html">aws_byte_cursor</a> *&#160;</td>
          <td class="paramname"><em>partition_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="retry__strategy_8h.html#a840055993c2a9788207792f45db2e27f">aws_retry_strategy_on_retry_token_acquired_fn</a> *&#160;</td>
          <td class="paramname"><em>on_acquired</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>timeout_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Attempts to acquire a retry token for use with retries. On success, on_acquired will be invoked when a token is available, or an error will be returned if the timeout expires. partition_id identifies operations that should be grouped together. This allows for more sophisticated strategies such as AIMD and circuit breaker patterns. Pass NULL to use the global partition. </p>

</div>
</div>
<a id="a97e88e3d3d2da7e551eaa6452ff9ebb7" name="a97e88e3d3d2da7e551eaa6452ff9ebb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97e88e3d3d2da7e551eaa6452ff9ebb7">&#9670;&nbsp;</a></span>aws_retry_strategy_release()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aws_retry_strategy_release </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaws__retry__strategy.html">aws_retry_strategy</a> *&#160;</td>
          <td class="paramname"><em>retry_strategy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Releases a reference count on retry_strategy. </p>

</div>
</div>
<a id="a5c990dc3c3f6f3b7574d6435c23a5269" name="a5c990dc3c3f6f3b7574d6435c23a5269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c990dc3c3f6f3b7574d6435c23a5269">&#9670;&nbsp;</a></span>aws_retry_strategy_schedule_retry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_retry_strategy_schedule_retry </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaws__retry__token.html">aws_retry_token</a> *&#160;</td>
          <td class="paramname"><em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="retry__strategy_8h.html#af89c6cafd32c7015ca7157a0c36ecb0c">aws_retry_error_type</a>&#160;</td>
          <td class="paramname"><em>error_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="retry__strategy_8h.html#ade4a870a92bb428e8688ec1c07273220">aws_retry_strategy_on_retry_ready_fn</a> *&#160;</td>
          <td class="paramname"><em>retry_ready</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Schedules a retry based on the backoff and token based strategies. retry_ready is invoked when the retry is either ready for execution or if it has been canceled due to application shutdown.</p>
<p >This function can return an error to reject the retry attempt if, for example, a circuit breaker has opened. If this occurs users should fail their calls back to their callers.</p>
<p >error_type is used for book keeping. See the comments above for aws_retry_error_type. </p>

</div>
</div>
<a id="a784d5374b01e37389ae351d52e72472a" name="a784d5374b01e37389ae351d52e72472a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a784d5374b01e37389ae351d52e72472a">&#9670;&nbsp;</a></span>aws_retry_token_acquire()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aws_retry_token_acquire </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaws__retry__token.html">aws_retry_token</a> *&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Increments reference count for token. This should be called any time you seat the token to a pointer you own. </p>

</div>
</div>
<a id="a11a355c471ed49dbefd6f7f932569862" name="a11a355c471ed49dbefd6f7f932569862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11a355c471ed49dbefd6f7f932569862">&#9670;&nbsp;</a></span>aws_retry_token_record_success()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_retry_token_record_success </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaws__retry__token.html">aws_retry_token</a> *&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Records a successful retry. This is used for making future decisions to open up token buckets, AIMD breakers etc... some strategies such as exponential backoff will ignore this, but you should always call it after a successful operation or your system will never recover during an outage. </p>

</div>
</div>
<a id="a60ca474deb7e9b25086b4de6b7719dde" name="a60ca474deb7e9b25086b4de6b7719dde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ca474deb7e9b25086b4de6b7719dde">&#9670;&nbsp;</a></span>aws_retry_token_release()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aws_retry_token_release </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structaws__retry__token.html">aws_retry_token</a> *&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Releases the reference count for token. This should always be invoked after either calling <a class="el" href="retry__strategy_8h.html#ae54ea9ff39ddd2a21c87f4ef3e6111d5">aws_retry_strategy_schedule_retry()</a> and failing, or after calling <a class="el" href="retry__strategy_8h.html#a19f32fa855a56b5234d8abd40fa9922e">aws_retry_token_record_success()</a>. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
