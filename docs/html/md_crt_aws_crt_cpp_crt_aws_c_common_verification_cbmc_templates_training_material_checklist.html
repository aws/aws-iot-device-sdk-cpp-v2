<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS IoT Device SDK C++ v2: A proof checklist for writers and reviewers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Device SDK C++ v2<span id="projectnumber">&#160;1.14.0</span>
   </div>
   <div id="projectbrief">AWS IoT Device SDK C++ v2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">A proof checklist for writers and reviewers </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This is a check list intended for</p>
<ul>
<li>proof writers to use before checking a proof into a repository and</li>
<li>proof reviewers to use during the code review of a pull request containing a proof.</li>
</ul>
<p >This check list is intended to ensure clear answers to two questions:</p>
<ul>
<li>What properties are being checked by the proof?</li>
<li>What assumptions are being made by the proof?</li>
</ul>
<p >and that these answers can be found in one of three places:</p>
<ul>
<li>The proof harness,</li>
<li>The proof makefiles (and, with the starter kit, these makefiles are the proof Makefile, the project Makefile-project-defines, and the project Makefile.common), and perhaps</li>
<li>The proof readme file.</li>
</ul>
<p >The best practices for writing a proof are described in the section <a class="el" href="md_crt_aws_crt_cpp_crt_aws_c_common_verification_cbmc_templates_training_material__p_r_o_o_f__w_r_i_t_i_n_g.html">How to Write a CBMC Proof</a> of the training material in this starter kit. Reviewers should keep these best practices in mind when reading a proof. We recommend that any deviations from best practices be explained in the readme file.</p>
<h1><a class="anchor" id="autotoc_md60"></a>
Properties checked</h1>
<p >Check the following:</p>
<ul>
<li><p class="startli">All of the standard property-checking flags are used:</p><ul>
<li>&ndash;bounds-check</li>
<li>&ndash;conversion-check</li>
<li>&ndash;div-by-zero-check</li>
<li>&ndash;float-overflow-check</li>
<li>&ndash;malloc-fail-null</li>
<li>&ndash;malloc-may-fail</li>
<li>&ndash;nan-check</li>
<li>&ndash;pointer-check</li>
<li>&ndash;pointer-overflow-check</li>
<li>&ndash;pointer-primitive-check</li>
<li>&ndash;signed-overflow-check</li>
<li>&ndash;undefined-shift-check</li>
<li>&ndash;unsigned-overflow-check</li>
</ul>
<p class="startli">Note that the starter kit uses these flags by default. Note, however, that a developer may disable any one of these flags by editing project Makefile.common or by setting a makefile variable to the empty string (as in <code>CBMC_FLAG_MALLOC_MAY_FAIL =</code>) in the project Makefile-project-defines or a proof Makefile. These are the places to look for deviations.</p>
</li>
<li><p class="startli">All deviations from the standard property-checking flags are documented.</p>
<p class="startli">There are valid reasons to omit flags either for a project or for an individual proof. But the decision and the reason for the decision must be documented either in a project readme or a proof readme file.</p>
</li>
</ul>
<p >CBMC checks assertions in the code. This is understood and need not be documented.</p>
<h1><a class="anchor" id="autotoc_md61"></a>
Assumptions made</h1>
<p >Check the following:</p>
<ul>
<li><p class="startli">All nontrivial data structures have an <a href="PROOF-WRITING.md#the-ensure_allocated-function"><code>ensure_allocated</code> function</a> as described in the training material.</p>
<p class="startli">Feel free to use any naming scheme that makes sense for your project &mdash; some projects use <code>allocate_X</code> in place of <code>ensure_allocated_X</code> &mdash; but be consistent.</p>
</li>
<li>All nontrivial data structures have an <a href="PROOF-WRITING.md#the-is_valid-function"><code>is_valid()</code> predicate</a> as described in the training material for every nontrivial data structure.</li>
<li><p class="startli">All definitions of <code>ensure_allocated</code> functions and <code>is_valid</code> predicates appear in a common location.</p>
<p class="startli">These definitions are most commonly stored in the <code>proofs/sources</code> subdirectory of the starter kit. Definitions are stored here and used consistently in the proofs.</p>
</li>
<li><p class="startli">All pointers passed as input are allocated on the heap with <code>malloc</code>.</p>
<p class="startli">One common mistake is to allocate a buffer <code>buf</code> on the stack and to pass <code>&amp;buf</code> to the function under test in the proof harness. This prevents the proof from considering the case of a NULL pointer.</p>
</li>
<li><p class="startli">All instances of <code>__CPROVER_assume</code> appear in a proof harness.</p>
<p class="startli">Note that some exceptions are required. For example, it may be necessary in an <code>ensure_allocated</code> to assume <code>length &lt; CBMC_MAX_OBJECT_SIZE</code> before invoking <code>malloc(length)</code> to avoid a false positive about malloc'ing a too-big object. But every instance of <code>__CPROVER_assume</code> in supporting code should be copied into the proof harness. The goal is for all proof assumptions to be documented in one place.</p>
</li>
<li><p class="startli">All preprocessor definitions related to bounds on input size or otherwise related to proof assumptions appear in the proof Makefile.</p>
<p class="startli">In particular, do not embed definitions in the supporting code or header files. The goal is for all proof assumptions to be documented in one place.</p>
</li>
<li><p class="startli">Confirm that all stubs used in the proof are acceptable abstractions of the actual code.</p>
<p class="startli">Acceptable could mean simply that every behavior of the original code is a behavior of the abstraction.</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md62"></a>
Results checked</h1>
<p >Look at the report in the checks attached to the pull request.</p>
<ul>
<li>Confirm that the coverage is acceptable and confirm that the readme file explains the reason for any lines not covered.</li>
<li>Confirm that the list of missing functions is acceptable.</li>
<li>Confirm that there are no errors reported.</li>
</ul>
<h1><a class="anchor" id="autotoc_md63"></a>
Other things to consider</h1>
<ul>
<li>Consider writing function contracts for the function under test as described in <a class="el" href="md_crt_aws_crt_cpp_crt_aws_c_common_verification_cbmc_templates_training_material__p_r_o_o_f__w_r_i_t_i_n_g.html">How to Write a CBMC Proof</a> of the training material. The check list above ensures that the properties (including the assumptions about the input) that must be true before function invocation are clearly stated in the proof harness. Consider adding a statement of what properties must be true after function invocation as assertions at the end of the proof harness.</li>
<li>Consider adding the assumptions made by the proof harness for a function under test to the source code for the function in the form of assertions in the code. This will validate that the assumptions made by the proof of a function are satisfied by each invocation of the function (at least during testing). </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
