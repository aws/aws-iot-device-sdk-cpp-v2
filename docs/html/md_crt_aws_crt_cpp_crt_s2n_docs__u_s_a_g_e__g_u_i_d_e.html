<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS IoT Device SDK C++ v2: Using s2n</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Device SDK C++ v2<span id="projectnumber">&#160;1.14.0</span>
   </div>
   <div id="projectbrief">AWS IoT Device SDK C++ v2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Using s2n </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >s2n is a C library, and is built using Make. To clone the latest copy of s2n from git use:</p>
<div class="fragment"><div class="line">git clone https://github.com/awslabs/s2n.git</div>
<div class="line">cd s2n</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md357"></a>
Building s2n with existing libcrypto</h1>
<h2><a class="anchor" id="autotoc_md358"></a>
make Instructions</h2>
<p >To build s2n with an existing libcrypto installation, store its root folder in the <code>LIBCRYPTO_ROOT</code> environment variable. </p><div class="fragment"><div class="line"># /usr/local/ssl/lib should contain libcrypto.a</div>
<div class="line">LIBCRYPTO_ROOT=/usr/local/ssl make</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md359"></a>
CMake Instructions</h2>
<p >Throughout this document, there are instructions for setting a <code>LIBCRYPTO_ROOT</code> environment variable, or setting install prefixes to <code>s2n/lib-crypto-root</code>. If you are using CMake that step is unnecessary. Just follow the instructions here to use any build of libcrypto.</p>
<p >(Required): You need at least CMake version 3.0 to fully benefit from Modern CMake. See <a href="https://www.youtube.com/watch?v=bsXLMQ6WgIk">this</a> for more information.</p>
<p >(Optional): Set the CMake variable <code>CMAKE_INSTALL_PREFIX</code> to the location libcrypto is installed to. If you do not, the default installation on your machine will be used.</p>
<p >(Optional): Set the CMake variable <code>BUILD_SHARED_LIBS=ON</code> to build shared libraries. The default is static.</p>
<p >We recommend an out-of-source build. Suppose you have a directory <code>s2n</code> which contains the s2n source code. At the same level we can create a directory called <code>s2n-build</code></p>
<p >For example, we can build and install shared libs using ninja as our build system, and the system libcrypto implementation.</p>
<div class="fragment"><div class="line">mkdir s2n-build</div>
<div class="line">cd s2n-build</div>
<div class="line">cmake ../s2n -DBUILD_SHARED_LIBS=ON -GNinja</div>
<div class="line">ninja</div>
<div class="line">ninja test </div>
<div class="line">sudo ninja install</div>
</div><!-- fragment --><p >For another example, we can prepare an Xcode project using static libs using a libcrypto implementation in the directory <code>$HOME/s2n-user/builds/libcrypto-impl</code>.</p>
<div class="fragment"><div class="line">mkdir s2n-build</div>
<div class="line">cd s2n-build</div>
<div class="line">cmake ../s2n -DCMAKE_INSTALL_PREFIX=$HOME/s2n-user/builds/libcrypto-impl -G &quot;Xcode&quot;</div>
<div class="line"># now open the project in Xcode and build from there, or use the Xcode CLI</div>
</div><!-- fragment --><p >Or, for unix style vanilla builds:</p>
<div class="fragment"><div class="line">mkdir s2n-build</div>
<div class="line">cd s2n-build</div>
<div class="line">cmake ../s2n</div>
<div class="line">make</div>
<div class="line">make test</div>
<div class="line">sudo make install</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md360"></a>
Consuming s2n via. CMake</h2>
<p >s2n ships with modern CMake finder scripts if CMake is used for the build. To take advantage of this from your CMake script, all you need to do to compile and link against s2n in your project is:</p>
<div class="fragment"><div class="line">find_package(s2n)</div>
<div class="line"> </div>
<div class="line">....</div>
<div class="line"> </div>
<div class="line">target_link_libraries(yourExecutableOrLibrary AWS::s2n)</div>
</div><!-- fragment --><p >And when invoking CMake for your project, do one of two things:</p><ol type="1">
<li>Set the <code>CMAKE_INSTALL_PREFIX</code> variable with the path to your s2n build.</li>
<li>If you have globally installed s2n, do nothing, it will automatically be found.</li>
</ol>
<h1><a class="anchor" id="autotoc_md361"></a>
Building s2n with OpenSSL-1.1.1</h1>
<p >To build s2n with OpenSSL-1.1.1, do the following:</p>
<div class="fragment"><div class="line"># We keep the build artifacts in the -build directory</div>
<div class="line">cd libcrypto-build</div>
<div class="line"> </div>
<div class="line"># Download the latest version of OpenSSL</div>
<div class="line">curl -LO https://www.openssl.org/source/openssl-1.1.1-latest.tar.gz</div>
<div class="line">tar -xzvf openssl-1.1.1-latest.tar.gz</div>
<div class="line"> </div>
<div class="line"># Build openssl libcrypto</div>
<div class="line">cd `tar ztf openssl-1.1.1-latest.tar.gz | head -n1 | cut -f1 -d/`</div>
<div class="line">./config -fPIC no-shared              \</div>
<div class="line">         no-md2 no-rc5 no-rfc3779 no-sctp no-ssl-trace no-zlib     \</div>
<div class="line">         no-hw no-mdc2 no-seed no-idea enable-ec_nistp_64_gcc_128 no-camellia\</div>
<div class="line">         no-bf no-ripemd no-dsa no-ssl2 no-ssl3 no-capieng                  \</div>
<div class="line">         -DSSL_FORBID_ENULL -DOPENSSL_NO_DTLS1 -DOPENSSL_NO_HEARTBEATS      \</div>
<div class="line">         --prefix=`pwd`/../../libcrypto-root/</div>
<div class="line">make</div>
<div class="line">make install</div>
<div class="line"> </div>
<div class="line"># Build s2n</div>
<div class="line">cd ../../</div>
<div class="line">make</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md362"></a>
Note for 32-bit builds.</h1>
<p >The previous instructions work fine with only a few tweaks to your config command. Example: </p><div class="fragment"><div class="line">setarch i386 ./config -fPIC no-shared     \</div>
<div class="line">        -m32 no-md2 no-rc5 no-rfc3779 no-sctp no-ssl-trace no-zlib     \</div>
<div class="line">        no-hw no-mdc2 no-seed no-idea no-camellia\</div>
<div class="line">        no-bf no-ripemd no-dsa no-ssl2 no-ssl3 no-capieng     \</div>
<div class="line">        -DSSL_FORBID_ENULL -DOPENSSL_NO_DTLS1 -DOPENSSL_NO_HEARTBEATS   \</div>
<div class="line">        --prefix=`pwd`/../../libcrypto-root/</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md363"></a>
Building s2n with OpenSSL-1.0.2</h2>
<p >To build s2n with OpenSSL-1.0.2, do the following:</p>
<div class="fragment"><div class="line"># We keep the build artifacts in the -build directory</div>
<div class="line">cd libcrypto-build</div>
<div class="line"> </div>
<div class="line"># Download the latest version of OpenSSL</div>
<div class="line">curl -LO https://www.openssl.org/source/openssl-1.0.2-latest.tar.gz</div>
<div class="line">tar -xzvf openssl-1.0.2-latest.tar.gz</div>
<div class="line"> </div>
<div class="line"># Build openssl libcrypto</div>
<div class="line">cd `tar ztf openssl-1.0.2-latest.tar.gz | head -n1 | cut -f1 -d/`</div>
<div class="line">./config -fPIC no-shared no-libunbound no-gmp no-jpake no-krb5              \</div>
<div class="line">         no-md2 no-rc5 no-rfc3779 no-sctp no-ssl-trace no-store no-zlib     \</div>
<div class="line">         no-hw no-mdc2 no-seed no-idea enable-ec-nistp_64_gcc_128 no-camellia\</div>
<div class="line">         no-bf no-ripemd no-dsa no-ssl2 no-ssl3 no-capieng                  \</div>
<div class="line">         -DSSL_FORBID_ENULL -DOPENSSL_NO_DTLS1 -DOPENSSL_NO_HEARTBEATS      \</div>
<div class="line">         --prefix=`pwd`/../../libcrypto-root/</div>
<div class="line">make depend</div>
<div class="line">make</div>
<div class="line">make install</div>
<div class="line"> </div>
<div class="line"># Build s2n</div>
<div class="line">cd ../../</div>
<div class="line">make</div>
</div><!-- fragment --><p ><b>Mac Users:</b> please replace "./config" with "./Configure darwin64-x86_64-cc".</p>
<h2><a class="anchor" id="autotoc_md364"></a>
Building s2n with LibreSSL</h2>
<p >To build s2n with LibreSSL, do the following:</p>
<div class="fragment"><div class="line"># We keep the build artifacts in the -build directory</div>
<div class="line">cd libcrypto-build</div>
<div class="line"> </div>
<div class="line"># Download the latest version of LibreSSL</div>
<div class="line">curl -O http://ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-x.y.z.tar.gz</div>
<div class="line">tar -xzvf libressl-x.y.z.tar.gz</div>
<div class="line"> </div>
<div class="line"># Build LibreSSL&#39;s libcrypto</div>
<div class="line">cd libressl-x.y.z</div>
<div class="line">./configure --prefix=`pwd`/../../libcrypto-root/</div>
<div class="line">make CFLAGS=-fPIC install</div>
<div class="line"> </div>
<div class="line"># Build s2n</div>
<div class="line">cd ../../</div>
<div class="line">make</div>
</div><!-- fragment --><p >once built, static and dynamic libraries for s2n will be available in the lib/ directory.</p>
<h2><a class="anchor" id="autotoc_md365"></a>
Building s2n with BoringSSL</h2>
<p >To build s2n with BoringSSL, you must check out a copy of the BoringSSL directly via git. This procedure has been tested with fb68d6c901b98ffe15b8890d00bc819bf44c5f01 of BoringSSL.</p>
<div class="fragment"><div class="line"># We keep the build artifacts in the -build directory</div>
<div class="line">cd libcrypto-build</div>
<div class="line"> </div>
<div class="line"># Clone BoringSSL</div>
<div class="line">git clone https://boringssl.googlesource.com/boringssl</div>
<div class="line">    </div>
<div class="line"># Build BoringSSL</div>
<div class="line">cd boringssl</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake -DCMAKE_C_FLAGS=&quot;-fPIC&quot; ../</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># Copy the built library and includes</div>
<div class="line">mkdir ../../../libcrypto-root/lib/</div>
<div class="line">cp crypto/libcrypto.a ../../../libcrypto-root/lib/</div>
<div class="line">cp -r ../include/ ../../../libcrypto-root/include</div>
<div class="line"> </div>
<div class="line"># Build s2n</div>
<div class="line">cd ../../../</div>
<div class="line">make</div>
</div><!-- fragment --><p >once built, static and dynamic libraries for s2n will be available in the lib/ directory.</p>
<h2><a class="anchor" id="autotoc_md366"></a>
mlock() and system limits</h2>
<p >Internally s2n uses <a class="el" href="mlock_8c.html#a49da9349d68e3ced27b73c1b2e88ebf3">mlock()</a> to prevent memory from being swapped to disk. The s2n build tests may fail in some environments where the default limit on locked memory is too low. To check this limit, run:</p>
<div class="fragment"><div class="line">ulimit -l</div>
</div><!-- fragment --><p >to raise the limit, consult the documentation for your platform.</p>
<h3><a class="anchor" id="autotoc_md367"></a>
Disabling mlock()</h3>
<p >To disable s2n's mlock behavior, run your application with the <code>S2N_DONT_MLOCK</code> environment variable set. s2n also reads this for unit tests. Try <code>S2N_DONT_MLOCK=1 make</code> if you're having mlock failures during unit tests.</p>
<h1><a class="anchor" id="autotoc_md368"></a>
s2n API</h1>
<p >The API exposed by s2n is the set of functions and declarations that are in the "s2n.h" header file. Any functions and declarations that are in the "s2n.h" file are intended to be stable (API and ABI) within major version numbers of s2n releases. Other functions and structures used in s2n internally can not be considered stable and their parameters, names, and sizes may change.</p>
<p >At this time (Summer 2015), there has been no numbered release of s2n and all APIs are subject to change based on the feedback and preferences of early adopters.</p>
<h2><a class="anchor" id="autotoc_md369"></a>
Preprocessor macros</h2>
<p >s2n defines five preprocessor macros that are used to determine what version of SSL/TLS is in use on a connection.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define S2N_SSLv2 20</span></div>
<div class="line"><span class="preprocessor">#define S2N_SSLv3 30</span></div>
<div class="line"><span class="preprocessor">#define S2N_TLS10 31</span></div>
<div class="line"><span class="preprocessor">#define S2N_TLS11 32</span></div>
<div class="line"><span class="preprocessor">#define S2N_TLS12 33</span></div>
</div><!-- fragment --><p >These correspond to SSL2.0, SSL3.0, TLS1.0, TLS1.1 and TLS1.2 respectively. Note that s2n does not support SSL2.0 for sending and receiving encrypted data, but does accept SSL2.0 hello messages.</p>
<h2><a class="anchor" id="autotoc_md370"></a>
Enums</h2>
<p >s2n defines the following enum types:</p>
<h3><a class="anchor" id="autotoc_md371"></a>
s2n_error_type</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line">    <a class="code hl_enumvalue" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a09221eeb73c34d50145b9c7c0eb21f25">S2N_ERR_T_OK</a>=0,</div>
<div class="line">    <a class="code hl_enumvalue" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a37308c203b80ac55ca9fe47af71a4461">S2N_ERR_T_IO</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a0cbe0424403a2678cf7ece737b2203e1">S2N_ERR_T_CLOSED</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a5bcbdbf63fe745654c4ae0fb8d28bbd2">S2N_ERR_T_BLOCKED</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a12d57bda93bac5e14ae6d7c78717e122">S2N_ERR_T_ALERT</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44af7032a0138492c552fc04b9198259cd7">S2N_ERR_T_PROTO</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a2c6b4ff243a28b86ef701206023339ca">S2N_ERR_T_INTERNAL</a>,</div>
<div class="line">    <a class="code hl_enumvalue" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a0d2eba6e7ff752e54c0aa004fd53f176">S2N_ERR_T_USAGE</a></div>
<div class="line">} <a class="code hl_enumeration" href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44">s2n_error_type</a>;</div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44">s2n_error_type</a></div><div class="ttdeci">s2n_error_type</div><div class="ttdef"><b>Definition:</b> s2n.h:54</div></div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44a09221eeb73c34d50145b9c7c0eb21f25"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a09221eeb73c34d50145b9c7c0eb21f25">S2N_ERR_T_OK</a></div><div class="ttdeci">@ S2N_ERR_T_OK</div><div class="ttdef"><b>Definition:</b> s2n.h:55</div></div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44a0cbe0424403a2678cf7ece737b2203e1"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a0cbe0424403a2678cf7ece737b2203e1">S2N_ERR_T_CLOSED</a></div><div class="ttdeci">@ S2N_ERR_T_CLOSED</div><div class="ttdef"><b>Definition:</b> s2n.h:57</div></div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44a0d2eba6e7ff752e54c0aa004fd53f176"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a0d2eba6e7ff752e54c0aa004fd53f176">S2N_ERR_T_USAGE</a></div><div class="ttdeci">@ S2N_ERR_T_USAGE</div><div class="ttdef"><b>Definition:</b> s2n.h:62</div></div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44a12d57bda93bac5e14ae6d7c78717e122"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a12d57bda93bac5e14ae6d7c78717e122">S2N_ERR_T_ALERT</a></div><div class="ttdeci">@ S2N_ERR_T_ALERT</div><div class="ttdef"><b>Definition:</b> s2n.h:59</div></div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44a2c6b4ff243a28b86ef701206023339ca"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a2c6b4ff243a28b86ef701206023339ca">S2N_ERR_T_INTERNAL</a></div><div class="ttdeci">@ S2N_ERR_T_INTERNAL</div><div class="ttdef"><b>Definition:</b> s2n.h:61</div></div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44a37308c203b80ac55ca9fe47af71a4461"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a37308c203b80ac55ca9fe47af71a4461">S2N_ERR_T_IO</a></div><div class="ttdeci">@ S2N_ERR_T_IO</div><div class="ttdef"><b>Definition:</b> s2n.h:56</div></div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44a5bcbdbf63fe745654c4ae0fb8d28bbd2"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44a5bcbdbf63fe745654c4ae0fb8d28bbd2">S2N_ERR_T_BLOCKED</a></div><div class="ttdeci">@ S2N_ERR_T_BLOCKED</div><div class="ttdef"><b>Definition:</b> s2n.h:58</div></div>
<div class="ttc" id="as2n_8h_html_a41f8ab66d28ce2f33fa8dbf858c0ac44af7032a0138492c552fc04b9198259cd7"><div class="ttname"><a href="s2n_8h.html#a41f8ab66d28ce2f33fa8dbf858c0ac44af7032a0138492c552fc04b9198259cd7">S2N_ERR_T_PROTO</a></div><div class="ttdeci">@ S2N_ERR_T_PROTO</div><div class="ttdef"><b>Definition:</b> s2n.h:60</div></div>
</div><!-- fragment --><p ><em><b>s2n_error_type</b></em> is used to help applications determine why an s2n function failed. This enum is optimized for use in C switch statements. Each value in the enum represents an error "category". See <a href="#error-handling">Error Handling</a> for more detail.</p>
<h3><a class="anchor" id="autotoc_md372"></a>
s2n_mode</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> { <a class="code hl_enumvalue" href="s2n_8h.html#a77a64e3b657f90d221c5faf99c643cdba6d8d11a87ee62316e49b1b166c2b2c52">S2N_SERVER</a>, <a class="code hl_enumvalue" href="s2n_8h.html#a77a64e3b657f90d221c5faf99c643cdbac93ba9ce574a0b5893fe2a5960e1785d">S2N_CLIENT</a> } <a class="code hl_enumeration" href="s2n_8h.html#a77a64e3b657f90d221c5faf99c643cdb">s2n_mode</a>;</div>
<div class="ttc" id="as2n_8h_html_a77a64e3b657f90d221c5faf99c643cdb"><div class="ttname"><a href="s2n_8h.html#a77a64e3b657f90d221c5faf99c643cdb">s2n_mode</a></div><div class="ttdeci">s2n_mode</div><div class="ttdef"><b>Definition:</b> s2n.h:248</div></div>
<div class="ttc" id="as2n_8h_html_a77a64e3b657f90d221c5faf99c643cdba6d8d11a87ee62316e49b1b166c2b2c52"><div class="ttname"><a href="s2n_8h.html#a77a64e3b657f90d221c5faf99c643cdba6d8d11a87ee62316e49b1b166c2b2c52">S2N_SERVER</a></div><div class="ttdeci">@ S2N_SERVER</div><div class="ttdef"><b>Definition:</b> s2n.h:248</div></div>
<div class="ttc" id="as2n_8h_html_a77a64e3b657f90d221c5faf99c643cdbac93ba9ce574a0b5893fe2a5960e1785d"><div class="ttname"><a href="s2n_8h.html#a77a64e3b657f90d221c5faf99c643cdbac93ba9ce574a0b5893fe2a5960e1785d">S2N_CLIENT</a></div><div class="ttdeci">@ S2N_CLIENT</div><div class="ttdef"><b>Definition:</b> s2n.h:248</div></div>
</div><!-- fragment --><p ><b>s2n_mode</b> is used to declare connections as server or client type, respectively.</p>
<h3><a class="anchor" id="autotoc_md373"></a>
s2n_blocked_status</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> { <a class="code hl_enumvalue" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a>, <a class="code hl_enumvalue" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15daf76a7c83e9548139b7b8d50bdd5ff323">S2N_BLOCKED_ON_READ</a>, <a class="code hl_enumvalue" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15daefb6db9aaec431d69fc4c1249bc432e3">S2N_BLOCKED_ON_WRITE</a> } <a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a>;</div>
<div class="ttc" id="as2n_8h_html_af70ca0b089daa98cd79a424d3f6af15d"><div class="ttname"><a href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a></div><div class="ttdeci">s2n_blocked_status</div><div class="ttdef"><b>Definition:</b> s2n.h:335</div></div>
<div class="ttc" id="as2n_8h_html_af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd"><div class="ttname"><a href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a></div><div class="ttdeci">@ S2N_NOT_BLOCKED</div><div class="ttdef"><b>Definition:</b> s2n.h:335</div></div>
<div class="ttc" id="as2n_8h_html_af70ca0b089daa98cd79a424d3f6af15daefb6db9aaec431d69fc4c1249bc432e3"><div class="ttname"><a href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15daefb6db9aaec431d69fc4c1249bc432e3">S2N_BLOCKED_ON_WRITE</a></div><div class="ttdeci">@ S2N_BLOCKED_ON_WRITE</div><div class="ttdef"><b>Definition:</b> s2n.h:335</div></div>
<div class="ttc" id="as2n_8h_html_af70ca0b089daa98cd79a424d3f6af15daf76a7c83e9548139b7b8d50bdd5ff323"><div class="ttname"><a href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15daf76a7c83e9548139b7b8d50bdd5ff323">S2N_BLOCKED_ON_READ</a></div><div class="ttdeci">@ S2N_BLOCKED_ON_READ</div><div class="ttdef"><b>Definition:</b> s2n.h:335</div></div>
</div><!-- fragment --><p ><b>s2n_blocked_status</b> is used in non-blocking mode to indicate in which direction s2n became blocked on I/O before it returned control to the caller. This allows an application to avoid retrying s2n operations until I/O is possible in that direction.</p>
<h3><a class="anchor" id="autotoc_md374"></a>
s2n_blinding</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> { <a class="code hl_enumvalue" href="s2n_8h.html#a364ad496c9dd42fd3117a2f9d3289e62a090459f0733b199be908d881d7db871f">S2N_BUILT_IN_BLINDING</a>, <a class="code hl_enumvalue" href="s2n_8h.html#a364ad496c9dd42fd3117a2f9d3289e62a1b0ee228485be6bb2d6e2129827d51d2">S2N_SELF_SERVICE_BLINDING</a> } <a class="code hl_enumeration" href="s2n_8h.html#a364ad496c9dd42fd3117a2f9d3289e62">s2n_blinding</a>;</div>
<div class="ttc" id="as2n_8h_html_a364ad496c9dd42fd3117a2f9d3289e62"><div class="ttname"><a href="s2n_8h.html#a364ad496c9dd42fd3117a2f9d3289e62">s2n_blinding</a></div><div class="ttdeci">s2n_blinding</div><div class="ttdef"><b>Definition:</b> s2n.h:314</div></div>
<div class="ttc" id="as2n_8h_html_a364ad496c9dd42fd3117a2f9d3289e62a090459f0733b199be908d881d7db871f"><div class="ttname"><a href="s2n_8h.html#a364ad496c9dd42fd3117a2f9d3289e62a090459f0733b199be908d881d7db871f">S2N_BUILT_IN_BLINDING</a></div><div class="ttdeci">@ S2N_BUILT_IN_BLINDING</div><div class="ttdef"><b>Definition:</b> s2n.h:314</div></div>
<div class="ttc" id="as2n_8h_html_a364ad496c9dd42fd3117a2f9d3289e62a1b0ee228485be6bb2d6e2129827d51d2"><div class="ttname"><a href="s2n_8h.html#a364ad496c9dd42fd3117a2f9d3289e62a1b0ee228485be6bb2d6e2129827d51d2">S2N_SELF_SERVICE_BLINDING</a></div><div class="ttdeci">@ S2N_SELF_SERVICE_BLINDING</div><div class="ttdef"><b>Definition:</b> s2n.h:314</div></div>
</div><!-- fragment --><p ><b>s2n_blinding</b> is used to opt-out of s2n's built-in blinding. Blinding is a mitigation against timing side-channels which in some cases can leak information about encrypted data. By default s2n will cause a thread to sleep between 10 and 30 seconds whenever tampering is detected.</p>
<p >Setting the <b>S2N_SELF_SERVICE_BLINDING</b> option with <b>s2n_connection_set_blinding</b> turns off this behavior. This is useful for applications that are handling many connections in a single thread. In that case, if <a class="el" href="s2n_8h.html#a3b67ff058796d4c6c6caddfd0f10274e">s2n_recv()</a> or <a class="el" href="s2n_8h.html#ad3222e7aacf35a56be842678171be440">s2n_negotiate()</a> return an error, self-service applications should call <b>s2n_connection_get_delay</b> and pause activity on the connection for the specified number of nanoseconds before calling <a class="el" href="new__destroy_8c.html#a6cc331334d030ff39790e12d10ef25c1">close()</a> or shutdown().</p>
<h3><a class="anchor" id="autotoc_md375"></a>
s2n_status_request_type</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> { <a class="code hl_enumvalue" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a">S2N_STATUS_REQUEST_NONE</a>, <a class="code hl_enumvalue" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a> } <a class="code hl_enumeration" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635">s2n_status_request_type</a>;</div>
<div class="ttc" id="as2n_8h_html_a7d38e45340d223d0100a2d4bc0526635"><div class="ttname"><a href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635">s2n_status_request_type</a></div><div class="ttdeci">s2n_status_request_type</div><div class="ttdef"><b>Definition:</b> s2n.h:215</div></div>
<div class="ttc" id="as2n_8h_html_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8"><div class="ttname"><a href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a></div><div class="ttdeci">@ S2N_STATUS_REQUEST_OCSP</div><div class="ttdef"><b>Definition:</b> s2n.h:215</div></div>
<div class="ttc" id="as2n_8h_html_a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a"><div class="ttname"><a href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a">S2N_STATUS_REQUEST_NONE</a></div><div class="ttdeci">@ S2N_STATUS_REQUEST_NONE</div><div class="ttdef"><b>Definition:</b> s2n.h:215</div></div>
</div><!-- fragment --><p ><b>s2n_status_request_type</b> is used to define the type, if any, of certificate status request an S2N_CLIENT should make during the handshake. The only supported status request type is OCSP, <b>S2N_STATUS_REQUEST_OCSP</b>.</p>
<h3><a class="anchor" id="autotoc_md376"></a>
s2n_cert_auth_type</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> { <a class="code hl_enumvalue" href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8ab355d2cb81165391d33e2c1cf22f68e6">S2N_CERT_AUTH_NONE</a>, <a class="code hl_enumvalue" href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8a9f5e05d6ef3ccdd96c9fe38c3d793bcd">S2N_CERT_AUTH_REQUIRED</a>, <a class="code hl_enumvalue" href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8af01afd2ad2ca5bf78e36e030698677d8">S2N_CERT_AUTH_OPTIONAL</a> } <a class="code hl_enumeration" href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8">s2n_cert_auth_type</a>;</div>
<div class="ttc" id="as2n_8h_html_a8757c094681bb8151329c8dc067106b8"><div class="ttname"><a href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8">s2n_cert_auth_type</a></div><div class="ttdeci">s2n_cert_auth_type</div><div class="ttdef"><b>Definition:</b> s2n.h:360</div></div>
<div class="ttc" id="as2n_8h_html_a8757c094681bb8151329c8dc067106b8a9f5e05d6ef3ccdd96c9fe38c3d793bcd"><div class="ttname"><a href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8a9f5e05d6ef3ccdd96c9fe38c3d793bcd">S2N_CERT_AUTH_REQUIRED</a></div><div class="ttdeci">@ S2N_CERT_AUTH_REQUIRED</div><div class="ttdef"><b>Definition:</b> s2n.h:360</div></div>
<div class="ttc" id="as2n_8h_html_a8757c094681bb8151329c8dc067106b8ab355d2cb81165391d33e2c1cf22f68e6"><div class="ttname"><a href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8ab355d2cb81165391d33e2c1cf22f68e6">S2N_CERT_AUTH_NONE</a></div><div class="ttdeci">@ S2N_CERT_AUTH_NONE</div><div class="ttdef"><b>Definition:</b> s2n.h:360</div></div>
<div class="ttc" id="as2n_8h_html_a8757c094681bb8151329c8dc067106b8af01afd2ad2ca5bf78e36e030698677d8"><div class="ttname"><a href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8af01afd2ad2ca5bf78e36e030698677d8">S2N_CERT_AUTH_OPTIONAL</a></div><div class="ttdeci">@ S2N_CERT_AUTH_OPTIONAL</div><div class="ttdef"><b>Definition:</b> s2n.h:360</div></div>
</div><!-- fragment --><p> <b>s2n_cert_auth_type</b> is used to declare what type of client certificiate authentication to use. Currently the default for s2n is for neither the server side or the client side to use Client (aka Mutual) authentication.</p>
<h2><a class="anchor" id="autotoc_md377"></a>
Opaque structures</h2>
<p >s2n defines several opaque structures that are used for managed objects. Because these structures are opaque, they can only be safely referenced indirectly through pointers and their sizes may change with future versions of s2n.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__config.html">s2n_config</a>;</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a>;</div>
<div class="ttc" id="astructs2n__config_html"><div class="ttname"><a href="structs2n__config.html">s2n_config</a></div><div class="ttdef"><b>Definition:</b> s2n_config.h:31</div></div>
<div class="ttc" id="astructs2n__connection_html"><div class="ttname"><a href="structs2n__connection.html">s2n_connection</a></div><div class="ttdef"><b>Definition:</b> s2n_connection.h:54</div></div>
</div><!-- fragment --><p ><b><a class="el" href="structs2n__config.html">s2n_config</a></b> structures are a configuration object, used by servers for holding cryptographic certificates, keys and preferences. <b><a class="el" href="structs2n__connection.html">s2n_connection</a></b> structures are used to track each connection.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__rsa__key.html">s2n_rsa_public_key</a>;</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__pkey.html">s2n_cert_public_key</a>;</div>
<div class="ttc" id="astructs2n__pkey_html"><div class="ttname"><a href="structs2n__pkey.html">s2n_pkey</a></div><div class="ttdef"><b>Definition:</b> s2n_pkey.h:37</div></div>
<div class="ttc" id="astructs2n__rsa__key_html"><div class="ttname"><a href="structs2n__rsa__key.html">s2n_rsa_key</a></div><div class="ttdef"><b>Definition:</b> s2n_rsa.h:30</div></div>
</div><!-- fragment --><p ><b>s2n_rsa_public_key</b> and <b>s2n_cert_public_key</b> can be used by consumers of s2n to get and set public keys through other API calls.</p>
<h2><a class="anchor" id="autotoc_md378"></a>
Error handling</h2>
<div class="fragment"><div class="line">const char *s2n_strerror(int error, const char *lang);</div>
<div class="line">const char *s2n_strerror_debug(int error, const char *lang);</div>
<div class="line">const char *s2n_strerror_name(int error);</div>
<div class="line">````</div>
<div class="line"> </div>
<div class="line">s2n functions that return &#39;int&#39; return 0 to indicate success and -1 to indicate</div>
<div class="line">failure. s2n functions that return pointer types return NULL in the case of</div>
<div class="line">failure. When an s2n function returns a failure, s2n_errno will be set to a value</div>
<div class="line">corresponding to the error. This error value can be translated into a string</div>
<div class="line">explaining the error in English by calling s2n_strerror(s2n_errno, &quot;EN&quot;).</div>
<div class="line">A string containing human readable error name, can be generated with `s2n_strerror_name`.</div>
<div class="line">A string containing internal debug information, including filename and line number, can be generated with `s2n_strerror_debug`.</div>
<div class="line">This string is useful to include when reporting issues to the s2n development team.</div>
<div class="line"> </div>
<div class="line">Example:</div>
</div><!-- fragment --><p> if (s2n_config_set_cipher_preferences(config, prefs) &lt; 0) { printf("Setting cipher prefs failed! %s : %s", s2n_strerror(s2n_errno, "EN"), s2n_strerror_debug(s2n_errno, "EN")); return -1; } </p><div class="fragment"><div class="line">**NOTE**: To avoid possible confusion, s2n_errno should be cleared after processing an error: `s2n_errno = S2N_ERR_T_OK`</div>
<div class="line"> </div>
<div class="line">### Stacktraces</div>
<div class="line">s2n has an mechanism to capture stacktraces when errors occur.</div>
<div class="line">This mechanism is off by default, but can be enabled in code by calling `s2n_stack_traces_enabled_set()`.</div>
<div class="line">It can be enabled globally by setting the environment variable `S2N_PRINT_STACKTRACE=1`.</div>
<div class="line">Note that enabling stacktraces this can significantly slow down unit tests, and can cause failures on unit-tests (such as `s2n_cbc_verify`) that measure the timing of events.</div>
</div><!-- fragment --><p> bool <a class="el" href="s2n_8h.html#ad2220ac8657a5417ee02e8da3b7789b1">s2n_stack_traces_enabled()</a>; int <a class="el" href="s2n__errno_8h.html#aa2f3c467dc21f58b5b241f4faa950eaa">s2n_stack_traces_enabled_set(bool newval)</a>;</p>
<p >int <a class="el" href="tests_2sidetrail_2working_2stubs_2s2n__errno_8c.html#a6e68e1334f36bdd03f6a42a1a2cdcef3">s2n_calculate_stacktrace(void)</a>; int s2n_print_stacktrace(FILE &lt;em&gt;fptr); int <a class="el" href="s2n__errno_8h.html#a74a46ac1b1ada76dea3675fddaf11e19">s2n_free_stacktrace(void)</a>; int s2n_get_stacktrace(char*** trace, int trace_size); </p><div class="fragment"><div class="line">### Error categories</div>
<div class="line"> </div>
<div class="line">s2n organizes errors into different &quot;types&quot; to allow applications to do logic on error values without catching all possibilities. </div>
<div class="line">Applications using non-blocking I/O should check error type to determine if the I/O operation failed because it would block or for some other error. To retrieve the type for a given error use `s2n_error_get_type()`.</div>
<div class="line">Applications should perform any error handling logic using these high level types:</div>
</div><!-- fragment --><p> S2N_ERR_T_OK=0, /* No error */ S2N_ERR_T_IO, /* Underlying I/O operation failed, check system errno */ S2N_ERR_T_CLOSED, /* EOF */ S2N_ERR_T_BLOCKED, /* Underlying I/O operation would block */ S2N_ERR_T_ALERT, /* Incoming Alert */ S2N_ERR_T_PROTO, /* Failure in some part of the TLS protocol. Ex: CBC verification failure */ S2N_ERR_T_INTERNAL, /* Error internal to s2n. A precondition could have failed. */ S2N_ERR_T_USAGE /* User input error. Ex: Providing an invalid cipher preference version */ </p><div class="fragment"><div class="line">Here&#39;s an example that handles errors based on type:</div>
</div><!-- fragment --><p> s2n_errno = S2N_ERR_T_OK; if (s2n_recv(conn, &amp;blocked) &lt; 0) { switch(s2n_error_get_type(s2n_errno)) { case S2N_ERR_T_BLOCKED: /* Blocked, come back later */ return -1; case S2N_ERR_T_CLOSED: return 0; case S2N_ERR_T_IO: handle_io_err(); return -1; case S2N_ERR_T_PROTO: handle_proto_err(); return -1; case S2N_ERR_T_ALERT: log_alert(s2n_connection_get_alert(conn)); return -1; /* Everything else */ default: log_other_error(); return -1; } } </p><div class="fragment"><div class="line">## Initialization and teardown</div>
<div class="line"> </div>
<div class="line">### s2n\_get\_openssl\_version</div>
<div class="line"> </div>
<div class="line">```c</div>
<div class="line">unsigned long s2n_get_openssl_version();</div>
</div><!-- fragment --><p ><b>s2n_get_openssl_version</b> returns the version number of OpenSSL that s2n was compiled with. It can be used by applications to validate at runtime that the versions of s2n and Openssl that they have loaded are correct.</p>
<h3><a class="anchor" id="autotoc_md379"></a>
s2n_init</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a41b65ad20272f232f12c8ae36578d372">s2n_init</a>();</div>
<div class="ttc" id="as2n_8h_html_a41b65ad20272f232f12c8ae36578d372"><div class="ttname"><a href="s2n_8h.html#a41b65ad20272f232f12c8ae36578d372">s2n_init</a></div><div class="ttdeci">S2N_API int s2n_init(void)</div></div>
</div><!-- fragment --><p ><b>s2n_init</b> initializes the s2n library and should be called once in your application, before any other s2n functions are called. Failure to call <a class="el" href="s2n_8h.html#a41b65ad20272f232f12c8ae36578d372">s2n_init()</a> will result in errors from other s2n functions.</p>
<h3><a class="anchor" id="autotoc_md380"></a>
s2n_cleanup</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a6bec40a852f3766f4e419684036e7550">s2n_cleanup</a>();</div>
<div class="ttc" id="as2n_8h_html_a6bec40a852f3766f4e419684036e7550"><div class="ttname"><a href="s2n_8h.html#a6bec40a852f3766f4e419684036e7550">s2n_cleanup</a></div><div class="ttdeci">S2N_API int s2n_cleanup(void)</div></div>
</div><!-- fragment --><p ><b>s2n_cleanup</b> cleans up any internal resources used by s2n. This function should be called from each thread or process that is created subsequent to calling <b>s2n_init</b> when that thread or process is done calling other s2n functions.</p>
<h2><a class="anchor" id="autotoc_md381"></a>
Configuration-oriented functions</h2>
<h3><a class="anchor" id="autotoc_md382"></a>
s2n_config_new</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__config.html">s2n_config</a> * <a class="code hl_function" href="s2n_8h.html#a1a630424b3a07e0a4880ff465766c996">s2n_config_new</a>();</div>
<div class="ttc" id="as2n_8h_html_a1a630424b3a07e0a4880ff465766c996"><div class="ttname"><a href="s2n_8h.html#a1a630424b3a07e0a4880ff465766c996">s2n_config_new</a></div><div class="ttdeci">S2N_API struct s2n_config * s2n_config_new(void)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:279</div></div>
</div><!-- fragment --><p ><b>s2n_config_new</b> returns a new configuration object suitable for associating certs and keys. This object can (and should) be associated with many connection objects.</p>
<h3><a class="anchor" id="autotoc_md383"></a>
s2n_config_free</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a414a19458d8ce45e039dbd01e7dd67f4">s2n_config_free</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>);</div>
<div class="ttc" id="as2n_8h_html_a414a19458d8ce45e039dbd01e7dd67f4"><div class="ttname"><a href="s2n_8h.html#a414a19458d8ce45e039dbd01e7dd67f4">s2n_config_free</a></div><div class="ttdeci">S2N_API int s2n_config_free(struct s2n_config *config)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:355</div></div>
<div class="ttc" id="as2n__client__key__recv__fuzz__test_8c_html_a7d70bb7bed95daae1233293126bb9523"><div class="ttname"><a href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a></div><div class="ttdeci">struct s2n_config * config</div><div class="ttdef"><b>Definition:</b> s2n_client_key_recv_fuzz_test.c:47</div></div>
</div><!-- fragment --><p ><b>s2n_config_free</b> frees the memory associated with an <b><a class="el" href="structs2n__config.html">s2n_config</a></b> object.</p>
<h3><a class="anchor" id="autotoc_md384"></a>
s2n_config_set_cipher_preferences</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a3afea5198d804621399d8fd9875cfdb0">s2n_config_set_cipher_preferences</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *version);</div>
<div class="ttc" id="as2n_8h_html_a3afea5198d804621399d8fd9875cfdb0"><div class="ttname"><a href="s2n_8h.html#a3afea5198d804621399d8fd9875cfdb0">s2n_config_set_cipher_preferences</a></div><div class="ttdeci">S2N_API int s2n_config_set_cipher_preferences(struct s2n_config *config, const char *version)</div><div class="ttdef"><b>Definition:</b> s2n_security_policies.c:607</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_cipher_preferences</b> sets the security policy that includes the cipher/kem/signature/ecc preferences and protocol version.</p>
<p >The following chart maps the security policy version to protocol version and ciphertsuites supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">version   </th><th class="markdownTableHeadNone">SSLv3   </th><th class="markdownTableHeadNone">TLS1.0   </th><th class="markdownTableHeadNone">TLS1.1   </th><th class="markdownTableHeadNone">TLS1.2   </th><th class="markdownTableHeadNone">TLS1.3   </th><th class="markdownTableHeadNone">AES-CBC   </th><th class="markdownTableHeadNone">ChaCha20-Poly1305   </th><th class="markdownTableHeadNone">ECDSA   </th><th class="markdownTableHeadNone">AES-GCM   </th><th class="markdownTableHeadNone">3DES   </th><th class="markdownTableHeadNone">RC4   </th><th class="markdownTableHeadNone">DHE   </th><th class="markdownTableHeadNone">ECDHE    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"default"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190214"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20170718"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20170405"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20170328"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20170210"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20160824"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20160804"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20160411"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20150306"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20150214"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20150202"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20141001"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20140601"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190120"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190121"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190122"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"default_tls13"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190801"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190802"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20200207"   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<p >The "default" and "default_tls13" version is special in that it will be updated with future s2n changes and ciphersuites and protocol versions may be added and removed, or their internal order of preference might change. Numbered versions are fixed and will never change.</p>
<p >"20160411" follows the same general preference order as "default". The main difference is it has a CBC cipher suite at the top. This is to accomodate certain Java clients that have poor GCM implementations. Users of s2n who have found GCM to be hurting performance for their clients should consider this version.</p>
<p >"20170405" is a FIPS compliant cipher suite preference list based on approved algorithms in the <a href="http://csrc.nist.gov/publications/fips/fips140-2/fips1402annexa.pdf">FIPS 140-2 Annex A</a>. Similarly to "20160411", this perference list has CBC cipher suites at the top to accomodate certain Java clients. Users of s2n who plan to enable FIPS mode should consider this version.</p>
<p >s2n does not expose an API to control the order of preference for each ciphersuite or protocol version. s2n follows the following order:</p>
<p ><em>NOTE</em>: All ChaCha20-Poly1305 cipher suites will not be available if s2n is not built with an Openssl 1.1.1 libcrypto. The underlying encrpyt/decrypt functions are not available in older versions.</p>
<ol type="1">
<li>Always prefer the highest protocol version supported</li>
<li>Always use forward secrecy where possible. Prefer ECDHE over DHE.</li>
<li>Prefer encryption ciphers in the following order: AES128, AES256, ChaCha20, 3DES, RC4.</li>
<li>Prefer record authentication modes in the following order: GCM, Poly1305, SHA256, SHA1, MD5.</li>
</ol>
<p >The following chart maps the security policy version to the signature scheme supported:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">version   </th><th class="markdownTableHeadNone">RSA PKCS1   </th><th class="markdownTableHeadNone">ECDSA   </th><th class="markdownTableHeadNone">SHA-1 Legacy   </th><th class="markdownTableHeadNone">RSA PSS    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"default"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190214"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20170718"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20170405"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20170328"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20170210"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20160824"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20160804"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20160411"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20150306"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20150214"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20150202"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20141001"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20140601"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190120"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190121"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190122"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"default_tls13"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190801"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190802"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20200207"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td></tr>
</table>
<p >The following chart maps the security policy version to the supported curves/groups:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">version   </th><th class="markdownTableHeadNone">secp256r1   </th><th class="markdownTableHeadNone">secp384r1   </th><th class="markdownTableHeadNone">x25519    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"default"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190214"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20170718"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20170405"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20170328"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20170210"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20160824"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20160804"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20160411"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20150306"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20150214"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20150202"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20141001"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20140601"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190120"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190121"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190122"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"default_tls13"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20190801"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">"20190802"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">"20200207"   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">X   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md385"></a>
s2n_config_add_cert_chain_and_key</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a5f2c5705a56cdb5f9ca4932a24f838e1">s2n_config_add_cert_chain_and_key</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, </div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#afe7b0f9b616ebe87d4d14178d9bb5188">cert_chain_pem</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a21bdfa791001d9f2f5df9c0d3602a1e1">private_key_pem</a>);</div>
<div class="ttc" id="as2n_8h_html_a5f2c5705a56cdb5f9ca4932a24f838e1"><div class="ttname"><a href="s2n_8h.html#a5f2c5705a56cdb5f9ca4932a24f838e1">s2n_config_add_cert_chain_and_key</a></div><div class="ttdeci">S2N_API int s2n_config_add_cert_chain_and_key(struct s2n_config *config, const char *cert_chain_pem, const char *private_key_pem)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:470</div></div>
<div class="ttc" id="as2n__client__key__recv__fuzz__test_8c_html_a21bdfa791001d9f2f5df9c0d3602a1e1"><div class="ttname"><a href="s2n__client__key__recv__fuzz__test_8c.html#a21bdfa791001d9f2f5df9c0d3602a1e1">private_key_pem</a></div><div class="ttdeci">char * private_key_pem</div><div class="ttdef"><b>Definition:</b> s2n_client_key_recv_fuzz_test.c:45</div></div>
<div class="ttc" id="as2n__client__key__recv__fuzz__test_8c_html_afe7b0f9b616ebe87d4d14178d9bb5188"><div class="ttname"><a href="s2n__client__key__recv__fuzz__test_8c.html#afe7b0f9b616ebe87d4d14178d9bb5188">cert_chain_pem</a></div><div class="ttdeci">char * cert_chain_pem</div><div class="ttdef"><b>Definition:</b> s2n_client_key_recv_fuzz_test.c:44</div></div>
</div><!-- fragment --><p ><b>s2n_config_add_cert_chain_and_key</b> associates a certificate chain and a private key, with an <b><a class="el" href="structs2n__config.html">s2n_config</a></b> object. At present, only one certificate-chain/key pair may be associated with a config.</p>
<p ><b>cert_chain_pem</b> should be a PEM encoded certificate chain, with the first certificate in the chain being your servers certificate. <b>private_key_pem</b> should be a PEM encoded private key corresponding to the server certificate.</p>
<h3><a class="anchor" id="autotoc_md386"></a>
s2n_config_add_cert_chain_and_key_to_store</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#abfb875eff7e81b22378e4ae5b313169f">s2n_config_add_cert_chain_and_key_to_store</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, </div>
<div class="line">                                               <span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *cert_key_pair);</div>
<div class="ttc" id="as2n_8h_html_abfb875eff7e81b22378e4ae5b313169f"><div class="ttname"><a href="s2n_8h.html#abfb875eff7e81b22378e4ae5b313169f">s2n_config_add_cert_chain_and_key_to_store</a></div><div class="ttdeci">S2N_API int s2n_config_add_cert_chain_and_key_to_store(struct s2n_config *config, struct s2n_cert_chain_and_key *cert_key_pair)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:481</div></div>
<div class="ttc" id="astructs2n__cert__chain__and__key_html"><div class="ttname"><a href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a></div><div class="ttdef"><b>Definition:</b> s2n_certificate.h:40</div></div>
</div><!-- fragment --><p ><b>s2n_config_add_cert_chain_and_key_to_store</b> is the preferred method of associating a certificate chain and private key pair with an <b><a class="el" href="structs2n__config.html">s2n_config</a></b> object. It is not recommended to free or modify the <b>cert_key_pair</b> as any subsequent changes will be reflected in the config.</p>
<p ><b>s2n_config_add_cert_chain_and_key_to_store</b> may be called multiple times to support multiple key types(RSA, ECDSA) and multiple domains. On the server side, the certificate selected will be based on the incoming SNI value and the client's capabilities(supported ciphers). In the case of no certificate matching the client's SNI extension or if no SNI extension was sent by the client, the certificate from the <b>first</b> call to <b>s2n_config_add_cert_chain_and_key_to_store</b> will be selected.</p>
<h3><a class="anchor" id="autotoc_md387"></a>
s2n_config_set_cert_chain_and_key_defaults</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a30d021a10ad7183c995d6d2a65926272">s2n_config_set_cert_chain_and_key_defaults</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>,</div>
<div class="line">                                               <span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> **cert_key_pairs,</div>
<div class="line">                                               uint32_t num_cert_key_pairs);</div>
<div class="ttc" id="as2n_8h_html_a30d021a10ad7183c995d6d2a65926272"><div class="ttname"><a href="s2n_8h.html#a30d021a10ad7183c995d6d2a65926272">s2n_config_set_cert_chain_and_key_defaults</a></div><div class="ttdeci">S2N_API int s2n_config_set_cert_chain_and_key_defaults(struct s2n_config *config, struct s2n_cert_chain_and_key **cert_key_pairs, uint32_t num_cert_key_pairs)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:518</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_cert_chain_and_key_defaults</b> explicitly sets certificate chain and private key pairs to be used as defaults for each auth method (key type). A "default" certificate is used when there is not an SNI match with any other configured certificate. Only one certificate can be set as the default per auth method (one RSA default, one ECDSA default, etc.). All previous default certificates will be cleared and re-set when this API is called. This API is called for a specific <b><a class="el" href="structs2n__config.html">s2n_config</a></b> object.</p>
<p >S2N will attempt to automatically choose default certificates for each auth method (key type) based on the order that <b><a class="el" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a></b> are added to the <b><a class="el" href="structs2n__config.html">s2n_config</a></b> using one of the APIs listed above. <b>s2n_config_set_cert_chain_and_key_defaults</b> can be called at any time; s2n will clear defaults and no longer attempt to automatically choose any default certificates.</p>
<h3><a class="anchor" id="autotoc_md388"></a>
s2n_cert_tiebreak_callback</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a>* (*s2n_cert_tiebreak_callback) (<span class="keyword">struct </span><a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *cert1, <span class="keyword">struct </span><a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *cert2, uint8_t *<a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a>, uint32_t name_len);</div>
<div class="ttc" id="aaws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_html_a25d22ecc7e656d2c59332072684e8766"><div class="ttname"><a href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a></div><div class="ttdeci">const char *const name</div><div class="ttdef"><b>Definition:</b> cJSON.h:266</div></div>
</div><!-- fragment --><p ><b>s2n_cert_tiebreak_callback</b> is invoked if s2n cannot resolve a conflict between two certificates with the same domain name. This function is invoked while certificates are added to an <b><a class="el" href="structs2n__config.html">s2n_config</a></b>. Currently, the only builtin resolution for domain name conflicts is certificate type(RSA, ECDSA, etc). The callback should return a pointer to the <b><a class="el" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a></b> that should be used for dns name <b>name</b>. If NULL is returned, the first certificate will be used. Typically an application will use properties like trust and expiry to implement tiebreaking.</p>
<h3><a class="anchor" id="autotoc_md389"></a>
s2n_config_set_cert_tiebreak_callback</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a08f2dab761bbb4b3eec095763a28f7af">s2n_config_set_cert_tiebreak_callback</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_typedef" href="s2n_8h.html#ac613789e3ed4958426ae8fd987faae4e">s2n_cert_tiebreak_callback</a> tiebreak_fn);</div>
<div class="ttc" id="as2n_8h_html_a08f2dab761bbb4b3eec095763a28f7af"><div class="ttname"><a href="s2n_8h.html#a08f2dab761bbb4b3eec095763a28f7af">s2n_config_set_cert_tiebreak_callback</a></div><div class="ttdeci">S2N_API int s2n_config_set_cert_tiebreak_callback(struct s2n_config *config, s2n_cert_tiebreak_callback cert_tiebreak_cb)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:814</div></div>
<div class="ttc" id="as2n_8h_html_ac613789e3ed4958426ae8fd987faae4e"><div class="ttname"><a href="s2n_8h.html#ac613789e3ed4958426ae8fd987faae4e">s2n_cert_tiebreak_callback</a></div><div class="ttdeci">struct s2n_cert_chain_and_key *(* s2n_cert_tiebreak_callback)(struct s2n_cert_chain_and_key *cert1, struct s2n_cert_chain_and_key *cert2, uint8_t *name, uint32_t name_len)</div><div class="ttdef"><b>Definition:</b> s2n.h:179</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_cert_tiebreak_callback</b> sets the <b>s2n_cert_tiebreak_callback</b> for resolving domain name conflicts. If no callback is set, the first certificate added for a domain name will always be preferred.</p>
<h3><a class="anchor" id="autotoc_md390"></a>
s2n_config_add_dhparams</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a8e9f9e33817a4984217de79b55b7c607">s2n_config_add_dhparams</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, </div>
<div class="line">                            <span class="keywordtype">char</span> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#aac3b2fbc2d3a68db0f32d1af9530a8a4">dhparams_pem</a>);</div>
<div class="ttc" id="as2n_8h_html_a8e9f9e33817a4984217de79b55b7c607"><div class="ttname"><a href="s2n_8h.html#a8e9f9e33817a4984217de79b55b7c607">s2n_config_add_dhparams</a></div><div class="ttdeci">S2N_API int s2n_config_add_dhparams(struct s2n_config *config, const char *dhparams_pem)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:546</div></div>
<div class="ttc" id="as2n__client__key__recv__fuzz__test_8c_html_aac3b2fbc2d3a68db0f32d1af9530a8a4"><div class="ttname"><a href="s2n__client__key__recv__fuzz__test_8c.html#aac3b2fbc2d3a68db0f32d1af9530a8a4">dhparams_pem</a></div><div class="ttdeci">char * dhparams_pem</div><div class="ttdef"><b>Definition:</b> s2n_client_key_recv_fuzz_test.c:46</div></div>
</div><!-- fragment --><p ><b>s2n_config_add_dhparams</b> associates a set of Diffie-Hellman parameters with an <b><a class="el" href="structs2n__config.html">s2n_config</a></b> object. <b>dhparams_pem</b> should be PEM encoded DH parameters.</p>
<h3><a class="anchor" id="autotoc_md391"></a>
s2n_config_set_protocol_preferences</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a983bbc96f19466c51529501c63004910">s2n_config_set_protocol_preferences</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>,</div>
<div class="line">                                        <span class="keyword">const</span> <span class="keywordtype">char</span> **protocols,</div>
<div class="line">                                        <span class="keywordtype">int</span> protocol_count);</div>
<div class="ttc" id="as2n_8h_html_a983bbc96f19466c51529501c63004910"><div class="ttname"><a href="s2n_8h.html#a983bbc96f19466c51529501c63004910">s2n_config_set_protocol_preferences</a></div><div class="ttdeci">S2N_API int s2n_config_set_protocol_preferences(struct s2n_config *config, const char *const *protocols, int protocol_count)</div><div class="ttdef"><b>Definition:</b> s2n_protocol_preferences.c:47</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_protocol_preferences</b> sets the application protocol preferences on an <b><a class="el" href="structs2n__config.html">s2n_config</a></b> object. <b>protocols</b> is a list in order of preference, with most preferred protocol first, and of length <b>protocol_count</b>. When acting as an <b>S2N_CLIENT</b> the protocol list is included in the Client Hello message as the ALPN extension. As an <b>S2N_SERVER</b>, the list is used to negotiate a mutual application protocol with the client. After the negotiation for the connection has completed, the agreed upon protocol can be retrieved with <a href="#s2n_get_application_protocol">s2n_get_application_protocol</a></p>
<h3><a class="anchor" id="autotoc_md392"></a>
s2n_config_set_status_request_type</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a380252ebdd5077b7436a23c2cf7458c0">s2n_config_set_status_request_type</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_enumeration" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635">s2n_status_request_type</a> <a class="code hl_variable" href="namespacecreate-projects.html#a8e98101a40c3e8a674b8023e90df2b7c">type</a>);</div>
<div class="ttc" id="anamespacecreate-projects_html_a8e98101a40c3e8a674b8023e90df2b7c"><div class="ttname"><a href="namespacecreate-projects.html#a8e98101a40c3e8a674b8023e90df2b7c">create-projects.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> create-projects.py:9</div></div>
<div class="ttc" id="as2n_8h_html_a380252ebdd5077b7436a23c2cf7458c0"><div class="ttname"><a href="s2n_8h.html#a380252ebdd5077b7436a23c2cf7458c0">s2n_config_set_status_request_type</a></div><div class="ttdeci">S2N_API int s2n_config_set_status_request_type(struct s2n_config *config, s2n_status_request_type type)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:437</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_status_request_type</b> Sets up an S2N_CLIENT to request the server certificate status during an SSL handshake. If set to S2N_STATUS_REQUEST_NONE, no status request is made.</p>
<h3><a class="anchor" id="autotoc_md393"></a>
s2n_config_set_extension_data</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a2250c2b461d0814c4e5dd969d0f372f1">s2n_config_set_extension_data</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_enumeration" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8">s2n_tls_extension_type</a> <a class="code hl_variable" href="namespacecreate-projects.html#a8e98101a40c3e8a674b8023e90df2b7c">type</a>, <span class="keyword">const</span> uint8_t *data, uint32_t <a class="code hl_typedef" href="iocp__event__loop_8c.html#ae809d5359ac030c60a30a8f0b2294b82">length</a>);</div>
<div class="ttc" id="aiocp__event__loop_8c_html_ae809d5359ac030c60a30a8f0b2294b82"><div class="ttname"><a href="iocp__event__loop_8c.html#ae809d5359ac030c60a30a8f0b2294b82">length</a></div><div class="ttdeci">struct IO_STATUS_BLOCK void ULONG length</div><div class="ttdef"><b>Definition:</b> iocp_event_loop.c:49</div></div>
<div class="ttc" id="as2n_8h_html_a2250c2b461d0814c4e5dd969d0f372f1"><div class="ttname"><a href="s2n_8h.html#a2250c2b461d0814c4e5dd969d0f372f1">s2n_config_set_extension_data</a></div><div class="ttdeci">S2N_API int s2n_config_set_extension_data(struct s2n_config *config, s2n_tls_extension_type type, const uint8_t *data, uint32_t length)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:622</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8">s2n_tls_extension_type</a></div><div class="ttdeci">s2n_tls_extension_type</div><div class="ttdef"><b>Definition:</b> s2n.h:142</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_extension_data</b> Sets the extension data in the <b><a class="el" href="structs2n__config.html">s2n_config</a></b> object for the specified extension. This method will clear any existing data that is set. If the data and length parameters are set to NULL, no new data is set in the <b><a class="el" href="structs2n__config.html">s2n_config</a></b> object, effectively clearing existing data.</p>
<p ><code>s2n_tls_extension_type</code> is defined as:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8ab2c711604dc18dbb29e4389f884188cc">S2N_EXTENSION_SERVER_NAME</a> = 0,</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a1a6f06d62f6185f16875fca45112b050">S2N_EXTENSION_MAX_FRAG_LEN</a> = 1,</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a9fc679e7aee8c0483fccdfc644cb1a38">S2N_EXTENSION_OCSP_STAPLING</a> = 5,</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8af9557bb899ffb162e1cf3b193440dd0f">S2N_EXTENSION_SUPPORTED_GROUPS</a> = 10,</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8ae8a7f1a728a5d9edb48b52929c9b4c56">S2N_EXTENSION_EC_POINT_FORMATS</a> = 11,</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a184702a2959a5d269f85624f57a3915a">S2N_EXTENSION_SIGNATURE_ALGORITHMS</a> = 13,</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a7892d1594acce60389daedaf0e71ac33">S2N_EXTENSION_ALPN</a> = 16,</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8ab0e2a83b98d74880c6239a4c65e7c894">S2N_EXTENSION_CERTIFICATE_TRANSPARENCY</a> = 18,</div>
<div class="line">  <a class="code hl_enumvalue" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a53e14c3ec34453dbfb7837d4fe680f45">S2N_EXTENSION_RENEGOTIATION_INFO</a> = 65281,</div>
<div class="line">} <a class="code hl_enumeration" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8">s2n_tls_extension_type</a>;</div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8a184702a2959a5d269f85624f57a3915a"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a184702a2959a5d269f85624f57a3915a">S2N_EXTENSION_SIGNATURE_ALGORITHMS</a></div><div class="ttdeci">@ S2N_EXTENSION_SIGNATURE_ALGORITHMS</div><div class="ttdef"><b>Definition:</b> s2n.h:148</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8a1a6f06d62f6185f16875fca45112b050"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a1a6f06d62f6185f16875fca45112b050">S2N_EXTENSION_MAX_FRAG_LEN</a></div><div class="ttdeci">@ S2N_EXTENSION_MAX_FRAG_LEN</div><div class="ttdef"><b>Definition:</b> s2n.h:144</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8a53e14c3ec34453dbfb7837d4fe680f45"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a53e14c3ec34453dbfb7837d4fe680f45">S2N_EXTENSION_RENEGOTIATION_INFO</a></div><div class="ttdeci">@ S2N_EXTENSION_RENEGOTIATION_INFO</div><div class="ttdef"><b>Definition:</b> s2n.h:151</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8a7892d1594acce60389daedaf0e71ac33"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a7892d1594acce60389daedaf0e71ac33">S2N_EXTENSION_ALPN</a></div><div class="ttdeci">@ S2N_EXTENSION_ALPN</div><div class="ttdef"><b>Definition:</b> s2n.h:149</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8a9fc679e7aee8c0483fccdfc644cb1a38"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8a9fc679e7aee8c0483fccdfc644cb1a38">S2N_EXTENSION_OCSP_STAPLING</a></div><div class="ttdeci">@ S2N_EXTENSION_OCSP_STAPLING</div><div class="ttdef"><b>Definition:</b> s2n.h:145</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8ab0e2a83b98d74880c6239a4c65e7c894"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8ab0e2a83b98d74880c6239a4c65e7c894">S2N_EXTENSION_CERTIFICATE_TRANSPARENCY</a></div><div class="ttdeci">@ S2N_EXTENSION_CERTIFICATE_TRANSPARENCY</div><div class="ttdef"><b>Definition:</b> s2n.h:150</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8ab2c711604dc18dbb29e4389f884188cc"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8ab2c711604dc18dbb29e4389f884188cc">S2N_EXTENSION_SERVER_NAME</a></div><div class="ttdeci">@ S2N_EXTENSION_SERVER_NAME</div><div class="ttdef"><b>Definition:</b> s2n.h:143</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8ae8a7f1a728a5d9edb48b52929c9b4c56"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8ae8a7f1a728a5d9edb48b52929c9b4c56">S2N_EXTENSION_EC_POINT_FORMATS</a></div><div class="ttdeci">@ S2N_EXTENSION_EC_POINT_FORMATS</div><div class="ttdef"><b>Definition:</b> s2n.h:147</div></div>
<div class="ttc" id="as2n_8h_html_ab2b46f61765da5529f931afb8dd8a1f8af9557bb899ffb162e1cf3b193440dd0f"><div class="ttname"><a href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8af9557bb899ffb162e1cf3b193440dd0f">S2N_EXTENSION_SUPPORTED_GROUPS</a></div><div class="ttdeci">@ S2N_EXTENSION_SUPPORTED_GROUPS</div><div class="ttdef"><b>Definition:</b> s2n.h:146</div></div>
</div><!-- fragment --><p >At this time the following extensions are supported:</p>
<p ><code>S2N_EXTENSION_OCSP_STAPLING</code> - If a client requests the OCSP status of the server certificate, this is the response used in the CertificateStatus handshake message.</p>
<p ><code>S2N_EXTENSION_CERTIFICATE_TRANSPARENCY</code> - If a client supports receiving SCTs via the TLS extension (section 3.3.1 of RFC6962) this data is returned within the extension response during the handshake. The format of this data is the SignedCertificateTimestampList structure defined in that document. See <a href="http://www.certificate-transparency.org/">http://www.certificate-transparency.org/</a> for more information about Certificate Transparency.</p>
<h3><a class="anchor" id="autotoc_md394"></a>
s2n_config_set_wall_clock</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a43c8ab4e5c773d3e0464ed41cc51bd5d">s2n_config_set_wall_clock</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_typedef" href="s2n_8h.html#a0cfed8d65c0e2c33cf666ee90eb06a7e">s2n_clock_time_nanoseconds</a> clock_fn, <span class="keywordtype">void</span> *data);</div>
<div class="ttc" id="as2n_8h_html_a0cfed8d65c0e2c33cf666ee90eb06a7e"><div class="ttname"><a href="s2n_8h.html#a0cfed8d65c0e2c33cf666ee90eb06a7e">s2n_clock_time_nanoseconds</a></div><div class="ttdeci">int(* s2n_clock_time_nanoseconds)(void *, uint64_t *)</div><div class="ttdef"><b>Definition:</b> s2n.h:86</div></div>
<div class="ttc" id="as2n_8h_html_a43c8ab4e5c773d3e0464ed41cc51bd5d"><div class="ttname"><a href="s2n_8h.html#a43c8ab4e5c773d3e0464ed41cc51bd5d">s2n_config_set_wall_clock</a></div><div class="ttdeci">S2N_API int s2n_config_set_wall_clock(struct s2n_config *config, s2n_clock_time_nanoseconds clock_fn, void *ctx)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:572</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_wall_clock</b> allows the caller to set a callback function that will be used to get the system time. The callback function takes two arguments; a pointer to abitrary data for use within the callback, and a pointer to a 64 bit unsigned integer. The first pointer will be set to the value of <b>data</b> which supplied by the caller when setting the callback. The integer pointed to by the second pointer should be set to the number of nanoseconds since the Unix epoch (Midnight, January 1st, 1970). The function should return 0 on success and -1 on error. The default implementation, which uses the REALTIME clock, will be used if this callback is not manually set.</p>
<h3><a class="anchor" id="autotoc_md395"></a>
s2n_config_set_monotonic_clock</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a7b11c2ca37417cf74606870711a08741">s2n_config_set_monotonic_clock</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_typedef" href="s2n_8h.html#a0cfed8d65c0e2c33cf666ee90eb06a7e">s2n_clock_time_nanoseconds</a> clock_fn, <span class="keywordtype">void</span> *data);</div>
<div class="ttc" id="as2n_8h_html_a7b11c2ca37417cf74606870711a08741"><div class="ttname"><a href="s2n_8h.html#a7b11c2ca37417cf74606870711a08741">s2n_config_set_monotonic_clock</a></div><div class="ttdeci">S2N_API int s2n_config_set_monotonic_clock(struct s2n_config *config, s2n_clock_time_nanoseconds clock_fn, void *ctx)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:582</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_monotonic_clock</b> allows the caller to set a callback function that will be used to get monotonic time. The callback function takes two arguments; a pointer to abitrary data for use within the callback, and a pointer to a 64 bit unsigned integer. The first pointer will be set to the value of <b>data</b> which supplied by the caller when setting the callback. The integer pointed to by the second pointer should be an always increasing value. The function should return 0 on success and -1 on error. The default implementation, which uses the MONOTONIC clock, will be used if this callback is not manually set.</p>
<h3><a class="anchor" id="autotoc_md396"></a>
s2n_config_set_verification_ca_location</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a85545629ce095ed44de580592eecf50e">s2n_config_set_verification_ca_location</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *ca_pem_filename, <span class="keyword">const</span> <span class="keywordtype">char</span> *ca_dir);</div>
<div class="ttc" id="as2n_8h_html_a85545629ce095ed44de580592eecf50e"><div class="ttname"><a href="s2n_8h.html#a85545629ce095ed44de580592eecf50e">s2n_config_set_verification_ca_location</a></div><div class="ttdeci">S2N_API int s2n_config_set_verification_ca_location(struct s2n_config *config, const char *ca_pem_filename, const char *ca_dir)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:457</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_verification_ca_location</b> initializes the trust store from a CA file or directory containing trusted certificates. By default, the trust store will be initialized to the common locations for the host operating system. Call this function to override that behavior. Returns 0 on success and -1 on failure.</p>
<h3><a class="anchor" id="autotoc_md397"></a>
s2n_config_add_pem_to_trust_store</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a1de5c0b7a1029ee248947835d4e170bc">s2n_config_add_pem_to_trust_store</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *pem);</div>
<div class="ttc" id="as2n_8h_html_a1de5c0b7a1029ee248947835d4e170bc"><div class="ttname"><a href="s2n_8h.html#a1de5c0b7a1029ee248947835d4e170bc">s2n_config_add_pem_to_trust_store</a></div><div class="ttdeci">S2N_API int s2n_config_add_pem_to_trust_store(struct s2n_config *config, const char *pem)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:447</div></div>
</div><!-- fragment --><p ><b>s2n_config_add_pem_to_trust_store</b> Initialize trust store from a PEM. This will allocate memory, and load PEM into the Trust Store</p>
<h3><a class="anchor" id="autotoc_md398"></a>
s2n_verify_host_fn</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> uint8_t (*<a class="code hl_typedef" href="s2n_8h.html#a8aa56850695a02753f726ea9860ec383">s2n_verify_host_fn</a>) (<span class="keyword">const</span> <span class="keywordtype">char</span> *host_name, <span class="keywordtype">size_t</span> host_name_len, <span class="keywordtype">void</span> *<a class="code hl_variable" href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a>);</div>
<div class="ttc" id="achannel__handler__test_8c_html_a1795d4ea01d211a7398ecd541c6f1302"><div class="ttname"><a href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a></div><div class="ttdeci">void * ctx</div><div class="ttdef"><b>Definition:</b> channel_handler_test.c:342</div></div>
<div class="ttc" id="as2n_8h_html_a8aa56850695a02753f726ea9860ec383"><div class="ttname"><a href="s2n_8h.html#a8aa56850695a02753f726ea9860ec383">s2n_verify_host_fn</a></div><div class="ttdeci">uint8_t(* s2n_verify_host_fn)(const char *host_name, size_t host_name_len, void *data)</div><div class="ttdef"><b>Definition:</b> s2n.h:197</div></div>
</div><!-- fragment --><p ><b>s2n_verify_host_fn</b> is invoked (usually multiple times) during X.509 validation for each name encountered in the leaf certificate. Return 1 to trust that hostname or 0 to not trust the hostname. If this function returns 1, then the certificate is considered trusted and that portion of the X.509 validation will succeed. If no hostname results in a 1 being returned, the certificate will be untrusted and the validation will terminate immediately. The default behavior is to reject all host names found in a certificate if client mode or client authentication is being used..</p>
<h3><a class="anchor" id="autotoc_md399"></a>
s2n_config_set_verify_host_callback</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a079022d5c18f4ffd64c1c6dedb3bbc66">s2n_config_set_verify_host_callback</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_typedef" href="s2n_8h.html#a8aa56850695a02753f726ea9860ec383">s2n_verify_host_fn</a>, <span class="keywordtype">void</span> *<a class="code hl_variable" href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a>);</div>
<div class="ttc" id="as2n_8h_html_a079022d5c18f4ffd64c1c6dedb3bbc66"><div class="ttname"><a href="s2n_8h.html#a079022d5c18f4ffd64c1c6dedb3bbc66">s2n_config_set_verify_host_callback</a></div><div class="ttdeci">S2N_API int s2n_config_set_verify_host_callback(struct s2n_config *config, s2n_verify_host_fn, void *data)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:402</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_verify_host_callback</b> sets the callback to use for verifying that a hostname from an X.509 certificate is trusted. By default, no certificate will be trusted. To override this behavior, set this callback. See <a href="#s2n_verify_host_fn">s2n_verify_host_fn</a> for details. This configuration will be inherited by default to new instances of <b><a class="el" href="structs2n__connection.html">s2n_connection</a></b>. If a separate callback for different connections using the same config is desired, see <a href="#s2n_connection_set_verify_host_callback">s2n_connection_set_verify_host_callback</a>.</p>
<h3><a class="anchor" id="autotoc_md400"></a>
s2n_config_set_check_stapled_ocsp_response</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#affff244d7ed6f3b8d1f885df1b307f4e">s2n_config_set_check_stapled_ocsp_response</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, uint8_t check_ocsp);</div>
<div class="ttc" id="as2n_8h_html_affff244d7ed6f3b8d1f885df1b307f4e"><div class="ttname"><a href="s2n_8h.html#affff244d7ed6f3b8d1f885df1b307f4e">s2n_config_set_check_stapled_ocsp_response</a></div><div class="ttdeci">S2N_API int s2n_config_set_check_stapled_ocsp_response(struct s2n_config *config, uint8_t check_ocsp)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:410</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_check_stapled_ocsp_response</b> toggles whether or not to validate stapled OCSP responses. 1 means OCSP responses will be validated when they are encountered, while 0 means this step will be skipped. The default value is 1 if the underlying libCrypto implementation supports OCSP. Returns 0 on success and -1 on failure.</p>
<h3><a class="anchor" id="autotoc_md401"></a>
s2n_config_disable_x509_verification</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#aa9d89fb59987254fe2546881d172be18">s2n_config_disable_x509_verification</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>);</div>
<div class="ttc" id="as2n_8h_html_aa9d89fb59987254fe2546881d172be18"><div class="ttname"><a href="s2n_8h.html#aa9d89fb59987254fe2546881d172be18">s2n_config_disable_x509_verification</a></div><div class="ttdeci">S2N_API int s2n_config_disable_x509_verification(struct s2n_config *config)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:418</div></div>
</div><!-- fragment --><p ><b>s2n_config_disable_x509_verification</b> turns off all X.509 validation during the negotiation phase of the connection. This should only be used for testing or debugging purposes.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#adbe1f248fa4510df373890a70f6f39b9">s2n_config_set_max_cert_chain_depth</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, uint16_t max_depth);</div>
<div class="ttc" id="as2n_8h_html_adbe1f248fa4510df373890a70f6f39b9"><div class="ttname"><a href="s2n_8h.html#adbe1f248fa4510df373890a70f6f39b9">s2n_config_set_max_cert_chain_depth</a></div><div class="ttdeci">S2N_API int s2n_config_set_max_cert_chain_depth(struct s2n_config *config, uint16_t max_depth)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:426</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_max_cert_chain_depth</b> sets the maximum allowed depth of a cert chain used for X509 validation. The default value is 7. If this limit is exceeded, validation will fail if <a class="el" href="s2n_8h.html#aa9d89fb59987254fe2546881d172be18">s2n_config_disable_x509_verification()</a> has not been called. 0 is an illegal value and will return an error. 1 means only a root certificate will be used.</p>
<h3><a class="anchor" id="autotoc_md402"></a>
s2n_config_set_client_hello_cb</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#aaae98777bf82821ce4d1989d224a50c0">s2n_config_set_client_hello_cb</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_typedef" href="s2n_8h.html#a0451dcbf88fdf09f36a82cab4d25d44e">s2n_client_hello_fn</a> client_hello_callback, <span class="keywordtype">void</span> *<a class="code hl_variable" href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a>);</div>
<div class="ttc" id="as2n_8h_html_a0451dcbf88fdf09f36a82cab4d25d44e"><div class="ttname"><a href="s2n_8h.html#a0451dcbf88fdf09f36a82cab4d25d44e">s2n_client_hello_fn</a></div><div class="ttdeci">int s2n_client_hello_fn(struct s2n_connection *conn, void *ctx)</div><div class="ttdef"><b>Definition:</b> s2n.h:259</div></div>
<div class="ttc" id="as2n_8h_html_aaae98777bf82821ce4d1989d224a50c0"><div class="ttname"><a href="s2n_8h.html#aaae98777bf82821ce4d1989d224a50c0">s2n_config_set_client_hello_cb</a></div><div class="ttdeci">S2N_API int s2n_config_set_client_hello_cb(struct s2n_config *config, s2n_client_hello_fn client_hello_callback, void *ctx)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:648</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_client_hello_cb</b> allows the caller to set a callback function that will be called after ClientHello was parsed.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code hl_typedef" href="s2n_8h.html#a0451dcbf88fdf09f36a82cab4d25d44e">s2n_client_hello_fn</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keywordtype">void</span> *<a class="code hl_variable" href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a>);</div>
</div><!-- fragment --><p >The callback function take as an input s2n connection, which received ClientHello and context provided in <b>s2n_config_set_client_hello_cb</b>. The callback can get any ClientHello information from the connection and use <b>s2n_connection_set_config</b> call to change the config of the connection.</p>
<p >If any of the properties of the connection were changed based on server_name extension the callback must return 1, otherwise the callback can return 0 to continue handshake in s2n or it can return negative value to make s2n terminate handshake early with fatal handshake failure alert.</p>
<h3><a class="anchor" id="autotoc_md403"></a>
s2n_config_set_alert_behavior</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a59b3ba39cc1b929310270d4fe5ac1b02">s2n_config_set_alert_behavior</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_enumeration" href="s2n_8h.html#ab8d3f62254ec4211d47cc841dea76abd">s2n_alert_behavior</a> alert_behavior);</div>
<div class="ttc" id="as2n_8h_html_a59b3ba39cc1b929310270d4fe5ac1b02"><div class="ttname"><a href="s2n_8h.html#a59b3ba39cc1b929310270d4fe5ac1b02">s2n_config_set_alert_behavior</a></div><div class="ttdeci">S2N_API int s2n_config_set_alert_behavior(struct s2n_config *config, s2n_alert_behavior alert_behavior)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:386</div></div>
<div class="ttc" id="as2n_8h_html_ab8d3f62254ec4211d47cc841dea76abd"><div class="ttname"><a href="s2n_8h.html#ab8d3f62254ec4211d47cc841dea76abd">s2n_alert_behavior</a></div><div class="ttdeci">s2n_alert_behavior</div><div class="ttdef"><b>Definition:</b> s2n.h:221</div></div>
</div><!-- fragment --><p> Sets whether or not a connection should terminate on receiving a WARNING alert from its peer. <code>alert_behavior</code> can take the following values:</p><ul>
<li><code>S2N_ALERT_FAIL_ON_WARNINGS</code> - default behavior: s2n will terminate the connection if its peer sends a WARNING alert.</li>
<li><code>S2N_ALERT_IGNORE_WARNINGS</code> - with the exception of <code>close_notify</code> s2n will ignore all WARNING alerts and keep communicating with its peer.</li>
</ul>
<p >This setting is ignored in TLS1.3. TLS1.3 terminates a connection for all alerts except user_canceled.</p>
<h2><a class="anchor" id="autotoc_md404"></a>
Certificate-related functions</h2>
<h3><a class="anchor" id="autotoc_md405"></a>
s2n_cert_chain_and_key_new</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *<a class="code hl_function" href="s2n_8h.html#a7a5c422f9e1befd117001562c467f432">s2n_cert_chain_and_key_new</a>(<span class="keywordtype">void</span>);</div>
<div class="ttc" id="as2n_8h_html_a7a5c422f9e1befd117001562c467f432"><div class="ttname"><a href="s2n_8h.html#a7a5c422f9e1befd117001562c467f432">s2n_cert_chain_and_key_new</a></div><div class="ttdeci">S2N_API struct s2n_cert_chain_and_key * s2n_cert_chain_and_key_new(void)</div><div class="ttdef"><b>Definition:</b> s2n_certificate.c:154</div></div>
</div><!-- fragment --><p> <b>s2n_cert_chain_and_key_new</b> returns a new object used to represent a certificate-chain/key pair. This object can be associated with many config objects.</p>
<h3><a class="anchor" id="autotoc_md406"></a>
s2n_cert_chain_and_key_free</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a7bfe337472559cc966e735604bc8090b">s2n_cert_chain_and_key_free</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *cert_and_key);</div>
<div class="ttc" id="as2n_8h_html_a7bfe337472559cc966e735604bc8090b"><div class="ttname"><a href="s2n_8h.html#a7bfe337472559cc966e735604bc8090b">s2n_cert_chain_and_key_free</a></div><div class="ttdeci">S2N_API int s2n_cert_chain_and_key_free(struct s2n_cert_chain_and_key *cert_and_key)</div><div class="ttdef"><b>Definition:</b> s2n_certificate.c:338</div></div>
</div><!-- fragment --><p> <b>s2n_cert_chain_and_key_free</b> frees the memory associated with an <b><a class="el" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a></b> object.</p>
<h3><a class="anchor" id="autotoc_md407"></a>
s2n_cert_chain_and_key_load_pem</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#aeeca285084f87f4c21298ea21ed057a7">s2n_cert_chain_and_key_load_pem</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#aac2a6f1aab996a327b37797f9c1209ae">chain_and_key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *chain_pem, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a21bdfa791001d9f2f5df9c0d3602a1e1">private_key_pem</a>);</div>
<div class="ttc" id="as2n_8h_html_aeeca285084f87f4c21298ea21ed057a7"><div class="ttname"><a href="s2n_8h.html#aeeca285084f87f4c21298ea21ed057a7">s2n_cert_chain_and_key_load_pem</a></div><div class="ttdeci">S2N_API int s2n_cert_chain_and_key_load_pem(struct s2n_cert_chain_and_key *chain_and_key, const char *chain_pem, const char *private_key_pem)</div><div class="ttdef"><b>Definition:</b> s2n_certificate.c:315</div></div>
<div class="ttc" id="as2n__client__key__recv__fuzz__test_8c_html_aac2a6f1aab996a327b37797f9c1209ae"><div class="ttname"><a href="s2n__client__key__recv__fuzz__test_8c.html#aac2a6f1aab996a327b37797f9c1209ae">chain_and_key</a></div><div class="ttdeci">struct s2n_cert_chain_and_key * chain_and_key</div><div class="ttdef"><b>Definition:</b> s2n_client_key_recv_fuzz_test.c:48</div></div>
</div><!-- fragment --><p ><b>s2n_cert_chain_and_key_load_pem</b> associates a certificate chain and private key with an <b><a class="el" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a></b> object.</p>
<p ><b>cert_chain_pem</b> should be a PEM encoded certificate chain, with the first certificate in the chain being your leaf certificate. <b>private_key_pem</b> should be a PEM encoded private key corresponding to the leaf certificate.</p>
<h3><a class="anchor" id="autotoc_md408"></a>
s2n_cert_chain_and_key_set_ctx</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a4b1ca142d9e92dca8255e4d978d33e1d">s2n_cert_chain_and_key_set_ctx</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#aac2a6f1aab996a327b37797f9c1209ae">chain_and_key</a>, <span class="keywordtype">void</span> *<a class="code hl_variable" href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a>);</div>
<div class="ttc" id="as2n_8h_html_a4b1ca142d9e92dca8255e4d978d33e1d"><div class="ttname"><a href="s2n_8h.html#a4b1ca142d9e92dca8255e4d978d33e1d">s2n_cert_chain_and_key_set_ctx</a></div><div class="ttdeci">S2N_API int s2n_cert_chain_and_key_set_ctx(struct s2n_cert_chain_and_key *cert_and_key, void *ctx)</div><div class="ttdef"><b>Definition:</b> s2n_certificate.c:505</div></div>
</div><!-- fragment --><p ><b>s2n_cert_chain_and_key_set_ctx</b> associates an application defined context with a <b><a class="el" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a></b> object. This is useful when multiple <a class="el" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> objects are used and the application would like to associate unique data with each certificate.</p>
<h3><a class="anchor" id="autotoc_md409"></a>
s2n_cert_chain_and_key_get_ctx</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#aa26ba8736d325914f744c137cccae624">s2n_cert_chain_and_key_get_ctx</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#aac2a6f1aab996a327b37797f9c1209ae">chain_and_key</a>);</div>
<div class="ttc" id="as2n_8h_html_aa26ba8736d325914f744c137cccae624"><div class="ttname"><a href="s2n_8h.html#aa26ba8736d325914f744c137cccae624">s2n_cert_chain_and_key_get_ctx</a></div><div class="ttdeci">S2N_API void * s2n_cert_chain_and_key_get_ctx(struct s2n_cert_chain_and_key *cert_and_key)</div><div class="ttdef"><b>Definition:</b> s2n_certificate.c:511</div></div>
</div><!-- fragment --><p ><b>s2n_cert_chain_and_key_set_ctx</b> returns a previously set context pointer or NULL if no context was set.</p>
<h3><a class="anchor" id="autotoc_md410"></a>
s2n_cert_chain_and_key_get_key</h3>
<div class="fragment"><div class="line"><span class="keyword">extern</span> <a class="code hl_struct" href="structs2n__pkey.html">s2n_cert_private_key</a> *<a class="code hl_function" href="s2n_8h.html#a5ebd0c365784d29a8c3b969f919994a1">s2n_cert_chain_and_key_get_private_key</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> *cert_and_key);</div>
<div class="ttc" id="as2n_8h_html_a5ebd0c365784d29a8c3b969f919994a1"><div class="ttname"><a href="s2n_8h.html#a5ebd0c365784d29a8c3b969f919994a1">s2n_cert_chain_and_key_get_private_key</a></div><div class="ttdeci">S2N_API s2n_cert_private_key * s2n_cert_chain_and_key_get_private_key(struct s2n_cert_chain_and_key *cert_and_key)</div><div class="ttdef"><b>Definition:</b> s2n_certificate.c:521</div></div>
</div><!-- fragment --><p ><b>s2n_cert_chain_and_key_get_private_key</b> returns a private key from <b><a class="el" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a></b> object.</p>
<h2><a class="anchor" id="autotoc_md411"></a>
Client Auth Related calls</h2>
<p >Client Auth Related API's are not recommended for normal users. Use of these API's is discouraged.</p>
<ol type="1">
<li>Using these API's requires users to: Complete full x509 parsing and hostname validation in the application layer</li>
<li>Application knowledge of TLS code points for certificate types</li>
<li>Application dependency on libcrypto to give a libcrypto RSA struct back to s2n</li>
</ol>
<h3><a class="anchor" id="autotoc_md412"></a>
s2n_config_set_client_auth_type and s2n_connection_set_client_auth_type</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a923be772e04a448409f93d4cf234ca33">s2n_config_set_client_auth_type</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_enumeration" href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8">s2n_cert_auth_type</a> cert_auth_type);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ad2985adfcaa565bf3cf35edb4ae4f854">s2n_connection_set_client_auth_type</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <a class="code hl_enumeration" href="s2n_8h.html#a8757c094681bb8151329c8dc067106b8">s2n_cert_auth_type</a> cert_auth_type);</div>
<div class="ttc" id="as2n_8h_html_a923be772e04a448409f93d4cf234ca33"><div class="ttname"><a href="s2n_8h.html#a923be772e04a448409f93d4cf234ca33">s2n_config_set_client_auth_type</a></div><div class="ttdeci">S2N_API int s2n_config_set_client_auth_type(struct s2n_config *config, s2n_cert_auth_type client_auth_type)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:371</div></div>
<div class="ttc" id="as2n_8h_html_ad2985adfcaa565bf3cf35edb4ae4f854"><div class="ttname"><a href="s2n_8h.html#ad2985adfcaa565bf3cf35edb4ae4f854">s2n_connection_set_client_auth_type</a></div><div class="ttdeci">S2N_API int s2n_connection_set_client_auth_type(struct s2n_connection *conn, s2n_cert_auth_type client_auth_type)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:883</div></div>
</div><!-- fragment --><p> Sets whether or not a Client Certificate should be required to complete the TLS Connection. If this is set to <b>S2N_CERT_AUTH_OPTIONAL</b> the server will request a client certificate but allow the client to not provide one. Rejecting a client certificate when using <b>S2N_CERT_AUTH_OPTIONAL</b> will terminate the handshake.</p>
<h3><a class="anchor" id="autotoc_md413"></a>
Public Key API's</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> s2n_rsa_public_key_set_from_openssl(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__rsa__key.html">s2n_rsa_public_key</a> *<a class="code hl_variable" href="s2n__kex_8c.html#a551ef04c3e467905fdbd6c573fedf81d">s2n_rsa</a>, RSA *openssl_rsa);</div>
<div class="line"><span class="keywordtype">int</span> s2n_cert_public_key_set_cert_type(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__pkey.html">s2n_cert_public_key</a> *cert_pub_key, <a class="code hl_enumeration" href="s2n__server__cert__request__test_8c.html#add582bf6f5e4b45c91d314e7555d6c6e">s2n_cert_type</a> cert_type);</div>
<div class="line"><span class="keywordtype">int</span> s2n_cert_public_key_get_rsa(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__pkey.html">s2n_cert_public_key</a> *cert_pub_key, <span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__rsa__key.html">s2n_rsa_public_key</a> **rsa);</div>
<div class="line"><span class="keywordtype">int</span> s2n_cert_public_key_set_rsa(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__pkey.html">s2n_cert_public_key</a> *cert_pub_key, <span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__rsa__key.html">s2n_rsa_public_key</a> rsa);</div>
<div class="ttc" id="as2n__kex_8c_html_a551ef04c3e467905fdbd6c573fedf81d"><div class="ttname"><a href="s2n__kex_8c.html#a551ef04c3e467905fdbd6c573fedf81d">s2n_rsa</a></div><div class="ttdeci">const struct s2n_kex s2n_rsa</div><div class="ttdef"><b>Definition:</b> s2n_kex.c:135</div></div>
<div class="ttc" id="as2n__server__cert__request__test_8c_html_add582bf6f5e4b45c91d314e7555d6c6e"><div class="ttname"><a href="s2n__server__cert__request__test_8c.html#add582bf6f5e4b45c91d314e7555d6c6e">s2n_cert_type</a></div><div class="ttdeci">s2n_cert_type</div><div class="ttdef"><b>Definition:</b> s2n_server_cert_request_test.c:26</div></div>
</div><!-- fragment --><p> <b>s2n_rsa_public_key</b> and <b>s2n_cert_public_key</b> are opaque structs. These API's are intended to be used by Implementations of <b>verify_cert_trust_chain_fn</b> to set the public keys found in the Certificate into <b>public_key_out</b>.</p>
<h2><a class="anchor" id="autotoc_md414"></a>
Session Caching related calls</h2>
<p >s2n includes support for resuming from cached SSL/TLS session, provided the caller sets (and implements) three callback functions.</p>
<h3><a class="anchor" id="autotoc_md415"></a>
s2n_config_set_cache_store_callback</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a8c1c9c7110d9e3c18d48fbf8ee655318">s2n_config_set_cache_store_callback</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <span class="keywordtype">int</span></div>
<div class="line">        (*<a class="code hl_function" href="s2nd_8c.html#a8aab504b1c39f7cdcf04aee0d0b92e50">cache_store_callback</a>)(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keywordtype">void</span> *, uint64_t ttl_in_seconds, <span class="keyword">const</span> <span class="keywordtype">void</span> *key, uint64_t key_size, <span class="keyword">const</span> <span class="keywordtype">void</span> *value, uint64_t value_size), <span class="keywordtype">void</span> *data);</div>
<div class="ttc" id="as2n_8h_html_a8c1c9c7110d9e3c18d48fbf8ee655318"><div class="ttname"><a href="s2n_8h.html#a8c1c9c7110d9e3c18d48fbf8ee655318">s2n_config_set_cache_store_callback</a></div><div class="ttdeci">S2N_API int s2n_config_set_cache_store_callback(struct s2n_config *config, s2n_cache_store_callback cache_store_callback, void *data)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:592</div></div>
<div class="ttc" id="as2nd_8c_html_a8aab504b1c39f7cdcf04aee0d0b92e50"><div class="ttname"><a href="s2nd_8c.html#a8aab504b1c39f7cdcf04aee0d0b92e50">cache_store_callback</a></div><div class="ttdeci">int cache_store_callback(struct s2n_connection *conn, void *ctx, uint64_t ttl, const void *key, uint64_t key_size, const void *value, uint64_t value_size)</div><div class="ttdef"><b>Definition:</b> s2nd.c:165</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_cache_store_callback</b> allows the caller to set a callback function that will be used to store SSL session data in a cache. The callback function takes seven arguments: a pointer to the <a class="el" href="structs2n__connection.html">s2n_connection</a> object, a pointer to abitrary data for use within the callback, a 64-bit unsigned integer specifying the number of seconds the session data may be stored for, a pointer to a key which can be used to retrieve the cached entry, a 64 bit unsigned integer specifying the size of this key, a pointer to a value which should be stored, and a 64 bit unsigned integer specified the size of this value.</p>
<h3><a class="anchor" id="autotoc_md416"></a>
s2n_config_set_cache_retrieve_callback</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a0ab40fa6123aedb83f5fab8ef1922fa9">s2n_config_set_cache_retrieve_callback</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <span class="keywordtype">int</span></div>
<div class="line">        (*<a class="code hl_function" href="s2nd_8c.html#a76518c3daf7521be5dd26d13df982532">cache_retrieve_callback</a>)(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keywordtype">void</span> *, <span class="keyword">const</span> <span class="keywordtype">void</span> *key, uint64_t key_size, <span class="keywordtype">void</span> *value, uint64_t *value_size), <span class="keywordtype">void</span> *data)</div>
<div class="ttc" id="as2n_8h_html_a0ab40fa6123aedb83f5fab8ef1922fa9"><div class="ttname"><a href="s2n_8h.html#a0ab40fa6123aedb83f5fab8ef1922fa9">s2n_config_set_cache_retrieve_callback</a></div><div class="ttdeci">S2N_API int s2n_config_set_cache_retrieve_callback(struct s2n_config *config, s2n_cache_retrieve_callback cache_retrieve_callback, void *data)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:602</div></div>
<div class="ttc" id="as2nd_8c_html_a76518c3daf7521be5dd26d13df982532"><div class="ttname"><a href="s2nd_8c.html#a76518c3daf7521be5dd26d13df982532">cache_retrieve_callback</a></div><div class="ttdeci">int cache_retrieve_callback(struct s2n_connection *conn, void *ctx, const void *key, uint64_t key_size, void *value, uint64_t *value_size)</div><div class="ttdef"><b>Definition:</b> s2nd.c:183</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_cache_retrieve_callback</b> allows the caller to set a callback function that will be used to retrieve SSL session data from a cache. The callback function takes six arguments: a pointer to the <a class="el" href="structs2n__connection.html">s2n_connection</a> object, a pointer to abitrary data for use within the callback, a pointer to a key which can be used to retrieve the cached entry, a 64 bit unsigned integer specifying the size of this key, a pointer to a memory location where the value should be stored, and a pointer to a 64 bit unsigned integer specifing the size of this value. Initially *value_size will be set to the amount of space allocated for the value, the callback should set *value_size to the actual size of the data returned. If there is insufficient space, -1 should be returned.</p>
<p >If the cache is not ready to provide data for the request, S2N_CALLBACK_BLOCKED should be returned. This will cause <a class="el" href="s2n_8h.html#ad3222e7aacf35a56be842678171be440">s2n_negotiate()</a> to return S2N_BLOCKED_ON_APPLICATION_INPUT.</p>
<h3><a class="anchor" id="autotoc_md417"></a>
s2n_config_set_cache_delete_callback</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a83593aa49ca8a9cff7c2678acf943f4f">s2n_config_set_cache_delete_callback</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <span class="keywordtype">int</span></div>
<div class="line">        (*<a class="code hl_function" href="s2nd_8c.html#a07c36a58a01ca824ad413a8bb1e7aafa">cache_delete_callback</a>))(<span class="keyword">struct </span><a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keywordtype">void</span> *, <span class="keyword">const</span> <span class="keywordtype">void</span> *key, uint64_t key_size), <span class="keywordtype">void</span> *data);</div>
<div class="ttc" id="as2n_8h_html_a83593aa49ca8a9cff7c2678acf943f4f"><div class="ttname"><a href="s2n_8h.html#a83593aa49ca8a9cff7c2678acf943f4f">s2n_config_set_cache_delete_callback</a></div><div class="ttdeci">S2N_API int s2n_config_set_cache_delete_callback(struct s2n_config *config, s2n_cache_delete_callback cache_delete_callback, void *data)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:612</div></div>
<div class="ttc" id="as2nd_8c_html_a07c36a58a01ca824ad413a8bb1e7aafa"><div class="ttname"><a href="s2nd_8c.html#a07c36a58a01ca824ad413a8bb1e7aafa">cache_delete_callback</a></div><div class="ttdeci">int cache_delete_callback(struct s2n_connection *conn, void *ctx, const void *key, uint64_t key_size)</div><div class="ttdef"><b>Definition:</b> s2nd.c:206</div></div>
</div><!-- fragment --><p ><b>s2n_config_set_cache_delete_callback</b> allows the caller to set a callback function that will be used to delete SSL session data from a cache. The callback function takes four arguments: a pointer to <a class="el" href="structs2n__connection.html">s2n_connection</a> object, a pointer to abitrary data for use within the callback, a pointer to a key which can be used to delete the cached entry, and a 64 bit unsigned integer specifying the size of this key.</p>
<h3><a class="anchor" id="autotoc_md418"></a>
s2n_config_send_max_fragment_length</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a0f2ab042e1f9dea7ff02b3746dc16188">s2n_config_send_max_fragment_length</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, uint8_t <a class="code hl_variable" href="structs2n__connection.html#a45cf8f00e8dfe76ad165a3a0f67102ff">mfl_code</a>);</div>
<div class="ttc" id="as2n_8h_html_a0f2ab042e1f9dea7ff02b3746dc16188"><div class="ttname"><a href="s2n_8h.html#a0f2ab042e1f9dea7ff02b3746dc16188">s2n_config_send_max_fragment_length</a></div><div class="ttdeci">S2N_API int s2n_config_send_max_fragment_length(struct s2n_config *config, s2n_max_frag_len mfl_code)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:656</div></div>
<div class="ttc" id="astructs2n__connection_html_a45cf8f00e8dfe76ad165a3a0f67102ff"><div class="ttname"><a href="structs2n__connection.html#a45cf8f00e8dfe76ad165a3a0f67102ff">s2n_connection::mfl_code</a></div><div class="ttdeci">uint8_t mfl_code</div><div class="ttdef"><b>Definition:</b> s2n_connection.h:238</div></div>
</div><!-- fragment --><p ><b>s2n_config_send_max_fragment_length</b> allows the caller to set a TLS Maximum Fragment Length extension that will be used to fragment outgoing messages. s2n currently does not reject fragments larger than the configured maximum when in server mode. The TLS negotiated maximum fragment length overrides the preference set by the <b>s2n_connection_prefer_throughput</b> and <b>s2n_connection_prefer_low_latency</b>.</p>
<h3><a class="anchor" id="autotoc_md419"></a>
s2n_config_accept_max_fragment_length</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a1d36a77c4bbcd04ea33b84ffd074fb8f">s2n_config_accept_max_fragment_length</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>);</div>
<div class="ttc" id="as2n_8h_html_a1d36a77c4bbcd04ea33b84ffd074fb8f"><div class="ttname"><a href="s2n_8h.html#a1d36a77c4bbcd04ea33b84ffd074fb8f">s2n_config_accept_max_fragment_length</a></div><div class="ttdeci">S2N_API int s2n_config_accept_max_fragment_length(struct s2n_config *config)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:667</div></div>
</div><!-- fragment --><p ><b>s2n_config_accept_max_fragment_length</b> allows the server to opt-in to accept client's TLS maximum fragment length extension requests. If this API is not called, and client requests the extension, server will ignore the request and continue TLS handshake with default maximum fragment length of 8k bytes </p>
<h2><a class="anchor" id="autotoc_md420"></a>
Connection-oriented functions</h2>
<h3><a class="anchor" id="autotoc_md421"></a>
s2n_connection_new</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> * <a class="code hl_function" href="s2n_8h.html#ae7dc6dc60634c602b4c26ff9e7d3849a">s2n_connection_new</a>(<a class="code hl_enumeration" href="s2n_8h.html#a77a64e3b657f90d221c5faf99c643cdb">s2n_mode</a> <a class="code hl_variable" href="structs2n__connection.html#a8f9031cdae8b28b7f90d042fae0509ef">mode</a>);</div>
<div class="ttc" id="as2n_8h_html_ae7dc6dc60634c602b4c26ff9e7d3849a"><div class="ttname"><a href="s2n_8h.html#ae7dc6dc60634c602b4c26ff9e7d3849a">s2n_connection_new</a></div><div class="ttdeci">S2N_API struct s2n_connection * s2n_connection_new(s2n_mode mode)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:152</div></div>
<div class="ttc" id="astructs2n__connection_html_a8f9031cdae8b28b7f90d042fae0509ef"><div class="ttname"><a href="structs2n__connection.html#a8f9031cdae8b28b7f90d042fae0509ef">s2n_connection::mode</a></div><div class="ttdeci">s2n_mode mode</div><div class="ttdef"><b>Definition:</b> s2n_connection.h:119</div></div>
</div><!-- fragment --><p ><b>s2n_connection_new</b> creates a new connection object. Each s2n SSL/TLS connection uses one of these objects. These connection objects can be operated on by up to two threads at a time, one sender and one receiver, but neither sending nor receiving are atomic, so if these objects are being called by multiple sender or receiver threads, you must perform your own locking to ensure that only one sender or receiver is active at a time. The <b>mode</b> parameters specifies if the caller is a server, or is a client.</p>
<p >Connections objects are re-usable across many connections, and should be re-used (to avoid deallocating and allocating memory). You should wipe connections immediately after use.</p>
<h3><a class="anchor" id="autotoc_md422"></a>
s2n_connection_set_config</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#abe4b60e86b018ff4b354421e526c6bd1">s2n_connection_set_config</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, </div>
<div class="line">                              <span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>);</div>
<div class="ttc" id="as2n_8h_html_abe4b60e86b018ff4b354421e526c6bd1"><div class="ttname"><a href="s2n_8h.html#abe4b60e86b018ff4b354421e526c6bd1">s2n_connection_set_config</a></div><div class="ttdeci">S2N_API int s2n_connection_set_config(struct s2n_connection *conn, struct s2n_config *config)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:482</div></div>
</div><!-- fragment --><p ><b>s2n_connection_set_config</b> Associates a configuration object with a connection.</p>
<h3><a class="anchor" id="autotoc_md423"></a>
s2n_connection_set_ctx</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#abe22b04670c9345ed5c25b261ee4de72">s2n_connection_set_ctx</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keywordtype">void</span> *<a class="code hl_variable" href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a>);</div>
<div class="ttc" id="as2n_8h_html_abe22b04670c9345ed5c25b261ee4de72"><div class="ttname"><a href="s2n_8h.html#abe22b04670c9345ed5c25b261ee4de72">s2n_connection_set_ctx</a></div><div class="ttdeci">S2N_API int s2n_connection_set_ctx(struct s2n_connection *conn, void *ctx)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:530</div></div>
</div><!-- fragment --><p ><b>s2n_connection_set_ctx</b> sets user defined context in <b><a class="el" href="structs2n__connection.html">s2n_connection</a></b> object.</p>
<h3><a class="anchor" id="autotoc_md424"></a>
s2n_connection_get_ctx</h3>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> *<a class="code hl_function" href="s2n_8h.html#ac764269ddd1cebb33e6f24efc19493a4">s2n_connection_get_ctx</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_ac764269ddd1cebb33e6f24efc19493a4"><div class="ttname"><a href="s2n_8h.html#ac764269ddd1cebb33e6f24efc19493a4">s2n_connection_get_ctx</a></div><div class="ttdeci">S2N_API void * s2n_connection_get_ctx(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:536</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_ctx</b> gets user defined context from <b><a class="el" href="structs2n__connection.html">s2n_connection</a></b> object.</p>
<h3><a class="anchor" id="autotoc_md425"></a>
s2n_connection_set_fd</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a67962bf835ce5145d215a9ee8f4985d3">s2n_connection_set_fd</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, </div>
<div class="line">                          <span class="keywordtype">int</span> readfd);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#aa75014bd12d682e91ab2812c2e92c16d">s2n_connection_set_read_fd</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, </div>
<div class="line">                               <span class="keywordtype">int</span> readfd);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a8153e24a1b79e7b68ac7a1f7f7d8d0ea">s2n_connection_set_write_fd</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, </div>
<div class="line">                                <span class="keywordtype">int</span> writefd);</div>
<div class="ttc" id="as2n_8h_html_a67962bf835ce5145d215a9ee8f4985d3"><div class="ttname"><a href="s2n_8h.html#a67962bf835ce5145d215a9ee8f4985d3">s2n_connection_set_fd</a></div><div class="ttdeci">S2N_API int s2n_connection_set_fd(struct s2n_connection *conn, int fd)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:942</div></div>
<div class="ttc" id="as2n_8h_html_a8153e24a1b79e7b68ac7a1f7f7d8d0ea"><div class="ttname"><a href="s2n_8h.html#a8153e24a1b79e7b68ac7a1f7f7d8d0ea">s2n_connection_set_write_fd</a></div><div class="ttdeci">S2N_API int s2n_connection_set_write_fd(struct s2n_connection *conn, int writefd)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:913</div></div>
<div class="ttc" id="as2n_8h_html_aa75014bd12d682e91ab2812c2e92c16d"><div class="ttname"><a href="s2n_8h.html#aa75014bd12d682e91ab2812c2e92c16d">s2n_connection_set_read_fd</a></div><div class="ttdeci">S2N_API int s2n_connection_set_read_fd(struct s2n_connection *conn, int readfd)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:890</div></div>
</div><!-- fragment --><p ><b>s2n_connection_set_fd</b> sets the file-descriptor for an s2n connection. This file-descriptor should be active and connected. s2n also supports setting the read and write file-descriptors to different values (for pipes or other unusual types of I/O).</p>
<h3><a class="anchor" id="autotoc_md426"></a>
s2n_connection_is_valid_for_cipher_preferences</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ac396d45fe79efa2142be8cf491dfdbeb">s2n_connection_is_valid_for_cipher_preferences</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keyword">const</span> <span class="keywordtype">char</span> *version);</div>
<div class="ttc" id="as2n_8h_html_ac396d45fe79efa2142be8cf491dfdbeb"><div class="ttname"><a href="s2n_8h.html#ac396d45fe79efa2142be8cf491dfdbeb">s2n_connection_is_valid_for_cipher_preferences</a></div><div class="ttdeci">S2N_API int s2n_connection_is_valid_for_cipher_preferences(struct s2n_connection *conn, const char *version)</div><div class="ttdef"><b>Definition:</b> s2n_security_policies.c:732</div></div>
</div><!-- fragment --><p ><b>s2n_connection_is_valid_for_cipher_preferences</b> checks if the cipher used by current connection is supported by a given cipher preferences. It returns</p><ul>
<li>1 if the connection satisfies the cipher suite</li>
<li>0 if it does not</li>
<li>-1 on any other errors</li>
</ul>
<h3><a class="anchor" id="autotoc_md427"></a>
s2n_connection_set_cipher_preferences</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ab4544d664e827a426b484b3eaa62063d">s2n_connection_set_cipher_preferences</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keyword">const</span> <span class="keywordtype">char</span> *version);</div>
<div class="ttc" id="as2n_8h_html_ab4544d664e827a426b484b3eaa62063d"><div class="ttname"><a href="s2n_8h.html#ab4544d664e827a426b484b3eaa62063d">s2n_connection_set_cipher_preferences</a></div><div class="ttdeci">S2N_API int s2n_connection_set_cipher_preferences(struct s2n_connection *conn, const char *version)</div><div class="ttdef"><b>Definition:</b> s2n_security_policies.c:617</div></div>
</div><!-- fragment --><p ><b>s2n_connection_set_cipher_preferences</b> sets the cipher preference override for the <a class="el" href="structs2n__connection.html">s2n_connection</a>. Calling this function is not necessary unless you want to set the cipher preferences on the connection to something different than what is in the <a class="el" href="structs2n__config.html">s2n_config</a>.</p>
<h3><a class="anchor" id="autotoc_md428"></a>
s2n_connection_set_protocol_preferences</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a1e7fc1efa730562ff9a804fe578235b4">s2n_connection_set_protocol_preferences</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> *protocols, <span class="keywordtype">int</span> protocol_count);</div>
<div class="ttc" id="as2n_8h_html_a1e7fc1efa730562ff9a804fe578235b4"><div class="ttname"><a href="s2n_8h.html#a1e7fc1efa730562ff9a804fe578235b4">s2n_connection_set_protocol_preferences</a></div><div class="ttdeci">S2N_API int s2n_connection_set_protocol_preferences(struct s2n_connection *conn, const char *const *protocols, int protocol_count)</div><div class="ttdef"><b>Definition:</b> s2n_protocol_preferences.c:52</div></div>
</div><!-- fragment --><p ><b>s2n_connection_set_protocol_preferences</b> sets the protocol preference override for the <a class="el" href="structs2n__connection.html">s2n_connection</a>. Calling this function is not necessary unless you want to set the protocol preferences on the connection to something different than what is in the <a class="el" href="structs2n__config.html">s2n_config</a>.</p>
<h3><a class="anchor" id="autotoc_md429"></a>
s2n_set_server_name</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#af5c2488271997ea0b0b21d3937e612f6">s2n_set_server_name</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, </div>
<div class="line">                        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="structs2n__connection.html#a6d6fcb53603209f9c35ddb87e13573c4">server_name</a>);</div>
<div class="ttc" id="as2n_8h_html_af5c2488271997ea0b0b21d3937e612f6"><div class="ttname"><a href="s2n_8h.html#af5c2488271997ea0b0b21d3937e612f6">s2n_set_server_name</a></div><div class="ttdeci">S2N_API int s2n_set_server_name(struct s2n_connection *conn, const char *server_name)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1065</div></div>
<div class="ttc" id="astructs2n__connection_html_a6d6fcb53603209f9c35ddb87e13573c4"><div class="ttname"><a href="structs2n__connection.html#a6d6fcb53603209f9c35ddb87e13573c4">s2n_connection::server_name</a></div><div class="ttdeci">char server_name[S2N_MAX_SERVER_NAME+1]</div><div class="ttdef"><b>Definition:</b> s2n_connection.h:261</div></div>
</div><!-- fragment --><p ><b>s2n_set_server_name</b> Sets the server name for the connection. In future, this can be used by clients who wish to use the TLS "Server Name indicator" extension. At present, client functionality is disabled.</p>
<h3><a class="anchor" id="autotoc_md430"></a>
s2n_get_server_name</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_function" href="s2n_8h.html#a28071db5a8a2bb0505e070c731cc5fc7">s2n_get_server_name</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a28071db5a8a2bb0505e070c731cc5fc7"><div class="ttname"><a href="s2n_8h.html#a28071db5a8a2bb0505e070c731cc5fc7">s2n_get_server_name</a></div><div class="ttdeci">S2N_API const char * s2n_get_server_name(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1080</div></div>
</div><!-- fragment --><p ><b>s2n_get_server_name</b> returns the server name associated with a connection, or NULL if none is found. This can be used by a server to determine which server name the client is using.</p>
<h3><a class="anchor" id="autotoc_md431"></a>
s2n_connection_set_blinding</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a684b2e5c86c85f089392bd1a49d38e17">s2n_connection_set_blinding</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <a class="code hl_enumeration" href="s2n_8h.html#a364ad496c9dd42fd3117a2f9d3289e62">s2n_blinding</a> <a class="code hl_variable" href="structs2n__connection.html#a344d0363f0196610c1c0193d8fad3c23">blinding</a>);</div>
<div class="ttc" id="as2n_8h_html_a684b2e5c86c85f089392bd1a49d38e17"><div class="ttname"><a href="s2n_8h.html#a684b2e5c86c85f089392bd1a49d38e17">s2n_connection_set_blinding</a></div><div class="ttdeci">S2N_API int s2n_connection_set_blinding(struct s2n_connection *conn, s2n_blinding blinding)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1128</div></div>
<div class="ttc" id="astructs2n__connection_html_a344d0363f0196610c1c0193d8fad3c23"><div class="ttname"><a href="structs2n__connection.html#a344d0363f0196610c1c0193d8fad3c23">s2n_connection::blinding</a></div><div class="ttdeci">s2n_blinding blinding</div><div class="ttdef"><b>Definition:</b> s2n_connection.h:122</div></div>
</div><!-- fragment --><p ><b>s2n_connection_set_blinding</b> can be used to configure s2n to either use built-in blinding (set blinding to S2N_BUILT_IN_BLINDING) or self-service blinding (set blinding to S2N_SELF_SERVICE_BLINDING).</p>
<h3><a class="anchor" id="autotoc_md432"></a>
s2n_connection_get_delay</h3>
<div class="fragment"><div class="line">uint64_t <a class="code hl_function" href="s2n_8h.html#ab8a2a372d2d13cef62357473b7fea568">s2n_connection_get_delay</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_ab8a2a372d2d13cef62357473b7fea568"><div class="ttname"><a href="s2n_8h.html#ab8a2a372d2d13cef62357473b7fea568">s2n_connection_get_delay</a></div><div class="ttdeci">S2N_API uint64_t s2n_connection_get_delay(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1139</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_delay</b> returns the number of nanoseconds an application using self-service blinding should pause before calling <a class="el" href="new__destroy_8c.html#a6cc331334d030ff39790e12d10ef25c1">close()</a> or shutdown().</p>
<h3><a class="anchor" id="autotoc_md433"></a>
s2n_connection_prefer_throughput(struct s2n_connection *conn)</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a11c72914bfc09a9174b6a7b019e5aa5c">s2n_connection_prefer_throughput</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a9b4fafb7e9b8277f408af0ad17ab6e19">s2n_connection_prefer_low_latency</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#add5f14855b2810a9857b1a41f2cc92f9">s2n_connection_set_dynamic_record_threshold</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, uint32_t resize_threshold, uint16_t timeout_threshold);</div>
<div class="ttc" id="as2n_8h_html_a11c72914bfc09a9174b6a7b019e5aa5c"><div class="ttname"><a href="s2n_8h.html#a11c72914bfc09a9174b6a7b019e5aa5c">s2n_connection_prefer_throughput</a></div><div class="ttdeci">S2N_API int s2n_connection_prefer_throughput(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1196</div></div>
<div class="ttc" id="as2n_8h_html_a9b4fafb7e9b8277f408af0ad17ab6e19"><div class="ttname"><a href="s2n_8h.html#a9b4fafb7e9b8277f408af0ad17ab6e19">s2n_connection_prefer_low_latency</a></div><div class="ttdeci">S2N_API int s2n_connection_prefer_low_latency(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1207</div></div>
<div class="ttc" id="as2n_8h_html_add5f14855b2810a9857b1a41f2cc92f9"><div class="ttname"><a href="s2n_8h.html#add5f14855b2810a9857b1a41f2cc92f9">s2n_connection_set_dynamic_record_threshold</a></div><div class="ttdeci">S2N_API int s2n_connection_set_dynamic_record_threshold(struct s2n_connection *conn, uint32_t resize_threshold, uint16_t timeout_threshold)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1218</div></div>
</div><!-- fragment --><p ><b>s2n_connection_prefer_throughput</b> and <b>s2n_connection_prefer_low_latency</b> change the behavior of s2n when sending data to prefer either throughput or low latency. Connections prefering low latency will be encrypted using small record sizes that can be decrypted sooner by the recipient. Connections prefering throughput will use large record sizes that minimize overhead.</p>
<p >-Connections default to an 8k outgoing maximum</p>
<p ><b>s2n_connection_set_dynamic_record_threshold</b> provides a smooth transition from <b>s2n_connection_prefer_low_latency</b> to <b>s2n_connection_prefer_throughput</b>. <b>s2n_send</b> uses small TLS records that fit into a single TCP segment for the resize_threshold bytes (cap to 8M) of data and reset record size back to a single segment after timeout_threshold seconds of inactivity.</p>
<h3><a class="anchor" id="autotoc_md434"></a>
s2n_connection_get_wire_bytes</h3>
<div class="fragment"><div class="line">uint64_t <a class="code hl_function" href="s2n_8h.html#a3815d469b844d5eb192a04998bd12944">s2n_connection_get_wire_bytes_in</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line">uint64_t <a class="code hl_function" href="s2n_8h.html#a134ca7e01d14f709750ef420440b238b">s2n_connection_get_wire_bytes_out</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a134ca7e01d14f709750ef420440b238b"><div class="ttname"><a href="s2n_8h.html#a134ca7e01d14f709750ef420440b238b">s2n_connection_get_wire_bytes_out</a></div><div class="ttdeci">S2N_API uint64_t s2n_connection_get_wire_bytes_out(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:965</div></div>
<div class="ttc" id="as2n_8h_html_a3815d469b844d5eb192a04998bd12944"><div class="ttname"><a href="s2n_8h.html#a3815d469b844d5eb192a04998bd12944">s2n_connection_get_wire_bytes_in</a></div><div class="ttdeci">S2N_API uint64_t s2n_connection_get_wire_bytes_in(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:960</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_wire_bytes_in</b> and <b>s2n_connection_get_wire_bytes_out</b> return the number of bytes transmitted by s2n "on the wire", in and out respectively.</p>
<h3><a class="anchor" id="autotoc_md435"></a>
s2n_connection_get_protocol_version</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ad2a608603c7dbe9203a7c8f8b63ee1b8">s2n_connection_get_client_hello_version</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#aafa9d12438841f2a47907b244eccd7cc">s2n_connection_get_client_protocol_version</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a7db32818718bceb6f927a07cd068eb45">s2n_connection_get_server_protocol_version</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a67f52395125df9876ebf18964f582883">s2n_connection_get_actual_protocol_version</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a67f52395125df9876ebf18964f582883"><div class="ttname"><a href="s2n_8h.html#a67f52395125df9876ebf18964f582883">s2n_connection_get_actual_protocol_version</a></div><div class="ttdeci">S2N_API int s2n_connection_get_actual_protocol_version(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1025</div></div>
<div class="ttc" id="as2n_8h_html_a7db32818718bceb6f927a07cd068eb45"><div class="ttname"><a href="s2n_8h.html#a7db32818718bceb6f927a07cd068eb45">s2n_connection_get_server_protocol_version</a></div><div class="ttdeci">S2N_API int s2n_connection_get_server_protocol_version(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1018</div></div>
<div class="ttc" id="as2n_8h_html_aafa9d12438841f2a47907b244eccd7cc"><div class="ttname"><a href="s2n_8h.html#aafa9d12438841f2a47907b244eccd7cc">s2n_connection_get_client_protocol_version</a></div><div class="ttdeci">S2N_API int s2n_connection_get_client_protocol_version(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1011</div></div>
<div class="ttc" id="as2n_8h_html_ad2a608603c7dbe9203a7c8f8b63ee1b8"><div class="ttname"><a href="s2n_8h.html#ad2a608603c7dbe9203a7c8f8b63ee1b8">s2n_connection_get_client_hello_version</a></div><div class="ttdeci">S2N_API int s2n_connection_get_client_hello_version(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1032</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_client_protocol_version</b> returns the protocol version number supported by the client, <b>s2n_connection_get_server_protocol_version</b> returns the protocol version number supported by the server and <b>s2n_connection_get_actual_protocol_version</b> returns the protocol version number actually used by s2n for the connection. <b>s2n_connection_get_client_hello_version</b> returns the protocol version used to send the initial client hello message.</p>
<p >Each version number value corresponds to the macros defined as <b>S2N_SSLv2</b>, <b>S2N_SSLv3</b>, <b>S2N_TLS10</b>, <b>S2N_TLS11</b> and <b>S2N_TLS12</b>.</p>
<h3><a class="anchor" id="autotoc_md436"></a>
s2n_connection_set_verify_host_callback</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ad9ca67cd9ebca132607037162d7d86a0">s2n_connection_set_verify_host_callback</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_typedef" href="s2n_8h.html#a8aa56850695a02753f726ea9860ec383">s2n_verify_host_fn</a> host_fn, <span class="keywordtype">void</span> *data);</div>
<div class="ttc" id="as2n_8h_html_ad9ca67cd9ebca132607037162d7d86a0"><div class="ttname"><a href="s2n_8h.html#ad9ca67cd9ebca132607037162d7d86a0">s2n_connection_set_verify_host_callback</a></div><div class="ttdeci">S2N_API int s2n_connection_set_verify_host_callback(struct s2n_connection *config, s2n_verify_host_fn host_fn, void *data)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1228</div></div>
</div><!-- fragment --><p> Every connection inherits the value of <b>s2n_verify_host_fn</b> from it's instance of <b><a class="el" href="structs2n__config.html">s2n_config</a></b>. Since a configuration can (and should) be used for multiple connections, it may be useful to override this value on a per connection basis. For example, this may be based on a host header from an http request. In that case, calling this function will override the value inherited from the configuration. See <a href="#s2n_verify_host_fn">s2n_verify_host_fn</a> for details.</p>
<h3><a class="anchor" id="autotoc_md437"></a>
s2n_connection_get_client_hello</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *<a class="code hl_function" href="s2n_8h.html#a341f25d511a7e9355bd2748ba9beed4c">s2n_connection_get_client_hello</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a341f25d511a7e9355bd2748ba9beed4c"><div class="ttname"><a href="s2n_8h.html#a341f25d511a7e9355bd2748ba9beed4c">s2n_connection_get_client_hello</a></div><div class="ttdeci">S2N_API struct s2n_client_hello * s2n_connection_get_client_hello(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:47</div></div>
<div class="ttc" id="astructs2n__client__hello_html"><div class="ttname"><a href="structs2n__client__hello.html">s2n_client_hello</a></div><div class="ttdef"><b>Definition:</b> s2n_client_hello.h:29</div></div>
</div><!-- fragment --><p> For a given <a class="el" href="structs2n__connection.html">s2n_connection</a>, <b>s2n_connection_get_client_hello</b> returns a handle to the <a class="el" href="structs2n__client__hello.html">s2n_client_hello</a> structure holding the client hello message sent by the client during the handshake. NULL is returned if the connection has not yet received and parsed the client hello. Earliest point during the handshake when this structure is available for use is in the client_hello_callback (see <b>s2n_config_set_client_hello_cb</b>).</p>
<h3><a class="anchor" id="autotoc_md438"></a>
s2n_client_hello_get_raw_message</h3>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#a4c2c0de61921c9ddc8e8c4e56084cc6c">s2n_client_hello_get_raw_message_length</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *ch);</div>
<div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#ac1fc624f4ffe9378ad77eea895bb52d6">s2n_client_hello_get_raw_message</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *ch, uint8_t *out, uint32_t max_length);</div>
<div class="ttc" id="apreamble_8h_html_af02a2e09430a9ed80bedb598467ce8d1"><div class="ttname"><a href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a></div><div class="ttdeci">signed int ssize_t</div><div class="ttdef"><b>Definition:</b> preamble.h:25</div></div>
<div class="ttc" id="as2n_8h_html_a4c2c0de61921c9ddc8e8c4e56084cc6c"><div class="ttname"><a href="s2n_8h.html#a4c2c0de61921c9ddc8e8c4e56084cc6c">s2n_client_hello_get_raw_message_length</a></div><div class="ttdeci">S2N_API ssize_t s2n_client_hello_get_raw_message_length(struct s2n_client_hello *ch)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:88</div></div>
<div class="ttc" id="as2n_8h_html_ac1fc624f4ffe9378ad77eea895bb52d6"><div class="ttname"><a href="s2n_8h.html#ac1fc624f4ffe9378ad77eea895bb52d6">s2n_client_hello_get_raw_message</a></div><div class="ttdeci">S2N_API ssize_t s2n_client_hello_get_raw_message(struct s2n_client_hello *ch, uint8_t *out, uint32_t max_length)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:94</div></div>
</div><!-- fragment --><ul>
<li><b>ch</b> The <a class="el" href="structs2n__client__hello.html">s2n_client_hello</a> on the <a class="el" href="structs2n__connection.html">s2n_connection</a>. The handle can be obtained using <b>s2n_connection_get_client_hello</b>.</li>
<li><b>out</b> Pointer to a buffer into which the raw client hello bytes should be copied.</li>
<li><b>max_length</b> Max number of bytes to copy into the <b>out</b> buffer.</li>
</ul>
<p ><b>s2n_client_hello_get_raw_message_length</b> returns the size of the ClientHello message received by the server; it can be used to allocate the <b>out</b> buffer. <b>s2n_client_hello_get_raw_message</b> copies <b>max_lenght</b> bytes of the ClientHello message into the <b>out</b> buffer and returns the number of bytes that were copied. The ClientHello instrumented using this function will have the Random bytes zero-ed out.</p>
<p >For SSLv2 ClientHello messages, the raw message contains only the cipher_specs, session_id and members portions of the hello message (see <a href="https://tools.ietf.org/html/rfc5246#appendix-E.2">RFC5246</a>). To access other members, you may use the <b>s2n_connection_get_client_hello_version</b>, <b>s2n_connection_get_client_protocol_version</b> and <b>s2n_connection_get_session_id_length</b> accesor functions.</p>
<h3><a class="anchor" id="autotoc_md439"></a>
s2n_client_hello_get_cipher_suites</h3>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#a836ac7d852fbb18b790c8084878e1b5d">s2n_client_hello_get_cipher_suites_length</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *ch);</div>
<div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#ab83eff4e25edddcd4688854e0c4d8e62">s2n_client_hello_get_cipher_suites</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *ch, uint8_t *out, uint32_t max_length);</div>
<div class="ttc" id="as2n_8h_html_a836ac7d852fbb18b790c8084878e1b5d"><div class="ttname"><a href="s2n_8h.html#a836ac7d852fbb18b790c8084878e1b5d">s2n_client_hello_get_cipher_suites_length</a></div><div class="ttdeci">S2N_API ssize_t s2n_client_hello_get_cipher_suites_length(struct s2n_client_hello *ch)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:108</div></div>
<div class="ttc" id="as2n_8h_html_ab83eff4e25edddcd4688854e0c4d8e62"><div class="ttname"><a href="s2n_8h.html#ab83eff4e25edddcd4688854e0c4d8e62">s2n_client_hello_get_cipher_suites</a></div><div class="ttdeci">S2N_API ssize_t s2n_client_hello_get_cipher_suites(struct s2n_client_hello *ch, uint8_t *out, uint32_t max_length)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:114</div></div>
</div><!-- fragment --><ul>
<li><b>ch</b> The <a class="el" href="structs2n__client__hello.html">s2n_client_hello</a> on the <a class="el" href="structs2n__connection.html">s2n_connection</a>. The handle can be obtained using <b>s2n_connection_get_client_hello</b>.</li>
<li><b>out</b> Pointer to a buffer into which the cipher_suites bytes should be copied.</li>
<li><b>max_length</b> Max number of bytes to copy into the <b>out</b> buffer.</li>
</ul>
<p ><b>s2n_client_hello_get_cipher_suites_length</b> returns the number of bytes the cipher_suites takes on the ClientHello message received by the server; it can be used to allocate the <b>out</b> buffer. <b>s2n_client_hello_get_cipher_suites</b> copies into the <b>out</b> buffer <b>max_length</b> bytes of the cipher_suites on the ClienthHello and returns the number of bytes that were copied.</p>
<h3><a class="anchor" id="autotoc_md440"></a>
s2n_client_hello_get_extensions</h3>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#a9c10c0917fcda2f6a546310f7b80b8fa">s2n_client_hello_get_extensions_length</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *ch);</div>
<div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#ae872d221c8d47cab5178cfd3ca00bca4">s2n_client_hello_get_extensions</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *ch, uint8_t *out, uint32_t max_length);</div>
<div class="ttc" id="as2n_8h_html_a9c10c0917fcda2f6a546310f7b80b8fa"><div class="ttname"><a href="s2n_8h.html#a9c10c0917fcda2f6a546310f7b80b8fa">s2n_client_hello_get_extensions_length</a></div><div class="ttdeci">S2N_API ssize_t s2n_client_hello_get_extensions_length(struct s2n_client_hello *ch)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:127</div></div>
<div class="ttc" id="as2n_8h_html_ae872d221c8d47cab5178cfd3ca00bca4"><div class="ttname"><a href="s2n_8h.html#ae872d221c8d47cab5178cfd3ca00bca4">s2n_client_hello_get_extensions</a></div><div class="ttdeci">S2N_API ssize_t s2n_client_hello_get_extensions(struct s2n_client_hello *ch, uint8_t *out, uint32_t max_length)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:133</div></div>
</div><!-- fragment --><ul>
<li><b>ch</b> The <a class="el" href="structs2n__client__hello.html">s2n_client_hello</a> on the <a class="el" href="structs2n__connection.html">s2n_connection</a>. The handle can be obtained using <b>s2n_connection_get_client_hello</b>.</li>
<li><b>out</b> Pointer to a buffer into which the cipher_suites bytes should be copied.</li>
<li><b>max_length</b> Max number of bytes to copy into the <b>out</b> buffer.</li>
</ul>
<p ><b>s2n_client_hello_get_extensions_length</b> returns the number of bytes the extensions take on the ClientHello message received by the server; it can be used to allocate the <b>out</b> buffer. <b>s2n_client_hello_get_extensions</b> copies into the <b>out</b> buffer <b>max_length</b> bytes of the extensions on the ClienthHello and returns the number of bytes that were copied.</p>
<h3><a class="anchor" id="autotoc_md441"></a>
s2n_client_hello_get_extension</h3>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#aba6709ea1bac503daf846990821d8f36">s2n_client_hello_get_extension_length</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *ch, <a class="code hl_enumeration" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8">s2n_tls_extension_type</a> extension_type);</div>
<div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#a5ad69c8c71521b13b69bcd77fea92b74">s2n_client_hello_get_extension_by_id</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__client__hello.html">s2n_client_hello</a> *ch, <a class="code hl_enumeration" href="s2n_8h.html#ab2b46f61765da5529f931afb8dd8a1f8">s2n_tls_extension_type</a> extension_type, uint8_t *out, uint32_t max_length);</div>
<div class="ttc" id="as2n_8h_html_a5ad69c8c71521b13b69bcd77fea92b74"><div class="ttname"><a href="s2n_8h.html#a5ad69c8c71521b13b69bcd77fea92b74">s2n_client_hello_get_extension_by_id</a></div><div class="ttdeci">S2N_API ssize_t s2n_client_hello_get_extension_by_id(struct s2n_client_hello *ch, s2n_tls_extension_type extension_type, uint8_t *out, uint32_t max_length)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:481</div></div>
<div class="ttc" id="as2n_8h_html_aba6709ea1bac503daf846990821d8f36"><div class="ttname"><a href="s2n_8h.html#aba6709ea1bac503daf846990821d8f36">s2n_client_hello_get_extension_length</a></div><div class="ttdeci">S2N_API ssize_t s2n_client_hello_get_extension_length(struct s2n_client_hello *ch, s2n_tls_extension_type extension_type)</div><div class="ttdef"><b>Definition:</b> s2n_client_hello.c:469</div></div>
</div><!-- fragment --><ul>
<li><b>ch</b> The <a class="el" href="structs2n__client__hello.html">s2n_client_hello</a> on the <a class="el" href="structs2n__connection.html">s2n_connection</a>. The handle can be obtained using <b>s2n_connection_get_client_hello</b>.</li>
<li><b>s2n_tls_extension_type</b> Enum <a href="#s2n\_config\_set\_extension\_data">s2n_tls_extension_type</a> lists all supported extension types.</li>
<li><b>out</b> Pointer to a buffer into which the extension bytes should be copied.</li>
<li><b>max_length</b> Max number of bytes to copy into the <b>out</b> buffer.</li>
</ul>
<p ><b>s2n_client_hello_get_extension_length</b> returns the number of bytes the given extension type takes on the ClientHello message received by the server; it can be used to allocate the <b>out</b> buffer. <b>s2n_client_hello_get_extension_by_id</b> copies into the <b>out</b> buffer <b>max_length</b> bytes of a given extension type on the ClienthHello and returns the number of bytes that were copied.</p>
<h3><a class="anchor" id="autotoc_md442"></a>
s2n_connection_client_cert_used</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a249408b5a39897276524176bb951dba5">s2n_connection_client_cert_used</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a249408b5a39897276524176bb951dba5"><div class="ttname"><a href="s2n_8h.html#a249408b5a39897276524176bb951dba5">s2n_connection_client_cert_used</a></div><div class="ttdeci">S2N_API int s2n_connection_client_cert_used(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1039</div></div>
</div><!-- fragment --><p> <b>s2n_connection_client_cert_used</b> returns 1 if the handshake completed and Client Auth was negotiated during the handshake.</p>
<h3><a class="anchor" id="autotoc_md443"></a>
s2n_get_application_protocol</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_function" href="s2n_8h.html#a617e2f6e3b995277d63b977c3e7c640e">s2n_get_application_protocol</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a617e2f6e3b995277d63b977c3e7c640e"><div class="ttname"><a href="s2n_8h.html#a617e2f6e3b995277d63b977c3e7c640e">s2n_get_application_protocol</a></div><div class="ttdeci">S2N_API const char * s2n_get_application_protocol(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1097</div></div>
</div><!-- fragment --><p ><b>s2n_get_application_protocol</b> returns the negotiated application protocol for a <b><a class="el" href="structs2n__connection.html">s2n_connection</a></b>. In the event of no protocol being negotiated, NULL is returned.</p>
<h3><a class="anchor" id="autotoc_md444"></a>
s2n_connection_get_ocsp_response</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> uint8_t *<a class="code hl_function" href="s2n_8h.html#a9060f1bf276caeb21a4e0dae55076992">s2n_connection_get_ocsp_response</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, uint32_t *<a class="code hl_typedef" href="iocp__event__loop_8c.html#ae809d5359ac030c60a30a8f0b2294b82">length</a>);</div>
<div class="ttc" id="as2n_8h_html_a9060f1bf276caeb21a4e0dae55076992"><div class="ttname"><a href="s2n_8h.html#a9060f1bf276caeb21a4e0dae55076992">s2n_connection_get_ocsp_response</a></div><div class="ttdeci">S2N_API const uint8_t * s2n_connection_get_ocsp_response(struct s2n_connection *conn, uint32_t *length)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1187</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_ocsp_response</b> returns the OCSP response sent by a server during the handshake. If no status response is received, NULL is returned.</p>
<h3><a class="anchor" id="autotoc_md445"></a>
s2n_connection_is_ocsp_stapled</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#addfbc4fdc9d191bb4d6d9040762b208b">s2n_connection_is_ocsp_stapled</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_addfbc4fdc9d191bb4d6d9040762b208b"><div class="ttname"><a href="s2n_8h.html#addfbc4fdc9d191bb4d6d9040762b208b">s2n_connection_is_ocsp_stapled</a></div><div class="ttdeci">S2N_API int s2n_connection_is_ocsp_stapled(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_resume.c:312</div></div>
</div><!-- fragment --><p ><b>s2n_connection_is_ocsp_stapled</b> returns 1 if OCSP response was sent (if connection is in S2N_SERVER mode) or received (if connection is in S2N_CLIENT mode) during handshake, otherwise it returns 0.</p>
<h3><a class="anchor" id="autotoc_md446"></a>
s2n_connection_get_handshake_type_name</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_function" href="s2n_8h.html#a6e32465d1aa61a38c4f663001bb822cd">s2n_connection_get_handshake_type_name</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a6e32465d1aa61a38c4f663001bb822cd"><div class="ttname"><a href="s2n_8h.html#a6e32465d1aa61a38c4f663001bb822cd">s2n_connection_get_handshake_type_name</a></div><div class="ttdeci">S2N_API const char * s2n_connection_get_handshake_type_name(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_handshake_io.c:717</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_handshake_type_name</b> returns a human-readable handshake type name, e.g. "NEGOTIATED|FULL_HANDSHAKE|PERFECT_FORWARD_SECRECY"</p>
<h3><a class="anchor" id="autotoc_md447"></a>
s2n_connection_get_last_message_name</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_function" href="s2n_8h.html#aeb3de433055ff9c395818b9e5dd7e55d">s2n_connection_get_last_message_name</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_aeb3de433055ff9c395818b9e5dd7e55d"><div class="ttname"><a href="s2n_8h.html#aeb3de433055ff9c395818b9e5dd7e55d">s2n_connection_get_last_message_name</a></div><div class="ttdeci">S2N_API const char * s2n_connection_get_last_message_name(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_handshake_io.c:710</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_last_message_name</b> returns the last message name in TLS state machine, e.g. "SERVER_HELLO", "APPLICATION_DATA".</p>
<h3><a class="anchor" id="autotoc_md448"></a>
s2n_connection_get_alert</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a5612a3161a2dcb4dd7fcb04aaf8845a8">s2n_connection_get_alert</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a5612a3161a2dcb4dd7fcb04aaf8845a8"><div class="ttname"><a href="s2n_8h.html#a5612a3161a2dcb4dd7fcb04aaf8845a8">s2n_connection_get_alert</a></div><div class="ttdeci">S2N_API int s2n_connection_get_alert(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1052</div></div>
</div><!-- fragment --><p >If a connection was shut down by the peer, <b>s2n_connection_get_alert</b> returns the TLS alert code that caused a connection to be shut down. s2n considers all TLS alerts fatal and shuts down a connection whenever one is received.</p>
<h3><a class="anchor" id="autotoc_md449"></a>
s2n_connection_get_cipher</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code hl_function" href="s2n_8h.html#a7d209fc431877f954b4fcd45df75d91d">s2n_connection_get_cipher</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a7d209fc431877f954b4fcd45df75d91d"><div class="ttname"><a href="s2n_8h.html#a7d209fc431877f954b4fcd45df75d91d">s2n_connection_get_cipher</a></div><div class="ttdeci">S2N_API const char * s2n_connection_get_cipher(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:970</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_cipher</b> returns a string indicating the cipher suite negotiated by s2n for a connection in Openssl format, e.g. "ECDHE-RSA-AES128-GCM-SHA256".</p>
<h3><a class="anchor" id="autotoc_md450"></a>
s2n_connection_get_curve</h3>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code hl_function" href="s2n_8h.html#a000aa5c17754997f3ba3c02a337a4e80">s2n_connection_get_curve</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a000aa5c17754997f3ba3c02a337a4e80"><div class="ttname"><a href="s2n_8h.html#a000aa5c17754997f3ba3c02a337a4e80">s2n_connection_get_curve</a></div><div class="ttdeci">S2N_API const char * s2n_connection_get_curve(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:978</div></div>
</div><!-- fragment --><p ><b>s2n_connection_get_curve</b> returns a string indicating the elliptic curve used during ECDHE key exchange. The string "NONE" is returned if no curve has was used.</p>
<h3><a class="anchor" id="autotoc_md451"></a>
s2n_connection_get_selected_cert</h3>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structs2n__cert__chain__and__key.html">s2n_cert_chain_and_key</a> <a class="code hl_function" href="s2n_8h.html#ad060416f26be8020a5701ff3ae18dacc">s2n_connection_get_selected_cert</a>(struct <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_ad060416f26be8020a5701ff3ae18dacc"><div class="ttname"><a href="s2n_8h.html#ad060416f26be8020a5701ff3ae18dacc">s2n_connection_get_selected_cert</a></div><div class="ttdeci">S2N_API struct s2n_cert_chain_and_key * s2n_connection_get_selected_cert(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1305</div></div>
</div><!-- fragment --><p >Return the certificate that was used during the TLS handshake.</p>
<ul>
<li>If <b>conn</b> is a server connection, the certificate selected will depend on the ServerName sent by the client and supported ciphers.</li>
<li>If <b>conn</b> is a client connection, the certificate sent in response to a CertificateRequest message is returned. Currently s2n supports loading only one certificate in client mode. Note that not all TLS endpoints will request a certificate.</li>
</ul>
<p >This function returns NULL if the certificate selection phase of the handshake has not completed or if a certificate was not requested by the peer.</p>
<h3><a class="anchor" id="autotoc_md452"></a>
Session Resumption Related calls</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a012950b0841dad53f4ce0b7bd9892757">s2n_config_set_session_state_lifetime</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, uint32_t lifetime_in_secs);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#aaf779e2e30ec1881f5f63bfae5dc3303">s2n_connection_set_session</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keyword">const</span> uint8_t *<a class="code hl_variable" href="namespacecreate-projects.html#a467e4c545519c2e948722fac14922c16">session</a>, <span class="keywordtype">size_t</span> <a class="code hl_typedef" href="iocp__event__loop_8c.html#ae809d5359ac030c60a30a8f0b2294b82">length</a>);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ae1ed55a367727eea8e041630406bb144">s2n_connection_get_session</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, uint8_t *<a class="code hl_variable" href="namespacecreate-projects.html#a467e4c545519c2e948722fac14922c16">session</a>, <span class="keywordtype">size_t</span> max_length);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a8a8f58e34e1fc8eb35f7ac8fe55123a5">s2n_connection_get_session_ticket_lifetime_hint</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ab0b2840c308f1e6d9a5a47631e9991c2">s2n_connection_get_session_length</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#acc34cfe4ca708912cf9309cc98000c08">s2n_connection_get_session_id_length</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a242a28fb68a8903416dc0de77ff4b1bc">s2n_connection_get_session_id</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, uint8_t *session_id, <span class="keywordtype">size_t</span> max_length);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ae3657d081eb0957f87d93391653eb20c">s2n_connection_is_session_resumed</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="anamespacecreate-projects_html_a467e4c545519c2e948722fac14922c16"><div class="ttname"><a href="namespacecreate-projects.html#a467e4c545519c2e948722fac14922c16">create-projects.session</a></div><div class="ttdeci">session</div><div class="ttdef"><b>Definition:</b> create-projects.py:139</div></div>
<div class="ttc" id="as2n_8h_html_a012950b0841dad53f4ce0b7bd9892757"><div class="ttname"><a href="s2n_8h.html#a012950b0841dad53f4ce0b7bd9892757">s2n_config_set_session_state_lifetime</a></div><div class="ttdeci">S2N_API int s2n_config_set_session_state_lifetime(struct s2n_config *config, uint64_t lifetime_in_secs)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:676</div></div>
<div class="ttc" id="as2n_8h_html_a242a28fb68a8903416dc0de77ff4b1bc"><div class="ttname"><a href="s2n_8h.html#a242a28fb68a8903416dc0de77ff4b1bc">s2n_connection_get_session_id</a></div><div class="ttdeci">S2N_API int s2n_connection_get_session_id(struct s2n_connection *conn, uint8_t *session_id, size_t max_length)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1114</div></div>
<div class="ttc" id="as2n_8h_html_a8a8f58e34e1fc8eb35f7ac8fe55123a5"><div class="ttname"><a href="s2n_8h.html#a8a8f58e34e1fc8eb35f7ac8fe55123a5">s2n_connection_get_session_ticket_lifetime_hint</a></div><div class="ttdeci">S2N_API int s2n_connection_get_session_ticket_lifetime_hint(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_resume.c:284</div></div>
<div class="ttc" id="as2n_8h_html_aaf779e2e30ec1881f5f63bfae5dc3303"><div class="ttname"><a href="s2n_8h.html#aaf779e2e30ec1881f5f63bfae5dc3303">s2n_connection_set_session</a></div><div class="ttdeci">S2N_API int s2n_connection_set_session(struct s2n_connection *conn, const uint8_t *session, size_t length)</div><div class="ttdef"><b>Definition:</b> s2n_resume.c:244</div></div>
<div class="ttc" id="as2n_8h_html_ab0b2840c308f1e6d9a5a47631e9991c2"><div class="ttname"><a href="s2n_8h.html#ab0b2840c308f1e6d9a5a47631e9991c2">s2n_connection_get_session_length</a></div><div class="ttdeci">S2N_API int s2n_connection_get_session_length(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_resume.c:293</div></div>
<div class="ttc" id="as2n_8h_html_acc34cfe4ca708912cf9309cc98000c08"><div class="ttname"><a href="s2n_8h.html#acc34cfe4ca708912cf9309cc98000c08">s2n_connection_get_session_id_length</a></div><div class="ttdeci">S2N_API int s2n_connection_get_session_id_length(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:1108</div></div>
<div class="ttc" id="as2n_8h_html_ae1ed55a367727eea8e041630406bb144"><div class="ttname"><a href="s2n_8h.html#ae1ed55a367727eea8e041630406bb144">s2n_connection_get_session</a></div><div class="ttdeci">S2N_API int s2n_connection_get_session(struct s2n_connection *conn, uint8_t *session, size_t max_length)</div><div class="ttdef"><b>Definition:</b> s2n_resume.c:260</div></div>
<div class="ttc" id="as2n_8h_html_ae3657d081eb0957f87d93391653eb20c"><div class="ttname"><a href="s2n_8h.html#ae3657d081eb0957f87d93391653eb20c">s2n_connection_is_session_resumed</a></div><div class="ttdeci">S2N_API int s2n_connection_is_session_resumed(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_resume.c:306</div></div>
</div><!-- fragment --><ul>
<li><b>lifetime_in_secs</b> lifetime of the cached session state required to resume a handshake.</li>
<li><b>session</b> session will contain serialized session related information needed to resume handshake either using session id or session ticket.</li>
<li><b>length</b> length of the serialized session state.</li>
<li><b>max_length</b> Max number of bytes to copy into the <b>session</b> buffer.</li>
</ul>
<p ><b>s2n_config_set_session_state_lifetime</b> sets the lifetime of the cached session state. The default value is 15 hours.</p>
<p ><b>s2n_connection_set_session</b> de-serializes the session state and updates the connection accordingly.</p>
<p ><b>s2n_connection_get_session</b> serializes the session state from connection and copies into the <b>session</b> buffer and returns the number of bytes that were copied. If the first byte in <b>session</b> is 1, then the next 2 bytes will contain the session ticket length, followed by session ticket and session state. If the first byte in <b>session</b> is 0, then the next byte will contain session id length, followed by session id and session state.</p>
<p ><b>s2n_connection_get_session_ticket_lifetime_hint</b> returns the session ticket lifetime hint in seconds from the server or -1 when session ticket was not used for resumption.</p>
<p ><b>s2n_connection_get_session_length</b> returns number of bytes needed to store serialized session state; it can be used to allocate the <b>session</b> buffer.</p>
<p ><b>s2n_connection_get_session_id_length</b> returns session id length from the connection.</p>
<p ><b>s2n_connection_get_session_id</b> get the session id from the connection and copies into the <b>session_id</b> buffer and returns the number of bytes that were copied.</p>
<p ><b>s2n_connection_is_session_resumed</b> returns 1 if the handshake was abbreviated, otherwise returns 0.</p>
<h3><a class="anchor" id="autotoc_md453"></a>
Session Ticket Specific calls</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#afb17f02a0b6a6c74e3db143c7c3d62a6">s2n_config_set_session_tickets_onoff</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, uint8_t enabled);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a54ac0a3900f9784804dff154ea404f83">s2n_config_set_ticket_encrypt_decrypt_key_lifetime</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, uint64_t lifetime_in_secs);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a59be9ad4336811d9910f07bb74edb364">s2n_config_set_ticket_decrypt_key_lifetime</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, uint64_t lifetime_in_secs);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ae6d6a59a875a39fdd9f81ae02595173d">s2n_config_add_ticket_crypto_key</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <span class="keyword">const</span> uint8_t *<a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a25d22ecc7e656d2c59332072684e8766">name</a>, uint32_t name_len, uint8_t *key, uint32_t key_len, uint64_t intro_time_in_seconds_from_epoch);</div>
<div class="ttc" id="as2n_8h_html_a54ac0a3900f9784804dff154ea404f83"><div class="ttname"><a href="s2n_8h.html#a54ac0a3900f9784804dff154ea404f83">s2n_config_set_ticket_encrypt_decrypt_key_lifetime</a></div><div class="ttdeci">S2N_API int s2n_config_set_ticket_encrypt_decrypt_key_lifetime(struct s2n_config *config, uint64_t lifetime_in_secs)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:721</div></div>
<div class="ttc" id="as2n_8h_html_a59be9ad4336811d9910f07bb74edb364"><div class="ttname"><a href="s2n_8h.html#a59be9ad4336811d9910f07bb74edb364">s2n_config_set_ticket_decrypt_key_lifetime</a></div><div class="ttdeci">S2N_API int s2n_config_set_ticket_decrypt_key_lifetime(struct s2n_config *config, uint64_t lifetime_in_secs)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:730</div></div>
<div class="ttc" id="as2n_8h_html_ae6d6a59a875a39fdd9f81ae02595173d"><div class="ttname"><a href="s2n_8h.html#ae6d6a59a875a39fdd9f81ae02595173d">s2n_config_add_ticket_crypto_key</a></div><div class="ttdeci">S2N_API int s2n_config_add_ticket_crypto_key(struct s2n_config *config, const uint8_t *name, uint32_t name_len, uint8_t *key, uint32_t key_len, uint64_t intro_time_in_seconds_from_epoch)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:739</div></div>
<div class="ttc" id="as2n_8h_html_afb17f02a0b6a6c74e3db143c7c3d62a6"><div class="ttname"><a href="s2n_8h.html#afb17f02a0b6a6c74e3db143c7c3d62a6">s2n_config_set_session_tickets_onoff</a></div><div class="ttdeci">S2N_API int s2n_config_set_session_tickets_onoff(struct s2n_config *config, uint8_t enabled)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:685</div></div>
</div><!-- fragment --><ul>
<li><b>enabled</b> when set to 0 will disable session resumption using session ticket</li>
<li><b>name</b> name of the session ticket key that should be randomly generated to avoid collisions</li>
<li><b>name_len</b> length of session ticket key name</li>
<li><b>key</b> key used to perform encryption/decryption of session ticket</li>
<li><b>key_len</b> length of the session ticket key</li>
<li><b>intro_time_in_seconds_from_epoch</b> time at which the session ticket key is introduced. If this is 0, then intro_time_in_seconds_from_epoch is set to now.</li>
</ul>
<p ><b>s2n_config_set_session_tickets_onoff</b> enables and disables session resumption using session ticket</p>
<p ><b>s2n_config_set_ticket_encrypt_decrypt_key_lifetime</b> sets how long a session ticket key will be in a state where it can be used for both encryption and decryption of tickets on the server side. The default value is 2 hours.</p>
<p ><b>s2n_config_set_ticket_decrypt_key_lifetime</b> sets how long a session ticket key will be in a state where it can used just for decryption of already assigned tickets on the server side. Once decrypted, the session will resume and the server will issue a new session ticket encrypted using a key in encrypt-decrypt state. The default value is 13 hours.</p>
<p ><b>s2n_config_add_ticket_crypto_key</b> adds session ticket key on the server side. It would be ideal to add new keys after every (encrypt_decrypt_key_lifetime_in_nanos/2) nanos because this will allow for gradual and linear transition of a key from encrypt-decrypt state to decrypt-only state.</p>
<h3><a class="anchor" id="autotoc_md454"></a>
Asynchronous private key operations related calls</h3>
<p >When s2n is used in non-blocking mode, this set of functions allows user to move execution of CPU-heavy private key operations out of the main event loop, preventing <b>s2n_negotiate</b> blocking the loop for a few milliseconds each time the private key operation needs to be performed.</p>
<p >To enable asynchronous private key operations user needs to provide a callback function <b>s2n_async_pkey_fn</b> to <b>s2n_config_set_async_pkey_callback</b> call. This function will be executed during <b>s2n_negotiate</b> call every time an operation on private key needs to be performed. The argument <b>op</b> represents the operation to perform. From the callback the user can spawn the thread to perform <b>op</b> through <b>s2n_async_pkey_op_perform</b> call and immediately return <b>S2N_SUCCESS</b> from the function without waiting for thread to complete. The <b>s2n_negotiate</b> will return <b>S2N_FAILURE</b> with <b>S2N_ERR_T_BLOCKED</b> error type and <b>s2n_blocked_status</b> <b>S2N_BLOCKED_ON_APPLICATION_INPUT</b>, and will keep giving the same error until the <b>op</b> is performed and applied to the connection through <b>s2n_async_pkey_op_apply</b> call.</p>
<p >Note, it is not safe to call multiple functions on the same <b>conn</b> or <b>op</b> objects from 2 different threads at the same time. Doing so will produce undefined behaviour. However it is safe to have a call to function involving only <b>conn</b> at the same time with a call to function involving only <b>op</b>, as those 2 objects are not coupled with each other. It is also safe to free <b>conn</b> or <b>op</b> at any moment with respective function calls, with the only exception that <b>conn</b> cannot be freed inside the <b>s2n_async_pkey_fn</b> callback.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> int (*<a class="code hl_typedef" href="s2n_8h.html#a2ecb6a187e25469c3fd108a873da1cce">s2n_async_pkey_fn</a>)(<span class="keyword">struct </span><a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keyword">struct </span><a class="code hl_struct" href="structs2n__async__pkey__op.html">s2n_async_pkey_op</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#ae63bff330b37a07b1f06f9d121148392">op</a>);</div>
<div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a28fc426b41fe7e3349f562bb7883448e">s2n_config_set_async_pkey_callback</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__config.html">s2n_config</a> *<a class="code hl_variable" href="s2n__client__key__recv__fuzz__test_8c.html#a7d70bb7bed95daae1233293126bb9523">config</a>, <a class="code hl_typedef" href="s2n_8h.html#a2ecb6a187e25469c3fd108a873da1cce">s2n_async_pkey_fn</a> fn);</div>
<div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ae98d7c23a90e072172d2e0e5f94b5919">s2n_async_pkey_op_perform</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__async__pkey__op.html">s2n_async_pkey_op</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#ae63bff330b37a07b1f06f9d121148392">op</a>, <a class="code hl_struct" href="structs2n__pkey.html">s2n_cert_private_key</a> *key);</div>
<div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a410b7982584c24d60d25012322e38594">s2n_async_pkey_op_apply</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__async__pkey__op.html">s2n_async_pkey_op</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#ae63bff330b37a07b1f06f9d121148392">op</a>, <span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a>);</div>
<div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a95c2b74b21a46d45baa29d74cf6db401">s2n_async_pkey_op_free</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__async__pkey__op.html">s2n_async_pkey_op</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#ae63bff330b37a07b1f06f9d121148392">op</a>);</div>
<div class="ttc" id="as2n_8h_html_a28fc426b41fe7e3349f562bb7883448e"><div class="ttname"><a href="s2n_8h.html#a28fc426b41fe7e3349f562bb7883448e">s2n_config_set_async_pkey_callback</a></div><div class="ttdeci">S2N_API int s2n_config_set_async_pkey_callback(struct s2n_config *config, s2n_async_pkey_fn fn)</div><div class="ttdef"><b>Definition:</b> s2n_config.c:500</div></div>
<div class="ttc" id="as2n_8h_html_a2ecb6a187e25469c3fd108a873da1cce"><div class="ttname"><a href="s2n_8h.html#a2ecb6a187e25469c3fd108a873da1cce">s2n_async_pkey_fn</a></div><div class="ttdeci">int(* s2n_async_pkey_fn)(struct s2n_connection *conn, struct s2n_async_pkey_op *op)</div><div class="ttdef"><b>Definition:</b> s2n.h:426</div></div>
<div class="ttc" id="as2n_8h_html_a410b7982584c24d60d25012322e38594"><div class="ttname"><a href="s2n_8h.html#a410b7982584c24d60d25012322e38594">s2n_async_pkey_op_apply</a></div><div class="ttdeci">S2N_API int s2n_async_pkey_op_apply(struct s2n_async_pkey_op *op, struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_async_pkey.c:292</div></div>
<div class="ttc" id="as2n_8h_html_a95c2b74b21a46d45baa29d74cf6db401"><div class="ttname"><a href="s2n_8h.html#a95c2b74b21a46d45baa29d74cf6db401">s2n_async_pkey_op_free</a></div><div class="ttdeci">S2N_API int s2n_async_pkey_op_free(struct s2n_async_pkey_op *op)</div><div class="ttdef"><b>Definition:</b> s2n_async_pkey.c:321</div></div>
<div class="ttc" id="as2n_8h_html_ae98d7c23a90e072172d2e0e5f94b5919"><div class="ttname"><a href="s2n_8h.html#ae98d7c23a90e072172d2e0e5f94b5919">s2n_async_pkey_op_perform</a></div><div class="ttdeci">S2N_API int s2n_async_pkey_op_perform(struct s2n_async_pkey_op *op, s2n_cert_private_key *key)</div><div class="ttdef"><b>Definition:</b> s2n_async_pkey.c:275</div></div>
<div class="ttc" id="astructs2n__async__pkey__op_html"><div class="ttname"><a href="structs2n__async__pkey__op.html">s2n_async_pkey_op</a></div><div class="ttdef"><b>Definition:</b> s2n_async_pkey.c:44</div></div>
<div class="ttc" id="astructs2n__async__pkey__op_html_acd558153c69d882e9ae27cd3b19fd31a"><div class="ttname"><a href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">s2n_async_pkey_op::conn</a></div><div class="ttdeci">struct s2n_connection * conn</div><div class="ttdef"><b>Definition:</b> s2n_async_pkey.c:46</div></div>
<div class="ttc" id="astructs2n__async__pkey__op_html_ae63bff330b37a07b1f06f9d121148392"><div class="ttname"><a href="structs2n__async__pkey__op.html#ae63bff330b37a07b1f06f9d121148392">s2n_async_pkey_op::op</a></div><div class="ttdeci">union s2n_async_pkey_op::@107 op</div></div>
</div><!-- fragment --><ul>
<li><b>op</b> is an opaque object representing private key operation which needs to be performed.</li>
<li><b>key</b> is a private key used for operation, can be extracted from <b>conn</b> through <b>s2n_connection_get_selected_cert</b> and <b>s2n_cert_chain_and_key_get_key</b> calls.</li>
</ul>
<p ><b>s2n_async_pkey_fn</b> is invoked every time some action involving private key is required during <b>s2n_negotiate</b>. The <b>conn</b> provides a pointer to the connection which triggered the callback, the <b>op</b> is a pointer to an operation to be performed. The callback takes the ownership of <b>op</b> object and is responsible for freeing the memory for it.</p>
<p ><b>s2n_config_set_async_pkey_callback</b> sets up the callback to invoke for asynchronous private key operations and enables asynchronous mode.</p>
<p ><b>s2n_async_pkey_op_perform</b> performs the <b>op</b> allowing it to be used to resume the handshake through <b>s2n_async_pkey_op_apply</b> call. This function can be called only once and any subsequent calls will produce a failure. It is safe to call from a different thread, as long as no other thread is operating on <b>op</b>.</p>
<p ><b>s2n_async_pkey_op_apply</b> applies the performed <b>op</b> to <b>conn</b> allowing for the next call to <b>s2n_negotiate</b> to proceed through handshake. The function will fail if it is called from <b>s2n_async_pkey_fn</b> callback, or if <b>op</b> was not performed through <b>s2n_async_pkey_op_perform</b> call, or if provided <b>conn</b> is different from the original <b>conn</b> which initiated callback for this <b>op</b>. The function will succeed only once and any subsequent call will result in failure for the same <b>op</b>.</p>
<p ><b>s2n_async_pkey_op_free</b> frees the memory for <b>op</b>. Should eventually be called for each of the <b>op</b> received in <b>s2n_async_pkey_fn</b> to avoid any memory leaks.</p>
<h3><a class="anchor" id="autotoc_md455"></a>
s2n_connection_free_handshake</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a0dcc520aac12e66149d83859e8e62d92">s2n_connection_free_handshake</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a>);</div>
<div class="ttc" id="as2n_8h_html_a0dcc520aac12e66149d83859e8e62d92"><div class="ttname"><a href="s2n_8h.html#a0dcc520aac12e66149d83859e8e62d92">s2n_connection_free_handshake</a></div><div class="ttdeci">S2N_API int s2n_connection_free_handshake(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:558</div></div>
</div><!-- fragment --><p ><b>s2n_connection_free_handshake</b> wipes and releases buffers and memory allocated during the TLS handshake. This function should be called after the handshake is successfully negotiated and logging or recording of handshake data is complete.</p>
<h3><a class="anchor" id="autotoc_md456"></a>
s2n_connection_release_buffers</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#af86a8545d176c7097fa036649968a896">s2n_connection_release_buffers</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a>);</div>
<div class="ttc" id="as2n_8h_html_af86a8545d176c7097fa036649968a896"><div class="ttname"><a href="s2n_8h.html#af86a8545d176c7097fa036649968a896">s2n_connection_release_buffers</a></div><div class="ttdeci">S2N_API int s2n_connection_release_buffers(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:541</div></div>
</div><!-- fragment --><p ><b>s2n_connection_release_buffers</b> wipes and free the <code>in</code> and <code>out</code> buffers associated with a connection. This function may be called when a connection is in keep-alive or idle state to reduce memory overhead of long lived connections.</p>
<h3><a class="anchor" id="autotoc_md457"></a>
s2n_connection_wipe</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ae42c3c7b37df666c2b3e6a53c1ea5f76">s2n_connection_wipe</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a>);</div>
<div class="ttc" id="as2n_8h_html_ae42c3c7b37df666c2b3e6a53c1ea5f76"><div class="ttname"><a href="s2n_8h.html#ae42c3c7b37df666c2b3e6a53c1ea5f76">s2n_connection_wipe</a></div><div class="ttdeci">S2N_API int s2n_connection_wipe(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:592</div></div>
</div><!-- fragment --><p ><b>s2n_connection_wipe</b> wipes an existing connection and allows it to be reused. It erases all data associated with a connection including pending reads. This function should be called after all I/O is completed and <a href="#s2n\_shutdown">s2n_shutdown</a> has been called. Reusing the same connection handle(s) is more performant than repeatedly calling <a href="#s2n\_connection\_new">s2n_connection_new</a> and <a href="#s2n\_connection\_free">s2n_connection_free</a></p>
<h3><a class="anchor" id="autotoc_md458"></a>
s2n_connection_free</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a9c7664ec2fe4c694148ad303f4229f94">s2n_connection_free</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a>);</div>
<div class="ttc" id="as2n_8h_html_a9c7664ec2fe4c694148ad303f4229f94"><div class="ttname"><a href="s2n_8h.html#a9c7664ec2fe4c694148ad303f4229f94">s2n_connection_free</a></div><div class="ttdeci">S2N_API int s2n_connection_free(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:451</div></div>
</div><!-- fragment --><p ><b>s2n_connection_free</b> frees the memory associated with an <a class="el" href="structs2n__connection.html">s2n_connection</a> handle. The handle is considered invalid after <b>s2n_connection_free</b> is used. <a href="#s2n\_connection\_wipe">s2n_connection_wipe</a> does not need to be called prior to this function. <b>s2n_connection_free</b> performs its own wipe of sensitive data.</p>
<h2><a class="anchor" id="autotoc_md459"></a>
I/O functions</h2>
<p >s2n supports both blocking and non-blocking I/O. To use s2n in non-blocking mode, set the underlying file descriptors as non-blocking (i.e. with <b>fcntl</b>). In blocking mode, each s2n I/O function will not return until it is complete. In non-blocking mode an s2n I/O function may return while there is still I/O pending. In this case the value of the <b>blocked</b> parameter will be set to either <b>S2N_BLOCKED_ON_READ</b> or <b>S2N_BLOCKED_ON_WRITE</b>, depending on the direction in which s2n is blocked.</p>
<p >s2n I/O functions should be called repeatedly until the <b>blocked</b> parameter is <b>S2N_NOT_BLOCKED</b>.</p>
<h3><a class="anchor" id="autotoc_md460"></a>
s2n_negotiate</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#ad3222e7aacf35a56be842678171be440">s2n_negotiate</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a>, <a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="ttc" id="ahttps_8c_html_ad4675d5d36c6aef3c5f7eaca1d538053"><div class="ttname"><a href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a></div><div class="ttdeci">static s2n_blocked_status blocked</div><div class="ttdef"><b>Definition:</b> https.c:27</div></div>
<div class="ttc" id="as2n_8h_html_ad3222e7aacf35a56be842678171be440"><div class="ttname"><a href="s2n_8h.html#ad3222e7aacf35a56be842678171be440">s2n_negotiate</a></div><div class="ttdeci">S2N_API int s2n_negotiate(struct s2n_connection *conn, s2n_blocked_status *blocked)</div><div class="ttdef"><b>Definition:</b> s2n_handshake_io.c:1140</div></div>
</div><!-- fragment --><p ><b>s2n_negotiate</b> performs the initial "handshake" phase of a TLS connection and must be called before any <b>s2n_recv</b> or <b>s2n_send</b> calls.</p>
<h3><a class="anchor" id="autotoc_md461"></a>
s2n_send</h3>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#a9afeb514731fa9d74edf6b9e1348c067">s2n_send</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a> </div>
<div class="line">              <span class="keywordtype">void</span> *<a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>,</div>
<div class="line">              <a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> size,</div>
<div class="line">              <a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="ttc" id="aaws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_html_a1fe855c208bc17a51a4d34fefdb2d5b1"><div class="ttname"><a href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a></div><div class="ttdeci">char * buf</div><div class="ttdef"><b>Definition:</b> cJSON.h:169</div></div>
<div class="ttc" id="as2n_8h_html_a9afeb514731fa9d74edf6b9e1348c067"><div class="ttname"><a href="s2n_8h.html#a9afeb514731fa9d74edf6b9e1348c067">s2n_send</a></div><div class="ttdeci">S2N_API ssize_t s2n_send(struct s2n_connection *conn, const void *buf, ssize_t size, s2n_blocked_status *blocked)</div><div class="ttdef"><b>Definition:</b> s2n_send.c:210</div></div>
</div><!-- fragment --><p ><b>s2n_send</b> writes and encrypts <b>size* of **buf</b> data to the associated connection. <b>s2n_send</b> will return the number of bytes written, and may indicate a partial write. Partial writes are possible not just for non-blocking I/O, but also for connections aborted while active. <b>NOTE:</b> Unlike OpenSSL, repeated calls to <b>s2n_send</b> should not duplicate the original parameters, but should update <b>buf</b> and <b>size</b> per the indication of size written. For example;</p>
<div class="fragment"><div class="line"><a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> <a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>;</div>
<div class="line"><span class="keywordtype">int</span> written = 0;</div>
<div class="line"><span class="keywordtype">char</span> data[10]; <span class="comment">/* Some data we want to write */</span></div>
<div class="line"><span class="keywordflow">do</span> {</div>
<div class="line">    <span class="keywordtype">int</span> w = <a class="code hl_function" href="s2n_8h.html#a9afeb514731fa9d74edf6b9e1348c067">s2n_send</a>(<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a>, data + written, 10 - written, &amp;<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (w &lt; 0) {</div>
<div class="line">        <span class="comment">/* Some kind of error */</span></div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    written += w;</div>
<div class="line">} <span class="keywordflow">while</span> (<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a> != <a class="code hl_enumvalue" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a>); </div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md462"></a>
s2n_sendv_with_offset</h3>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#a1b09f96a5f4fe3b78a08e76e7304853f">s2n_sendv_with_offset</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *<a class="code hl_variable" href="structs2n__async__pkey__op.html#acd558153c69d882e9ae27cd3b19fd31a">conn</a> </div>
<div class="line">              <span class="keyword">const</span> <span class="keyword">struct</span> iovec *bufs,</div>
<div class="line">              <a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>,</div>
<div class="line">              <a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> offs,</div>
<div class="line">              <a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="ttc" id="aaws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> cJSON.h:220</div></div>
<div class="ttc" id="as2n_8h_html_a1b09f96a5f4fe3b78a08e76e7304853f"><div class="ttname"><a href="s2n_8h.html#a1b09f96a5f4fe3b78a08e76e7304853f">s2n_sendv_with_offset</a></div><div class="ttdeci">S2N_API ssize_t s2n_sendv_with_offset(struct s2n_connection *conn, const struct iovec *bufs, ssize_t count, ssize_t offs, s2n_blocked_status *blocked)</div><div class="ttdef"><b>Definition:</b> s2n_send.c:91</div></div>
</div><!-- fragment --><p ><b>s2n_sendv_with_offset</b> works in the same way as <b>s2n_send</b> except that it accepts vectorized buffers. <b>s2n_sendv_with_offset</b> will return the number of bytes written, and may indicate a partial write. Partial writes are possible not just for non-blocking I/O, but also for connections aborted while active. <b>NOTE:</b> Unlike OpenSSL, repeated calls to <b>s2n_sendv_with_offset</b> should not duplicate the original parameters, but should update <b>bufs</b> and <b>count</b> per the indication of size written. For example;</p>
<div class="fragment"><div class="line"><a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> <a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>;</div>
<div class="line"><span class="keywordtype">int</span> written = 0;</div>
<div class="line"><span class="keywordtype">char</span> data[10]; <span class="comment">/* Some data we want to write */</span></div>
<div class="line"><span class="keyword">struct </span>iovec iov[1];</div>
<div class="line">iov[0].iov_base = data;</div>
<div class="line">iov[0].iov_len = 10;</div>
<div class="line"><span class="keywordflow">do</span> {</div>
<div class="line">    <span class="keywordtype">int</span> w = <a class="code hl_function" href="s2n_8h.html#a1b09f96a5f4fe3b78a08e76e7304853f">s2n_sendv_with_offset</a>(conn, iov, 1, written, &amp;<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (w &lt; 0) {</div>
<div class="line">        <span class="comment">/* Some kind of error */</span></div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    written += w;</div>
<div class="line">} <span class="keywordflow">while</span> (<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a> != <a class="code hl_enumvalue" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a>); </div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md463"></a>
s2n_sendv</h3>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#a726589f5cc8871b5efe9740aca05ed97">s2n_sendv</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn </div>
<div class="line">              <span class="keyword">const</span> <span class="keyword">struct</span> iovec *bufs,</div>
<div class="line">              <a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>,</div>
<div class="line">              <a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="ttc" id="as2n_8h_html_a726589f5cc8871b5efe9740aca05ed97"><div class="ttname"><a href="s2n_8h.html#a726589f5cc8871b5efe9740aca05ed97">s2n_sendv</a></div><div class="ttdeci">S2N_API ssize_t s2n_sendv(struct s2n_connection *conn, const struct iovec *bufs, ssize_t count, s2n_blocked_status *blocked)</div><div class="ttdef"><b>Definition:</b> s2n_send.c:205</div></div>
</div><!-- fragment --><p ><b>s2n_sendv</b> works in the same way as <b>s2n_sendv_with_offset</b> except that the latter's <b>offs</b> parameter is implicitly assumed to be 0. Therefore in the partial write case, the caller would have to make sure that <b>bufs</b> and <b>count</b> fields are modified in a way that takes the partial writes into account.</p>
<h3><a class="anchor" id="autotoc_md464"></a>
s2n_recv</h3>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> <a class="code hl_function" href="s2n_8h.html#a3b67ff058796d4c6c6caddfd0f10274e">s2n_recv</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn,</div>
<div class="line">             <span class="keywordtype">void</span> *<a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>,</div>
<div class="line">             <a class="code hl_typedef" href="preamble_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> size,</div>
<div class="line">             <a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="ttc" id="as2n_8h_html_a3b67ff058796d4c6c6caddfd0f10274e"><div class="ttname"><a href="s2n_8h.html#a3b67ff058796d4c6c6caddfd0f10274e">s2n_recv</a></div><div class="ttdeci">S2N_API ssize_t s2n_recv(struct s2n_connection *conn, void *buf, ssize_t size, s2n_blocked_status *blocked)</div><div class="ttdef"><b>Definition:</b> s2n_recv.c:120</div></div>
</div><!-- fragment --><p ><b>s2n_recv</b> decrypts and reads <b>size* to **buf</b> data from the associated connection. <b>s2n_recv</b> will return the number of bytes read and also return "0" on connection shutdown by the peer.</p>
<p ><b>NOTE:</b> Unlike OpenSSL, repeated calls to <b>s2n_recv</b> should not duplicate the original parameters, but should update <b>buf</b> and <b>size</b> per the indication of size read. For example;</p>
<div class="fragment"><div class="line"><a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> <a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>;</div>
<div class="line"><span class="keywordtype">int</span> bytes_read = 0;</div>
<div class="line"><span class="keywordtype">char</span> data[10];</div>
<div class="line"><span class="keywordflow">do</span> {</div>
<div class="line">    <span class="keywordtype">int</span> r = <a class="code hl_function" href="s2n_8h.html#a3b67ff058796d4c6c6caddfd0f10274e">s2n_recv</a>(conn, data + bytes_read, 10 - bytes_read, &amp;<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        <span class="comment">/* Some kind of error */</span></div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    bytes_read += r;</div>
<div class="line">} <span class="keywordflow">while</span> (<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a> != <a class="code hl_enumvalue" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a>);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md465"></a>
s2n_peek</h3>
<div class="fragment"><div class="line">uint32_t <a class="code hl_function" href="s2n_8h.html#a1b49cd285e03ba447a8250f01864cca5">s2n_peek</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn);</div>
<div class="ttc" id="as2n_8h_html_a1b49cd285e03ba447a8250f01864cca5"><div class="ttname"><a href="s2n_8h.html#a1b49cd285e03ba447a8250f01864cca5">s2n_peek</a></div><div class="ttdeci">S2N_API uint32_t s2n_peek(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> s2n_recv.c:205</div></div>
</div><!-- fragment --><p ><b>s2n_peek</b> allows users of S2N to peek inside the data buffer of an S2N connection to see if there more data to be read without actually reading it. This is useful when using select() on the underlying S2N file descriptor with a message based application layer protocol. As a single call to s2n_recv may read all data off the underlying file descriptor, select() will be unable to tell you there if there is more application data ready for processing already loaded into the S2N buffer. s2n_peek can then be used to determine if s2n_recv needs to be called before more data comes in on the raw fd.</p>
<h3><a class="anchor" id="autotoc_md466"></a>
s2n_connection_set_send_cb</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a699fd9e05a8e8163811db6cab01af973">s2n_connection_set_recv_cb</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, s2n_connection_recv recv);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a4b73b9a8fa03500d5bc609d09035cd45">s2n_connection_set_send_cb</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, s2n_connection_send send);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a67e1ad17b8453e9ef8ca1df35b7f0ae7">s2n_connection_set_recv_ctx</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keywordtype">void</span> *<a class="code hl_variable" href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a>);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a4857138d82f79f939546693b587a61d4">s2n_connection_set_send_ctx</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn, <span class="keywordtype">void</span> *<a class="code hl_variable" href="channel__handler__test_8c.html#a1795d4ea01d211a7398ecd541c6f1302">ctx</a>);</div>
<div class="ttc" id="as2n_8h_html_a4857138d82f79f939546693b587a61d4"><div class="ttname"><a href="s2n_8h.html#a4857138d82f79f939546693b587a61d4">s2n_connection_set_send_ctx</a></div><div class="ttdeci">S2N_API int s2n_connection_set_send_ctx(struct s2n_connection *conn, void *ctx)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:730</div></div>
<div class="ttc" id="as2n_8h_html_a4b73b9a8fa03500d5bc609d09035cd45"><div class="ttname"><a href="s2n_8h.html#a4b73b9a8fa03500d5bc609d09035cd45">s2n_connection_set_send_cb</a></div><div class="ttdeci">S2N_API int s2n_connection_set_send_cb(struct s2n_connection *conn, s2n_send_fn send)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:742</div></div>
<div class="ttc" id="as2n_8h_html_a67e1ad17b8453e9ef8ca1df35b7f0ae7"><div class="ttname"><a href="s2n_8h.html#a67e1ad17b8453e9ef8ca1df35b7f0ae7">s2n_connection_set_recv_ctx</a></div><div class="ttdeci">S2N_API int s2n_connection_set_recv_ctx(struct s2n_connection *conn, void *ctx)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:724</div></div>
<div class="ttc" id="as2n_8h_html_a699fd9e05a8e8163811db6cab01af973"><div class="ttname"><a href="s2n_8h.html#a699fd9e05a8e8163811db6cab01af973">s2n_connection_set_recv_cb</a></div><div class="ttdeci">S2N_API int s2n_connection_set_recv_cb(struct s2n_connection *conn, s2n_recv_fn recv)</div><div class="ttdef"><b>Definition:</b> s2n_connection.c:736</div></div>
</div><!-- fragment --><p >s2n also provides an I/O abstraction layer in the event the application would like to keep control over I/O operations. <b>s2n_connection_set_recv_cb</b> and <b>s2n_connection_set_send_cb</b> may be used to send or receive data with callbacks defined by the user. These may be blocking or nonblocking.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keywordtype">int</span> s2n_connection_send(<span class="keywordtype">void</span> *io_context, <span class="keyword">const</span> uint8_t *<a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, uint32_t <a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a0f1e4ab31fd4f3ca4329091911f1f1af">len</a>);</div>
<div class="line"><span class="keyword">typedef</span> <span class="keywordtype">int</span> s2n_connection_recv(<span class="keywordtype">void</span> *io_context, uint8_t *<a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a>, uint32_t <a class="code hl_variable" href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a0f1e4ab31fd4f3ca4329091911f1f1af">len</a>);</div>
<div class="ttc" id="aaws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_html_a0f1e4ab31fd4f3ca4329091911f1f1af"><div class="ttname"><a href="aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h.html#a0f1e4ab31fd4f3ca4329091911f1f1af">len</a></div><div class="ttdeci">char const int len</div><div class="ttdef"><b>Definition:</b> cJSON.h:169</div></div>
</div><!-- fragment --><p >These callbacks take as input a context containing anything needed in the function (for example, a file descriptor), the buffer holding data to be sent or received, and the length of the buffer. The <b>io_context</b> passed to the callbacks may be set separately using <b>s2n_connection_set_recv_ctx</b> and <b>s2n_connection_set_send_ctx</b>.</p>
<p >The callback may send or receive less than the requested length. The function should return the number of bytes sent/received, or set errno and return an error code &lt; 0.</p>
<h3><a class="anchor" id="autotoc_md467"></a>
s2n_shutdown</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#aff6abacafd51a48a2870755d765f56e8">s2n_shutdown</a>(<span class="keyword">struct</span> <a class="code hl_struct" href="structs2n__connection.html">s2n_connection</a> *conn,</div>
<div class="line">                 <a class="code hl_enumeration" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *<a class="code hl_variable" href="https_8c.html#ad4675d5d36c6aef3c5f7eaca1d538053">blocked</a>);</div>
<div class="ttc" id="as2n_8h_html_aff6abacafd51a48a2870755d765f56e8"><div class="ttname"><a href="s2n_8h.html#aff6abacafd51a48a2870755d765f56e8">s2n_shutdown</a></div><div class="ttdeci">S2N_API int s2n_shutdown(struct s2n_connection *conn, s2n_blocked_status *blocked)</div><div class="ttdef"><b>Definition:</b> s2n_shutdown.c:24</div></div>
</div><!-- fragment --><p ><b>s2n_shutdown</b> attempts a closure at the TLS layer. It does not close the underlying transport. The call may block in either direction. Unlike other TLS implementations, <b>s2n_shutdown</b> attempts a graceful shutdown by default. It will not return with success unless a close_notify alert is successfully sent and received. As a result, <b>s2n_shutdown</b> may fail when interacting with a non-conformant TLS implementation. Once <b>s2n_shutdown</b> is complete:</p><ul>
<li>The <a class="el" href="structs2n__connection.html">s2n_connection</a> handle cannot be used for reading for writing.</li>
<li>The underlying transport can be closed. Most likely via <code><a class="el" href="new__destroy_8c.html#a6cc331334d030ff39790e12d10ef25c1">close()</a></code>.</li>
<li>The <a class="el" href="structs2n__connection.html">s2n_connection</a> handle can be freed via <a href="#s2n\_connection\_free">s2n_connection_free</a> or reused via <a href="#s2n\_connection\_wipe">s2n_connection_wipe</a></li>
</ul>
<h3><a class="anchor" id="autotoc_md468"></a>
s2n_mem_set_callbacks</h3>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> int (*<a class="code hl_typedef" href="s2n_8h.html#a71033bff0e129f910b87d5fb41798519">s2n_mem_init_callback</a>)(void);</div>
<div class="line"><span class="keyword">typedef</span> int (*<a class="code hl_typedef" href="s2n_8h.html#ae5f75394a380a2764b189ca6662133ba">s2n_mem_cleanup_callback</a>)(void);</div>
<div class="line"><span class="keyword">typedef</span> int (*<a class="code hl_typedef" href="s2n_8h.html#a8ea7d341ee2969dd1d083fafe13a5d43">s2n_mem_malloc_callback</a>)(<span class="keywordtype">void</span> **ptr, uint32_t requested, uint32_t *allocated);</div>
<div class="line"><span class="keyword">typedef</span> int (*<a class="code hl_typedef" href="s2n_8h.html#a6e4014627f6981bc4e533781d29903d5">s2n_mem_free_callback</a>)(<span class="keywordtype">void</span> *ptr, uint32_t size);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="s2n_8h.html#a664b222a36088c06c4580653971f03a5">s2n_mem_set_callbacks</a>(<a class="code hl_typedef" href="s2n_8h.html#a71033bff0e129f910b87d5fb41798519">s2n_mem_init_callback</a> mem_init_callback, <a class="code hl_typedef" href="s2n_8h.html#ae5f75394a380a2764b189ca6662133ba">s2n_mem_cleanup_callback</a> mem_cleanup_callback, <a class="code hl_typedef" href="s2n_8h.html#a8ea7d341ee2969dd1d083fafe13a5d43">s2n_mem_malloc_callback</a> mem_malloc_callback, <a class="code hl_typedef" href="s2n_8h.html#a6e4014627f6981bc4e533781d29903d5">s2n_mem_free_callback</a> mem_free_callback);</div>
<div class="ttc" id="as2n_8h_html_a664b222a36088c06c4580653971f03a5"><div class="ttname"><a href="s2n_8h.html#a664b222a36088c06c4580653971f03a5">s2n_mem_set_callbacks</a></div><div class="ttdeci">S2N_API int s2n_mem_set_callbacks(s2n_mem_init_callback mem_init_callback, s2n_mem_cleanup_callback mem_cleanup_callback, s2n_mem_malloc_callback mem_malloc_callback, s2n_mem_free_callback mem_free_callback)</div></div>
<div class="ttc" id="as2n_8h_html_a6e4014627f6981bc4e533781d29903d5"><div class="ttname"><a href="s2n_8h.html#a6e4014627f6981bc4e533781d29903d5">s2n_mem_free_callback</a></div><div class="ttdeci">int(* s2n_mem_free_callback)(void *ptr, uint32_t size)</div><div class="ttdef"><b>Definition:</b> s2n.h:127</div></div>
<div class="ttc" id="as2n_8h_html_a71033bff0e129f910b87d5fb41798519"><div class="ttname"><a href="s2n_8h.html#a71033bff0e129f910b87d5fb41798519">s2n_mem_init_callback</a></div><div class="ttdeci">int(* s2n_mem_init_callback)(void)</div><div class="ttdef"><b>Definition:</b> s2n.h:124</div></div>
<div class="ttc" id="as2n_8h_html_a8ea7d341ee2969dd1d083fafe13a5d43"><div class="ttname"><a href="s2n_8h.html#a8ea7d341ee2969dd1d083fafe13a5d43">s2n_mem_malloc_callback</a></div><div class="ttdeci">int(* s2n_mem_malloc_callback)(void **ptr, uint32_t requested, uint32_t *allocated)</div><div class="ttdef"><b>Definition:</b> s2n.h:126</div></div>
<div class="ttc" id="as2n_8h_html_ae5f75394a380a2764b189ca6662133ba"><div class="ttname"><a href="s2n_8h.html#ae5f75394a380a2764b189ca6662133ba">s2n_mem_cleanup_callback</a></div><div class="ttdeci">int(* s2n_mem_cleanup_callback)(void)</div><div class="ttdef"><b>Definition:</b> s2n.h:125</div></div>
</div><!-- fragment --><p ><b>s2n_mem_set_callbacks</b> allows the caller to over-ride s2n's internal memory handling functions. To work correctly, <b>s2n_mem_set_callbacks</b> must be called before <b>s2n_init</b>. <b>s2n_mem_init_callback</b> should be a function that will be called when s2n is initialized. <b>s2n_mem_cleanup_callback</b> will be called when <b>s2n_cleanup</b> is executed. <b>s2n_mem_malloc_callback</b> should be a function that can allocate at least <b>requested</b> bytes of memory and store the location of that memory in ***ptr**, and the size of the allocated data in ***allocated**. The function may choose to allocate more memory than was requested. s2n will consider all allocated memory available for use, and will attempt to free all allocated memory when able. <b>s2n_mem_free_callback</b> should be a function that can free memory.</p>
<h1><a class="anchor" id="autotoc_md469"></a>
Examples</h1>
<p >To understand the API it may be easiest to see examples in action. s2n's <a href="https://github.com/awslabs/s2n/blob/main/bin/">bin/</a> directory includes an example client (s2nc) and server (s2nd). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
