\hypertarget{s2n__nist__kats_8h_source}{}\doxysection{s2n\+\_\+nist\+\_\+kats.\+h}
\label{s2n__nist__kats_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/tests/testlib/s2n\_nist\_kats.h@{crt/aws-\/crt-\/cpp/crt/s2n/tests/testlib/s2n\_nist\_kats.h}}
\mbox{\hyperlink{s2n__nist__kats_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ *}}
\DoxyCodeLine{15 \textcolor{comment}{ * Modified from PQCgenKAT\_kem.c}}
\DoxyCodeLine{16 \textcolor{comment}{ * Created by Bassham, Lawrence E (Fed) on 8/29/17.}}
\DoxyCodeLine{17 \textcolor{comment}{ * Copyright Â© 2017 Bassham, Lawrence E (Fed). All rights reserved.}}
\DoxyCodeLine{18 \textcolor{comment}{ */}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{string_8h}{string.h}}>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <ctype.h>}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#define MAX\_MARKER\_LEN 50}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define NUM\_OF\_KATS 100}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{comment}{/*}}
\DoxyCodeLine{30 \textcolor{comment}{ * ALLOW TO READ HEXADECIMAL ENTRY (KEYS, DATA, TEXT, etc.)}}
\DoxyCodeLine{31 \textcolor{comment}{ */}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__nist__kats_8h_af25f838f0f81ff12fb251ccb338e157a}{FindMarker}}(FILE *infile, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *marker)}
\DoxyCodeLine{34 \{}
\DoxyCodeLine{35     int8\_t \mbox{\hyperlink{namespacefixup__makefiles_a5e26abe70faebb0ef1e8af214967f145}{line}}[\mbox{\hyperlink{s2n__nist__kats_8h_af36bcb714e40adef7826d841bde52c26}{MAX\_MARKER\_LEN}}];}
\DoxyCodeLine{36     uint32\_t i, \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}};}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}} = (int)strlen(marker);}
\DoxyCodeLine{39     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}} > (\mbox{\hyperlink{s2n__nist__kats_8h_af36bcb714e40adef7826d841bde52c26}{MAX\_MARKER\_LEN}} -\/ 1) ) \{}
\DoxyCodeLine{40         \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}} = \mbox{\hyperlink{s2n__nist__kats_8h_af36bcb714e40adef7826d841bde52c26}{MAX\_MARKER\_LEN}}-\/1;}
\DoxyCodeLine{41     \}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43     \textcolor{keywordflow}{for} ( i=0; i<\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}; i++ ) \{}
\DoxyCodeLine{44         \textcolor{keywordflow}{if} ( (\mbox{\hyperlink{namespacefixup__makefiles_a5e26abe70faebb0ef1e8af214967f145}{line}}[i] = fgetc(infile)) == EOF ) \{}
\DoxyCodeLine{45             \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{46         \}}
\DoxyCodeLine{47     \}}
\DoxyCodeLine{48     \mbox{\hyperlink{namespacefixup__makefiles_a5e26abe70faebb0ef1e8af214967f145}{line}}[\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{keywordflow}{while} ( 1 ) \{}
\DoxyCodeLine{51         \textcolor{keywordflow}{if} ( !strncmp((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{namespacefixup__makefiles_a5e26abe70faebb0ef1e8af214967f145}{line}}, marker, \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}) ) \{}
\DoxyCodeLine{52             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{53         \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55         \textcolor{keywordflow}{for} ( i=0; i<\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}-\/1; i++ ) \{}
\DoxyCodeLine{56             \mbox{\hyperlink{namespacefixup__makefiles_a5e26abe70faebb0ef1e8af214967f145}{line}}[i] = \mbox{\hyperlink{namespacefixup__makefiles_a5e26abe70faebb0ef1e8af214967f145}{line}}[i+1];}
\DoxyCodeLine{57         \}}
\DoxyCodeLine{58         \textcolor{keywordflow}{if} ( (\mbox{\hyperlink{namespacefixup__makefiles_a5e26abe70faebb0ef1e8af214967f145}{line}}[\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}-\/1] = fgetc(infile)) == EOF ) \{}
\DoxyCodeLine{59             \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{60         \}}
\DoxyCodeLine{61         \mbox{\hyperlink{namespacefixup__makefiles_a5e26abe70faebb0ef1e8af214967f145}{line}}[\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{62     \}}
\DoxyCodeLine{63 \}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{comment}{/*}}
\DoxyCodeLine{66 \textcolor{comment}{ * ALLOW TO READ HEXADECIMAL ENTRY (KEYS, DATA, TEXT, etc.)}}
\DoxyCodeLine{67 \textcolor{comment}{ */}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__nist__kats_8h_ad07bcb89911016c69a1279a25ed8f181}{ReadHex}}(FILE *infile, uint8\_t *\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}, uint32\_t \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\mbox{\hyperlink{namespacecreate-projects_a6690bd467c6241951130aa0bf17e373d}{str}})}
\DoxyCodeLine{70 \{}
\DoxyCodeLine{71     \textcolor{keywordtype}{int} ch;}
\DoxyCodeLine{72     \textcolor{keywordtype}{int} started = 0;}
\DoxyCodeLine{73     uint8\_t ich;}
\DoxyCodeLine{74 }
\DoxyCodeLine{75     \textcolor{keywordflow}{if} (0 == \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}) }
\DoxyCodeLine{76     \{}
\DoxyCodeLine{77         \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}[0] = 0x00;}
\DoxyCodeLine{78         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{79     \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \mbox{\hyperlink{memset__override_8c_ace6ee45c30e71865e6eb635200379db9}{memset}}(\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}, 0x00, \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}});}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     \textcolor{keywordflow}{if} (\mbox{\hyperlink{s2n__nist__kats_8h_af25f838f0f81ff12fb251ccb338e157a}{FindMarker}}(infile, \mbox{\hyperlink{namespacecreate-projects_a6690bd467c6241951130aa0bf17e373d}{str}}) == -\/1)}
\DoxyCodeLine{84     \{}
\DoxyCodeLine{85         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{86     \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88     \textcolor{keywordflow}{while} ((ch = fgetc(infile)) != EOF) }
\DoxyCodeLine{89     \{}
\DoxyCodeLine{90         \textcolor{keywordflow}{if} (!isxdigit(ch)) \{}
\DoxyCodeLine{91             \textcolor{keywordflow}{if} (!started) \{}
\DoxyCodeLine{92                 \textcolor{keywordflow}{if} (ch == \textcolor{charliteral}{'\(\backslash\)n'})}
\DoxyCodeLine{93                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{94                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{95                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{96             \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{97                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{98         \}}
\DoxyCodeLine{99         started = 1;}
\DoxyCodeLine{100 }
\DoxyCodeLine{101         \textcolor{keywordflow}{if} ((ch >= \textcolor{charliteral}{'0'}) \&\& (ch <= \textcolor{charliteral}{'9'})) \{}
\DoxyCodeLine{102             ich = ch -\/ \textcolor{charliteral}{'0'};}
\DoxyCodeLine{103         \}}
\DoxyCodeLine{104         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((ch >= \textcolor{charliteral}{'A'}) \&\& (ch <= \textcolor{charliteral}{'F'})) \{}
\DoxyCodeLine{105             ich = ch -\/ \textcolor{charliteral}{'A'} + 10;}
\DoxyCodeLine{106         \}}
\DoxyCodeLine{107         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((ch >= \textcolor{charliteral}{'a'}) \&\& (ch <= \textcolor{charliteral}{'f'})) \{}
\DoxyCodeLine{108             ich = ch -\/ \textcolor{charliteral}{'a'} + 10;}
\DoxyCodeLine{109         \}}
\DoxyCodeLine{110         \textcolor{keywordflow}{else} }
\DoxyCodeLine{111         \{}
\DoxyCodeLine{112             \textcolor{comment}{/* shouldn't ever get here */}}
\DoxyCodeLine{113             ich = 0;}
\DoxyCodeLine{114         \}}
\DoxyCodeLine{115 }
\DoxyCodeLine{116         \textcolor{keywordflow}{for} (uint32\_t i = 0; i < \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}} -\/ 1; i++)}
\DoxyCodeLine{117         \{}
\DoxyCodeLine{118             \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}[i] = (\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}[i] << 4) | (\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}[i + 1] >> 4);}
\DoxyCodeLine{119         \}}
\DoxyCodeLine{120         \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}[\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}} -\/ 1] = (\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}[\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}} -\/ 1] << 4) | ich;}
\DoxyCodeLine{121     \}}
\DoxyCodeLine{122  }
\DoxyCodeLine{123     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{124 \}}
\DoxyCodeLine{125 }

\end{DoxyCode}
