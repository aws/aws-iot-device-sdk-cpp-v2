\hypertarget{s2n__client__key__share_8c}{}\doxysection{crt/aws-\/crt-\/cpp/crt/s2n/tls/extensions/s2n\+\_\+client\+\_\+key\+\_\+share.c File Reference}
\label{s2n__client__key__share_8c}\index{crt/aws-\/crt-\/cpp/crt/s2n/tls/extensions/s2n\_client\_key\_share.c@{crt/aws-\/crt-\/cpp/crt/s2n/tls/extensions/s2n\_client\_key\_share.c}}
{\ttfamily \#include \char`\"{}tls/extensions/s2n\+\_\+client\+\_\+key\+\_\+share.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls/extensions/s2n\+\_\+key\+\_\+share.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+security\+\_\+policies.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+kem\+\_\+preferences.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}error/s2n\+\_\+errno.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+safety.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+tls13.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+fips.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{s2n__client__key__share_8c_a533d603c65fb35bde4cd332aa0988064}{S2\+N\+\_\+\+IS\+\_\+\+KEY\+\_\+\+SHARE\+\_\+\+LIST\+\_\+\+EMPTY}}(preferred\+\_\+key\+\_\+shares)~(preferred\+\_\+key\+\_\+shares \& 1)
\item 
\#define \mbox{\hyperlink{s2n__client__key__share_8c_a61beb7e266f4bc9b7cabb7dd26485550}{S2\+N\+\_\+\+IS\+\_\+\+KEY\+\_\+\+SHARE\+\_\+\+REQUESTED}}(preferred\+\_\+key\+\_\+shares,  i)~((preferred\+\_\+key\+\_\+shares $>$$>$ (i + 1)) \& 1)
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_a838e161af0e289a1c1ab186c3a66bff9}{s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+send}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_ad2e1297a0ca851f7ddafabb59d10db0b}{s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+recv}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$extension)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_ae0ff1dd0c9de095dc808a00d319071f0}{s2n\+\_\+generate\+\_\+preferred\+\_\+ecc\+\_\+key\+\_\+shares}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_ab8f28d3feba20ad89daab950d221492e}{s2n\+\_\+generate\+\_\+default\+\_\+ecc\+\_\+key\+\_\+share}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_a9c2574ef2f91a434c39060f63c996b52}{s2n\+\_\+generate\+\_\+pq\+\_\+hybrid\+\_\+key\+\_\+share}} (struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out, struct \mbox{\hyperlink{structs2n__kem__group__params}{s2n\+\_\+kem\+\_\+group\+\_\+params}} $\ast$kem\+\_\+group\+\_\+params)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_ae1989076b6c77bfbcb85bb81fa6d74eb}{s2n\+\_\+generate\+\_\+default\+\_\+pq\+\_\+hybrid\+\_\+key\+\_\+share}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_aafe147025af280ccea9081b1748dafec}{s2n\+\_\+wipe\+\_\+all\+\_\+client\+\_\+keyshares}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_a2c42d3040ba29d67f0f5ec695c336360}{s2n\+\_\+send\+\_\+hrr\+\_\+ecc\+\_\+keyshare}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_a9a6d345d8bad2593998170fd056e19ee}{s2n\+\_\+send\+\_\+hrr\+\_\+pq\+\_\+hybrid\+\_\+keyshare}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_ad280f0434f6597985ac44e6b3303272d}{s2n\+\_\+send\+\_\+hrr\+\_\+keyshare}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_a8f33c43df78e6b47b51fd1b71130ad8b}{s2n\+\_\+ecdhe\+\_\+supported\+\_\+curves\+\_\+send}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_a24d67ac88e0b485e9c66de1385d089c3}{s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+parse\+\_\+ecc}} (struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$key\+\_\+share, const struct \mbox{\hyperlink{structs2n__ecc__named__curve}{s2n\+\_\+ecc\+\_\+named\+\_\+curve}} $\ast$curve, struct \mbox{\hyperlink{structs2n__ecc__evp__params}{s2n\+\_\+ecc\+\_\+evp\+\_\+params}} $\ast$ecc\+\_\+params)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_ab6c961b0f97623e507f2bdeb638cffe7}{s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+recv\+\_\+ecc}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$key\+\_\+share, uint16\+\_\+t curve\+\_\+iana\+\_\+id, \mbox{\hyperlink{preamble_8h_a1062901a7428fdd9c7f180f5e01ea056}{bool}} $\ast$match)
\item 
static int \mbox{\hyperlink{s2n__client__key__share_8c_ad68688414de149c28b088e749e61235e}{s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+recv\+\_\+pq\+\_\+hybrid}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$key\+\_\+share, uint16\+\_\+t kem\+\_\+group\+\_\+iana\+\_\+id, \mbox{\hyperlink{preamble_8h_a1062901a7428fdd9c7f180f5e01ea056}{bool}} $\ast$match)
\item 
uint32\+\_\+t \mbox{\hyperlink{s2n__client__key__share_8c_adccdb2e464175aa89180945dab93771f}{s2n\+\_\+extensions\+\_\+client\+\_\+key\+\_\+share\+\_\+size}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn)
\item 
int \mbox{\hyperlink{s2n__client__key__share_8c_ae86a4b750f527b5d995f088bb8743dd8}{s2n\+\_\+extensions\+\_\+client\+\_\+key\+\_\+share\+\_\+send}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$out)
\item 
int \mbox{\hyperlink{s2n__client__key__share_8c_a96334b98e910973ecf2c3c48633173b5}{s2n\+\_\+extensions\+\_\+client\+\_\+key\+\_\+share\+\_\+recv}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$extension)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \mbox{\hyperlink{structs2n__extension__type}{s2n\+\_\+extension\+\_\+type}} \mbox{\hyperlink{s2n__client__key__share_8c_a27d36eaf80448d814f5036299032fd42}{s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+extension}}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{s2n__client__key__share_8c_a533d603c65fb35bde4cd332aa0988064}\label{s2n__client__key__share_8c_a533d603c65fb35bde4cd332aa0988064}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!S2N\_IS\_KEY\_SHARE\_LIST\_EMPTY@{S2N\_IS\_KEY\_SHARE\_LIST\_EMPTY}}
\index{S2N\_IS\_KEY\_SHARE\_LIST\_EMPTY@{S2N\_IS\_KEY\_SHARE\_LIST\_EMPTY}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{S2N\_IS\_KEY\_SHARE\_LIST\_EMPTY}{S2N\_IS\_KEY\_SHARE\_LIST\_EMPTY}}
{\footnotesize\ttfamily \#define S2\+N\+\_\+\+IS\+\_\+\+KEY\+\_\+\+SHARE\+\_\+\+LIST\+\_\+\+EMPTY(\begin{DoxyParamCaption}\item[{}]{preferred\+\_\+key\+\_\+shares }\end{DoxyParamCaption})~(preferred\+\_\+key\+\_\+shares \& 1)}

\mbox{\Hypertarget{s2n__client__key__share_8c_a61beb7e266f4bc9b7cabb7dd26485550}\label{s2n__client__key__share_8c_a61beb7e266f4bc9b7cabb7dd26485550}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!S2N\_IS\_KEY\_SHARE\_REQUESTED@{S2N\_IS\_KEY\_SHARE\_REQUESTED}}
\index{S2N\_IS\_KEY\_SHARE\_REQUESTED@{S2N\_IS\_KEY\_SHARE\_REQUESTED}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{S2N\_IS\_KEY\_SHARE\_REQUESTED}{S2N\_IS\_KEY\_SHARE\_REQUESTED}}
{\footnotesize\ttfamily \#define S2\+N\+\_\+\+IS\+\_\+\+KEY\+\_\+\+SHARE\+\_\+\+REQUESTED(\begin{DoxyParamCaption}\item[{}]{preferred\+\_\+key\+\_\+shares,  }\item[{}]{i }\end{DoxyParamCaption})~((preferred\+\_\+key\+\_\+shares $>$$>$ (i + 1)) \& 1)}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{s2n__client__key__share_8c_a24d67ac88e0b485e9c66de1385d089c3}\label{s2n__client__key__share_8c_a24d67ac88e0b485e9c66de1385d089c3}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_client\_key\_share\_parse\_ecc@{s2n\_client\_key\_share\_parse\_ecc}}
\index{s2n\_client\_key\_share\_parse\_ecc@{s2n\_client\_key\_share\_parse\_ecc}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_client\_key\_share\_parse\_ecc()}{s2n\_client\_key\_share\_parse\_ecc()}}
{\footnotesize\ttfamily static int s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+parse\+\_\+ecc (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{key\+\_\+share,  }\item[{const struct \mbox{\hyperlink{structs2n__ecc__named__curve}{s2n\+\_\+ecc\+\_\+named\+\_\+curve}} $\ast$}]{curve,  }\item[{struct \mbox{\hyperlink{structs2n__ecc__evp__params}{s2n\+\_\+ecc\+\_\+evp\+\_\+params}} $\ast$}]{ecc\+\_\+params }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_ad2e1297a0ca851f7ddafabb59d10db0b}\label{s2n__client__key__share_8c_ad2e1297a0ca851f7ddafabb59d10db0b}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_client\_key\_share\_recv@{s2n\_client\_key\_share\_recv}}
\index{s2n\_client\_key\_share\_recv@{s2n\_client\_key\_share\_recv}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_client\_key\_share\_recv()}{s2n\_client\_key\_share\_recv()}}
{\footnotesize\ttfamily static int s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+recv (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{extension }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_ab6c961b0f97623e507f2bdeb638cffe7}\label{s2n__client__key__share_8c_ab6c961b0f97623e507f2bdeb638cffe7}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_client\_key\_share\_recv\_ecc@{s2n\_client\_key\_share\_recv\_ecc}}
\index{s2n\_client\_key\_share\_recv\_ecc@{s2n\_client\_key\_share\_recv\_ecc}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_client\_key\_share\_recv\_ecc()}{s2n\_client\_key\_share\_recv\_ecc()}}
{\footnotesize\ttfamily static int s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+recv\+\_\+ecc (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{key\+\_\+share,  }\item[{uint16\+\_\+t}]{curve\+\_\+iana\+\_\+id,  }\item[{\mbox{\hyperlink{preamble_8h_a1062901a7428fdd9c7f180f5e01ea056}{bool}} $\ast$}]{match }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_ad68688414de149c28b088e749e61235e}\label{s2n__client__key__share_8c_ad68688414de149c28b088e749e61235e}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_client\_key\_share\_recv\_pq\_hybrid@{s2n\_client\_key\_share\_recv\_pq\_hybrid}}
\index{s2n\_client\_key\_share\_recv\_pq\_hybrid@{s2n\_client\_key\_share\_recv\_pq\_hybrid}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_client\_key\_share\_recv\_pq\_hybrid()}{s2n\_client\_key\_share\_recv\_pq\_hybrid()}}
{\footnotesize\ttfamily static int s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+recv\+\_\+pq\+\_\+hybrid (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{key\+\_\+share,  }\item[{uint16\+\_\+t}]{kem\+\_\+group\+\_\+iana\+\_\+id,  }\item[{\mbox{\hyperlink{preamble_8h_a1062901a7428fdd9c7f180f5e01ea056}{bool}} $\ast$}]{match }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_a838e161af0e289a1c1ab186c3a66bff9}\label{s2n__client__key__share_8c_a838e161af0e289a1c1ab186c3a66bff9}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_client\_key\_share\_send@{s2n\_client\_key\_share\_send}}
\index{s2n\_client\_key\_share\_send@{s2n\_client\_key\_share\_send}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_client\_key\_share\_send()}{s2n\_client\_key\_share\_send()}}
{\footnotesize\ttfamily static int s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+send (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Specified in \href{https://tools.ietf.org/html/rfc8446\#section-4.2.8}{\texttt{ https\+://tools.\+ietf.\+org/html/rfc8446\#section-\/4.\+2.\+8}} \char`\"{}\+The \char`\"{}key\+\_\+share\char`\"{} extension contains the endpoint\textquotesingle{}s cryptographic parameters.\char`\"{}

Structure\+: Extension type (2 bytes) Extension data size (2 bytes) Client shares size (2 bytes) Client shares\+: Named group (2 bytes) Key share size (2 bytes) Key share (variable size)

This extension only modifies the connection\textquotesingle{}s client ecc\+\_\+evp\+\_\+params. It does not make any decisions about which set of params to use.

The server will NOT alert when processing a client extension that violates the RFC. So the server will accept\+:
\begin{DoxyItemize}
\item Multiple key shares for the same named group. The server will accept the first key share for the group and ignore any duplicates.
\item Key shares for named groups not in the client\textquotesingle{}s supported\+\_\+groups extension. 
\end{DoxyItemize}\mbox{\Hypertarget{s2n__client__key__share_8c_a8f33c43df78e6b47b51fd1b71130ad8b}\label{s2n__client__key__share_8c_a8f33c43df78e6b47b51fd1b71130ad8b}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_ecdhe\_supported\_curves\_send@{s2n\_ecdhe\_supported\_curves\_send}}
\index{s2n\_ecdhe\_supported\_curves\_send@{s2n\_ecdhe\_supported\_curves\_send}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_ecdhe\_supported\_curves\_send()}{s2n\_ecdhe\_supported\_curves\_send()}}
{\footnotesize\ttfamily static int s2n\+\_\+ecdhe\+\_\+supported\+\_\+curves\+\_\+send (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_a96334b98e910973ecf2c3c48633173b5}\label{s2n__client__key__share_8c_a96334b98e910973ecf2c3c48633173b5}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_extensions\_client\_key\_share\_recv@{s2n\_extensions\_client\_key\_share\_recv}}
\index{s2n\_extensions\_client\_key\_share\_recv@{s2n\_extensions\_client\_key\_share\_recv}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_extensions\_client\_key\_share\_recv()}{s2n\_extensions\_client\_key\_share\_recv()}}
{\footnotesize\ttfamily int s2n\+\_\+extensions\+\_\+client\+\_\+key\+\_\+share\+\_\+recv (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{extension }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__client__key__share_8c_ae86a4b750f527b5d995f088bb8743dd8}\label{s2n__client__key__share_8c_ae86a4b750f527b5d995f088bb8743dd8}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_extensions\_client\_key\_share\_send@{s2n\_extensions\_client\_key\_share\_send}}
\index{s2n\_extensions\_client\_key\_share\_send@{s2n\_extensions\_client\_key\_share\_send}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_extensions\_client\_key\_share\_send()}{s2n\_extensions\_client\_key\_share\_send()}}
{\footnotesize\ttfamily int s2n\+\_\+extensions\+\_\+client\+\_\+key\+\_\+share\+\_\+send (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__client__key__share_8c_adccdb2e464175aa89180945dab93771f}\label{s2n__client__key__share_8c_adccdb2e464175aa89180945dab93771f}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_extensions\_client\_key\_share\_size@{s2n\_extensions\_client\_key\_share\_size}}
\index{s2n\_extensions\_client\_key\_share\_size@{s2n\_extensions\_client\_key\_share\_size}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_extensions\_client\_key\_share\_size()}{s2n\_extensions\_client\_key\_share\_size()}}
{\footnotesize\ttfamily uint32\+\_\+t s2n\+\_\+extensions\+\_\+client\+\_\+key\+\_\+share\+\_\+size (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__client__key__share_8c_ab8f28d3feba20ad89daab950d221492e}\label{s2n__client__key__share_8c_ab8f28d3feba20ad89daab950d221492e}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_generate\_default\_ecc\_key\_share@{s2n\_generate\_default\_ecc\_key\_share}}
\index{s2n\_generate\_default\_ecc\_key\_share@{s2n\_generate\_default\_ecc\_key\_share}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_generate\_default\_ecc\_key\_share()}{s2n\_generate\_default\_ecc\_key\_share()}}
{\footnotesize\ttfamily static int s2n\+\_\+generate\+\_\+default\+\_\+ecc\+\_\+key\+\_\+share (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_ae1989076b6c77bfbcb85bb81fa6d74eb}\label{s2n__client__key__share_8c_ae1989076b6c77bfbcb85bb81fa6d74eb}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_generate\_default\_pq\_hybrid\_key\_share@{s2n\_generate\_default\_pq\_hybrid\_key\_share}}
\index{s2n\_generate\_default\_pq\_hybrid\_key\_share@{s2n\_generate\_default\_pq\_hybrid\_key\_share}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_generate\_default\_pq\_hybrid\_key\_share()}{s2n\_generate\_default\_pq\_hybrid\_key\_share()}}
{\footnotesize\ttfamily static int s2n\+\_\+generate\+\_\+default\+\_\+pq\+\_\+hybrid\+\_\+key\+\_\+share (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_a9c2574ef2f91a434c39060f63c996b52}\label{s2n__client__key__share_8c_a9c2574ef2f91a434c39060f63c996b52}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_generate\_pq\_hybrid\_key\_share@{s2n\_generate\_pq\_hybrid\_key\_share}}
\index{s2n\_generate\_pq\_hybrid\_key\_share@{s2n\_generate\_pq\_hybrid\_key\_share}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_generate\_pq\_hybrid\_key\_share()}{s2n\_generate\_pq\_hybrid\_key\_share()}}
{\footnotesize\ttfamily static int s2n\+\_\+generate\+\_\+pq\+\_\+hybrid\+\_\+key\+\_\+share (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out,  }\item[{struct \mbox{\hyperlink{structs2n__kem__group__params}{s2n\+\_\+kem\+\_\+group\+\_\+params}} $\ast$}]{kem\+\_\+group\+\_\+params }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_ae0ff1dd0c9de095dc808a00d319071f0}\label{s2n__client__key__share_8c_ae0ff1dd0c9de095dc808a00d319071f0}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_generate\_preferred\_ecc\_key\_shares@{s2n\_generate\_preferred\_ecc\_key\_shares}}
\index{s2n\_generate\_preferred\_ecc\_key\_shares@{s2n\_generate\_preferred\_ecc\_key\_shares}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_generate\_preferred\_ecc\_key\_shares()}{s2n\_generate\_preferred\_ecc\_key\_shares()}}
{\footnotesize\ttfamily static int s2n\+\_\+generate\+\_\+preferred\+\_\+ecc\+\_\+key\+\_\+shares (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_a2c42d3040ba29d67f0f5ec695c336360}\label{s2n__client__key__share_8c_a2c42d3040ba29d67f0f5ec695c336360}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_send\_hrr\_ecc\_keyshare@{s2n\_send\_hrr\_ecc\_keyshare}}
\index{s2n\_send\_hrr\_ecc\_keyshare@{s2n\_send\_hrr\_ecc\_keyshare}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_send\_hrr\_ecc\_keyshare()}{s2n\_send\_hrr\_ecc\_keyshare()}}
{\footnotesize\ttfamily static int s2n\+\_\+send\+\_\+hrr\+\_\+ecc\+\_\+keyshare (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_ad280f0434f6597985ac44e6b3303272d}\label{s2n__client__key__share_8c_ad280f0434f6597985ac44e6b3303272d}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_send\_hrr\_keyshare@{s2n\_send\_hrr\_keyshare}}
\index{s2n\_send\_hrr\_keyshare@{s2n\_send\_hrr\_keyshare}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_send\_hrr\_keyshare()}{s2n\_send\_hrr\_keyshare()}}
{\footnotesize\ttfamily static int s2n\+\_\+send\+\_\+hrr\+\_\+keyshare (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_a9a6d345d8bad2593998170fd056e19ee}\label{s2n__client__key__share_8c_a9a6d345d8bad2593998170fd056e19ee}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_send\_hrr\_pq\_hybrid\_keyshare@{s2n\_send\_hrr\_pq\_hybrid\_keyshare}}
\index{s2n\_send\_hrr\_pq\_hybrid\_keyshare@{s2n\_send\_hrr\_pq\_hybrid\_keyshare}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_send\_hrr\_pq\_hybrid\_keyshare()}{s2n\_send\_hrr\_pq\_hybrid\_keyshare()}}
{\footnotesize\ttfamily static int s2n\+\_\+send\+\_\+hrr\+\_\+pq\+\_\+hybrid\+\_\+keyshare (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{struct \mbox{\hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer}} $\ast$}]{out }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__client__key__share_8c_aafe147025af280ccea9081b1748dafec}\label{s2n__client__key__share_8c_aafe147025af280ccea9081b1748dafec}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_wipe\_all\_client\_keyshares@{s2n\_wipe\_all\_client\_keyshares}}
\index{s2n\_wipe\_all\_client\_keyshares@{s2n\_wipe\_all\_client\_keyshares}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_wipe\_all\_client\_keyshares()}{s2n\_wipe\_all\_client\_keyshares()}}
{\footnotesize\ttfamily static int s2n\+\_\+wipe\+\_\+all\+\_\+client\+\_\+keyshares (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{s2n__client__key__share_8c_a27d36eaf80448d814f5036299032fd42}\label{s2n__client__key__share_8c_a27d36eaf80448d814f5036299032fd42}} 
\index{s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}!s2n\_client\_key\_share\_extension@{s2n\_client\_key\_share\_extension}}
\index{s2n\_client\_key\_share\_extension@{s2n\_client\_key\_share\_extension}!s2n\_client\_key\_share.c@{s2n\_client\_key\_share.c}}
\doxysubsubsection{\texorpdfstring{s2n\_client\_key\_share\_extension}{s2n\_client\_key\_share\_extension}}
{\footnotesize\ttfamily const \mbox{\hyperlink{structs2n__extension__type}{s2n\+\_\+extension\+\_\+type}} s2n\+\_\+client\+\_\+key\+\_\+share\+\_\+extension}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    .iana\_value = \mbox{\hyperlink{s2n__tls__parameters_8h_aaeff18b70e2e221fcfca58f4aecc8b83}{TLS\_EXTENSION\_KEY\_SHARE}},}
\DoxyCodeLine{    .is\_response = \textcolor{keyword}{false},}
\DoxyCodeLine{    .send = \mbox{\hyperlink{s2n__client__key__share_8c_a838e161af0e289a1c1ab186c3a66bff9}{s2n\_client\_key\_share\_send}},}
\DoxyCodeLine{    .recv = \mbox{\hyperlink{s2n__client__key__share_8c_ad2e1297a0ca851f7ddafabb59d10db0b}{s2n\_client\_key\_share\_recv}},}
\DoxyCodeLine{    .should\_send = \mbox{\hyperlink{s2n__extension__type_8c_aabd95606ea44116bc4a067af049ecbaf}{s2n\_extension\_send\_if\_tls13\_connection}},}
\DoxyCodeLine{    .if\_missing = \mbox{\hyperlink{s2n__extension__type_8c_a732ba945ae582c3a38a17901c599298a}{s2n\_extension\_noop\_if\_missing}},}
\DoxyCodeLine{\}}

\end{DoxyCode}
