\hypertarget{s2n__certificate_8h_source}{}\doxysection{s2n\+\_\+certificate.\+h}
\label{s2n__certificate_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_certificate.h@{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_certificate.h}}
\mbox{\hyperlink{s2n__certificate_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <openssl/x509.h>}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{s2n_8h}{s2n.h}}>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__pkey_8h}{crypto/s2n\_pkey.h}}"{}}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__stuffer_8h}{stuffer/s2n\_stuffer.h}}"{}}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#define S2N\_CERT\_TYPE\_COUNT S2N\_PKEY\_TYPE\_SENTINEL}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cert}{s2n\_cert}} \{}
\DoxyCodeLine{29     \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\_pkey\_type}} \mbox{\hyperlink{structs2n__cert_a76635c5e645badd0b63da120f38920aa}{pkey\_type}};}
\DoxyCodeLine{30     \mbox{\hyperlink{structs2n__pkey}{s2n\_cert\_public\_key}} \mbox{\hyperlink{structs2n__cert_ae64fa232ccfafb69a2cdd22d80103c4e}{public\_key}};}
\DoxyCodeLine{31     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__cert_ab620aadae1d8a7474afbee29f3e802ba}{raw}};}
\DoxyCodeLine{32     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cert}{s2n\_cert}} *\mbox{\hyperlink{structs2n__cert_a4f5a843a2fad2797c28bd5b83249ef2c}{next}};}
\DoxyCodeLine{33 \};}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cert__chain}{s2n\_cert\_chain}} \{}
\DoxyCodeLine{36     uint32\_t \mbox{\hyperlink{structs2n__cert__chain_a37c8a664b81d396d06c1ff1f47cc6133}{chain\_size}};}
\DoxyCodeLine{37     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cert}{s2n\_cert}} *\mbox{\hyperlink{structs2n__cert__chain_acbc3f3d82c7ae145f6580af82c263097}{head}};}
\DoxyCodeLine{38 \};}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} \{}
\DoxyCodeLine{41     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cert__chain}{s2n\_cert\_chain}} *\mbox{\hyperlink{structs2n__cert__chain__and__key_a4e1598baf235bb1decb653c5dfc298bd}{cert\_chain}};}
\DoxyCodeLine{42     \mbox{\hyperlink{structs2n__pkey}{s2n\_cert\_private\_key}} *\mbox{\hyperlink{structs2n__cert__chain__and__key_a2048ea5a4fb6a6d86e34372e4007b8e0}{private\_key}};}
\DoxyCodeLine{43     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__cert__chain__and__key_a675343e82dfabed405124e1955eea9eb}{ocsp\_status}};}
\DoxyCodeLine{44     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__cert__chain__and__key_aba94038668443bbc6e64fadc86f1ecf6}{sct\_list}};}
\DoxyCodeLine{45     \textcolor{comment}{/* DNS type SubjectAlternative names from the leaf certificate to match}}
\DoxyCodeLine{46 \textcolor{comment}{     * with the server\_name extension. We ignore non-\/DNS SANs here since the}}
\DoxyCodeLine{47 \textcolor{comment}{     * server\_name extension only supports DNS.}}
\DoxyCodeLine{48 \textcolor{comment}{     */}}
\DoxyCodeLine{49     \textcolor{keyword}{struct }s2n\_array *\mbox{\hyperlink{structs2n__cert__chain__and__key_a7beaaf55044bdda4fcc21cf1b7eb3f3e}{san\_names}};}
\DoxyCodeLine{50     \textcolor{comment}{/* CommonName values from the leaf certificate's Subject to match with the}}
\DoxyCodeLine{51 \textcolor{comment}{     * server\_name extension. Decoded as UTF8.}}
\DoxyCodeLine{52 \textcolor{comment}{     */}}
\DoxyCodeLine{53     \textcolor{keyword}{struct }s2n\_array *\mbox{\hyperlink{structs2n__cert__chain__and__key_aa387cf9042d86978d6087f8f5433e2dd}{cn\_names}};}
\DoxyCodeLine{54     \textcolor{comment}{/* Application defined data related to this cert. */}}
\DoxyCodeLine{55     \textcolor{keywordtype}{void} *\mbox{\hyperlink{structs2n__cert__chain__and__key_af792f0cd061f07d3931bc4b0df04010b}{context}};}
\DoxyCodeLine{56 \};}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keyword}{struct }\mbox{\hyperlink{structcerts__by__type}{certs\_by\_type}} \{}
\DoxyCodeLine{59     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *\mbox{\hyperlink{structcerts__by__type_a53de650bae397e50b32cb5ed723ba4c5}{certs}}[\mbox{\hyperlink{s2n__certificate_8h_a6268a0db3a04623da9e5767e9792c8b8}{S2N\_CERT\_TYPE\_COUNT}}];}
\DoxyCodeLine{60 \};}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_ae25bb2b20a9fad2dd85cc85c5f595dbb}{s2n\_cert\_chain\_and\_key\_set\_ocsp\_data}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_aac2a6f1aab996a327b37797f9c1209ae}{chain\_and\_key}}, \textcolor{keyword}{const} uint8\_t *data, uint32\_t \mbox{\hyperlink{iocp__event__loop_8c_ae809d5359ac030c60a30a8f0b2294b82}{length}});}
\DoxyCodeLine{63 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_a33988639f56de2ccf38c452fbc2f1dd4}{s2n\_cert\_chain\_and\_key\_set\_sct\_list}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_aac2a6f1aab996a327b37797f9c1209ae}{chain\_and\_key}}, \textcolor{keyword}{const} uint8\_t *data, uint32\_t \mbox{\hyperlink{iocp__event__loop_8c_ae809d5359ac030c60a30a8f0b2294b82}{length}});}
\DoxyCodeLine{64 \textcolor{comment}{/* Exposed for fuzzing */}}
\DoxyCodeLine{65 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_a5b0ab0873ed8870c569e0d88889df8a9}{s2n\_cert\_chain\_and\_key\_load\_cns}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_aac2a6f1aab996a327b37797f9c1209ae}{chain\_and\_key}}, X509 *x509\_cert);}
\DoxyCodeLine{66 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_ab166c8c035064925c5d268bfae68b7a0}{s2n\_cert\_chain\_and\_key\_load\_sans}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_aac2a6f1aab996a327b37797f9c1209ae}{chain\_and\_key}}, X509 *x509\_cert);}
\DoxyCodeLine{67 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_ac70bea2c1fb0ec5b9eb89d87a862a6b5}{s2n\_cert\_chain\_and\_key\_matches\_dns\_name}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_aac2a6f1aab996a327b37797f9c1209ae}{chain\_and\_key}}, \textcolor{keyword}{const} \textcolor{keyword}{struct} s2n\_blob *dns\_name);}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_a880e5ea125570fb3111d1d4f2902aaee}{s2n\_cert\_set\_cert\_type}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert}{s2n\_cert}} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_a847d4509baf1204aa3eef3d8044ad04c}{cert}}, \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\_pkey\_type}} pkey\_type);}
\DoxyCodeLine{70 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_a01660f975960f206d8dc4e65e2ad3608}{s2n\_send\_cert\_chain}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *out, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_aac2a6f1aab996a327b37797f9c1209ae}{chain\_and\_key}});}
\DoxyCodeLine{71 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_a4b74e141c55a41b40f730bfcb5610414}{s2n\_send\_empty\_cert\_chain}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *out);}
\DoxyCodeLine{72 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_aa1ccc750022aeebd8dfd961691520d90}{s2n\_create\_cert\_chain\_from\_stuffer}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain}{s2n\_cert\_chain}} *cert\_chain\_out, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *chain\_in\_stuffer);}
\DoxyCodeLine{73 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_ac4e5a38a04876468e06591386c42054a}{s2n\_cert\_chain\_and\_key\_set\_cert\_chain}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *cert\_and\_key, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_afe7b0f9b616ebe87d4d14178d9bb5188}{cert\_chain\_pem}});}
\DoxyCodeLine{74 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__certificate_8h_a002a5a747de7319177b3241a6d5bceff}{s2n\_cert\_chain\_and\_key\_set\_private\_key}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *cert\_and\_key, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_a21bdfa791001d9f2f5df9c0d3602a1e1}{private\_key\_pem}});}
\DoxyCodeLine{75 \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\_pkey\_type}} \mbox{\hyperlink{s2n__certificate_8h_a21c06d606a505d5336906180eafac22c}{s2n\_cert\_chain\_and\_key\_get\_pkey\_type}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} *\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_aac2a6f1aab996a327b37797f9c1209ae}{chain\_and\_key}});}

\end{DoxyCode}
