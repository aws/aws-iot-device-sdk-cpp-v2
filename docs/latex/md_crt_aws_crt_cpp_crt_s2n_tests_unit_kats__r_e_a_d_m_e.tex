Known answer tests are used to verify correctness of certain functionality within s2n. The fixed test vectors in the KAT files are compared against calculated values during unit tests. Currently, all KATs are applicable only to post-\/quantum/hybrid functionality.\hypertarget{md_crt_aws_crt_cpp_crt_s2n_tests_unit_kats__r_e_a_d_m_e_autotoc_md605}{}\doxysection{NIST KATs}\label{md_crt_aws_crt_cpp_crt_s2n_tests_unit_kats__r_e_a_d_m_e_autotoc_md605}
KATs of the form {\ttfamily \$\{KEM\}\+\_\+r\$\{N\}.kat} (e.\+g. {\ttfamily sike\+\_\+r2.\+kat}) are provided by NIST as part of their \href{https://csrc.nist.gov/projects/post-quantum-cryptography}{\texttt{ post-\/quantum cryptography standardization effort}}. These KATs are used to verify that the {\ttfamily generate\+\_\+keypair}, {\ttfamily encapsulate}, and {\ttfamily decapsulate} functions for each PQ-\/\+KEM are correct. The {\ttfamily seed} value for each test vector is used as entropy to initialize the DRBG during the unit test so that the test can replicate the deterministic randomness used to generate the {\ttfamily pk}, {\ttfamily sk}, {\ttfamily ct}, and {\ttfamily ss} values. All values are represented as hex-\/encoded strings.

All NIST KATs were generated with a DRBG in AES 256 counter mode, no derivation function, no prediction resistance.\hypertarget{md_crt_aws_crt_cpp_crt_s2n_tests_unit_kats__r_e_a_d_m_e_autotoc_md606}{}\doxysection{Hybrid KATs}\label{md_crt_aws_crt_cpp_crt_s2n_tests_unit_kats__r_e_a_d_m_e_autotoc_md606}
KATs of the form {\ttfamily hybrid\+\_\+echde\+\_\+\$\{KEM\}\+\_\+r\$\{N\}.kat} (e.\+g. {\ttfamily hybrid\+\_\+echde\+\_\+sike\+\_\+r2.\+kat}) are used to verify that client and server are correctly generating, parsing, and processing the server key exchange message, client key exchange message, and master secret for hybrid TLS 1.\+2. The formats of the key exchange messages are given in the \href{https://tools.ietf.org/html/draft-campagna-tls-bike-sike-hybrid}{\texttt{ hybrid TLS 1.\+2 draft spec}}. To summarize, the server key exchange message is the concatenation\+: {\ttfamily Server\+ECDHEParams $\vert$$\vert$ Server\+PQKem\+Params $\vert$$\vert$ Signature} and the client key exchange message is the concatenation\+: {\ttfamily Client\+ECDHEParams $\vert$$\vert$ Client\+PQKem\+Params}. The {\ttfamily expected\+\_\+server\+\_\+key\+\_\+exchange\+\_\+message} and {\ttfamily expected\+\_\+client\+\_\+key\+\_\+exchange\+\_\+message} conform to those formats. The messages were generated by providing the {\ttfamily seed} value as entropy to initialize the DRBG to a known, fixed state, then generating the {\ttfamily expected\+\_\+server\+\_\+key\+\_\+exchange\+\_\+message}, followed by the {\ttfamily expected\+\_\+client\+\_\+key\+\_\+exchange\+\_\+message}. The message are hex-\/encoded bytes, exactly as they would appear over the wire during a TLS 1.\+2 handshake (the {\ttfamily Record Header} and {\ttfamily Handshake Header} bytes are omitted). Additionally, for all KATs\+:
\begin{DoxyItemize}
\item The DRBG was set to AES 256 counter mode, no derivation function ({\ttfamily S2\+N\+\_\+\+AES\+\_\+256\+\_\+\+CTR\+\_\+\+NO\+\_\+\+DF\+\_\+\+PR})
\item The named curve was {\ttfamily secp256r1}
\item The hash algorithm was {\ttfamily SHA384}
\item The signature algorithm was RSA
\end{DoxyItemize}\hypertarget{md_crt_aws_crt_cpp_crt_s2n_tests_unit_kats__r_e_a_d_m_e_autotoc_md607}{}\doxysection{Hybrid PRF KAT}\label{md_crt_aws_crt_cpp_crt_s2n_tests_unit_kats__r_e_a_d_m_e_autotoc_md607}
The {\ttfamily hybrid\+\_\+prf.\+kat} KAT is used to verify correctness of the TLS 1.\+2 hybrid PRF responsible for deriving the master secret. The test vectors were generated from an independent implementation of the hybrid PRF. The values {\ttfamily premaster\+\_\+kem\+\_\+secret\+\_\+length} and {\ttfamily client\+\_\+key\+\_\+exchange\+\_\+message\+\_\+length} must be defined in the KAT file, since they vary based on the PQ-\/\+KEM. The length must be specified as a base 10 integer. The lengths for all other elements do not vary and are defined in the source test files. The values for {\ttfamily premaster\+\_\+classic\+\_\+secret}, {\ttfamily premaster\+\_\+kem\+\_\+secret}, {\ttfamily client\+\_\+random}, {\ttfamily server\+\_\+random}, {\ttfamily client\+\_\+key\+\_\+exchange\+\_\+message}, and {\ttfamily master\+\_\+secret} are represented as hex-\/encoded strings.\hypertarget{md_crt_aws_crt_cpp_crt_s2n_tests_unit_kats__r_e_a_d_m_e_autotoc_md608}{}\doxysection{TLS 1.\+3 Server Hybrid Key Share KAT}\label{md_crt_aws_crt_cpp_crt_s2n_tests_unit_kats__r_e_a_d_m_e_autotoc_md608}
The {\ttfamily tls13\+\_\+server\+\_\+hybrid\+\_\+key\+\_\+share\+\_\+recv.\+kat} KAT is used to verify correctness of the TLS 1.\+3 client functionality for receiving PQ hybrid key shares from the server. The values for {\ttfamily pq\+\_\+private\+\_\+key} and {\ttfamily pq\+\_\+shared\+\_\+secret} were taken from the first entry of the NIST KAT files. The value for {\ttfamily server\+\_\+key\+\_\+share\+\_\+payload} is hex-\/encoded bytes, as they would appear over the wire, of the key shares extension received by the client in the {\ttfamily Server\+Hello} (the first four bytes of a typical key share extension are omitted -\/ the payload begins with the two-\/byte identifier for the named KEM group). 