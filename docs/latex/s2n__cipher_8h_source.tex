\hypertarget{s2n__cipher_8h_source}{}\doxysection{s2n\+\_\+cipher.\+h}
\label{s2n__cipher_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_cipher.h@{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_cipher.h}}
\mbox{\hyperlink{s2n__cipher_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{evp_8h}{openssl/evp.h}}>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <openssl/aes.h>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <openssl/rc4.h>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <openssl/des.h>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{rsa_8h}{openssl/rsa.h}}>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{dh_8h}{openssl/dh.h}}>}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{crypto_2s2n__crypto_8h}{crypto/s2n\_crypto.h}}"{}}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include "{}utils/s2n\_blob.h"{}}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#if defined(OPENSSL\_IS\_BORINGSSL) || defined(OPENSSL\_IS\_AWSLC)}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#define S2N\_CIPHER\_AEAD\_API\_AVAILABLE}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} \{}
\DoxyCodeLine{34     \mbox{\hyperlink{ossl__typ_8h_aab2bd6a044e1d31ebc2fe82b3b0b3d9a}{EVP\_CIPHER\_CTX}} *\mbox{\hyperlink{structs2n__session__key_a0e72ed4f396d84d4bc97ce935689a952}{evp\_cipher\_ctx}};}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#if defined(S2N\_CIPHER\_AEAD\_API\_AVAILABLE)}}
\DoxyCodeLine{36     EVP\_AEAD\_CTX *evp\_aead\_ctx;}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{38 \};}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stream__cipher}{s2n\_stream\_cipher}} \{}
\DoxyCodeLine{41     int (*\mbox{\hyperlink{structs2n__stream__cipher_a0081ca137e5d18a828e630f6aeae4391}{decrypt}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} * key, \textcolor{keyword}{struct }s2n\_blob * in, \textcolor{keyword}{struct }s2n\_blob * out);}
\DoxyCodeLine{42     int (*\mbox{\hyperlink{structs2n__stream__cipher_aeede1ca226c17472d0b28b21be2324d1}{encrypt}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} * key, \textcolor{keyword}{struct }s2n\_blob * in, \textcolor{keyword}{struct }s2n\_blob * out);}
\DoxyCodeLine{43 \};}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cbc__cipher}{s2n\_cbc\_cipher}} \{}
\DoxyCodeLine{46     uint8\_t \mbox{\hyperlink{structs2n__cbc__cipher_a74c35c024abf0e2c0132ec8213398857}{block\_size}};}
\DoxyCodeLine{47     uint8\_t \mbox{\hyperlink{structs2n__cbc__cipher_ac586a55df1760a75363dbcc21a10173b}{record\_iv\_size}};}
\DoxyCodeLine{48     int (*\mbox{\hyperlink{structs2n__cbc__cipher_acabeca34e372c35e7f34b212d1291ef5}{decrypt}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} * key, \textcolor{keyword}{struct }s2n\_blob * iv, \textcolor{keyword}{struct }s2n\_blob * in, \textcolor{keyword}{struct }s2n\_blob * out);}
\DoxyCodeLine{49     int (*\mbox{\hyperlink{structs2n__cbc__cipher_ada2984b1644f889d281a007b88951619}{encrypt}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} * key, \textcolor{keyword}{struct }s2n\_blob * iv, \textcolor{keyword}{struct }s2n\_blob * in, \textcolor{keyword}{struct }s2n\_blob * out);}
\DoxyCodeLine{50 \};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__aead__cipher}{s2n\_aead\_cipher}} \{}
\DoxyCodeLine{53     uint8\_t \mbox{\hyperlink{structs2n__aead__cipher_a6a6ef0a4e2d8d5afd0a22c4fe8dbb65e}{fixed\_iv\_size}};}
\DoxyCodeLine{54     uint8\_t \mbox{\hyperlink{structs2n__aead__cipher_ad1b58ef5211fdb55236071613bbb4b85}{record\_iv\_size}};}
\DoxyCodeLine{55     uint8\_t \mbox{\hyperlink{structs2n__aead__cipher_a6c1eb3ebfdce8451b27df7c5a26bc559}{tag\_size}};}
\DoxyCodeLine{56     int (*\mbox{\hyperlink{structs2n__aead__cipher_afdbb0c04c4ef38ab777493f4713a08a4}{decrypt}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} * key, \textcolor{keyword}{struct }s2n\_blob * iv, \textcolor{keyword}{struct }s2n\_blob * add, \textcolor{keyword}{struct }s2n\_blob * in, \textcolor{keyword}{struct }s2n\_blob * out);}
\DoxyCodeLine{57     int (*\mbox{\hyperlink{structs2n__aead__cipher_a17c58fe7ebddcc31c113eea997e882b0}{encrypt}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} * key, \textcolor{keyword}{struct }s2n\_blob * iv, \textcolor{keyword}{struct }s2n\_blob * add, \textcolor{keyword}{struct }s2n\_blob * in, \textcolor{keyword}{struct }s2n\_blob * out);}
\DoxyCodeLine{58 \};}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__composite__cipher}{s2n\_composite\_cipher}} \{}
\DoxyCodeLine{61     uint8\_t \mbox{\hyperlink{structs2n__composite__cipher_a19e1f1e077efa33fc1e06dd53540a609}{block\_size}};}
\DoxyCodeLine{62     uint8\_t \mbox{\hyperlink{structs2n__composite__cipher_ae8db0e2dec17d6769a0656a0a24788a0}{record\_iv\_size}};}
\DoxyCodeLine{63     uint8\_t \mbox{\hyperlink{structs2n__composite__cipher_a8a486e3c85285377a140983dacfc97c4}{mac\_key\_size}};}
\DoxyCodeLine{64     int (*\mbox{\hyperlink{structs2n__composite__cipher_ad9d8ce8ea4fdbe3b52987e2c19b5b0c5}{decrypt}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key, \textcolor{keyword}{struct }s2n\_blob *iv, \textcolor{keyword}{struct }s2n\_blob *in, \textcolor{keyword}{struct }s2n\_blob *out);}
\DoxyCodeLine{65     int (*\mbox{\hyperlink{structs2n__composite__cipher_a45cd59638b5c57f59c36b3c1194641e0}{encrypt}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key, \textcolor{keyword}{struct }s2n\_blob *iv, \textcolor{keyword}{struct }s2n\_blob *in, \textcolor{keyword}{struct }s2n\_blob *out);}
\DoxyCodeLine{66     int (*\mbox{\hyperlink{structs2n__composite__cipher_ae26aee74ccb7d5163b905c195223d104}{set\_mac\_write\_key}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key, uint8\_t *mac\_key, uint32\_t mac\_size);}
\DoxyCodeLine{67     int (*\mbox{\hyperlink{structs2n__composite__cipher_abe1e683d6d6726eebe342415191bcc8f}{initial\_hmac}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key, uint8\_t *sequence\_number, uint8\_t content\_type, uint16\_t protocol\_version,}
\DoxyCodeLine{68                          uint16\_t payload\_and\_eiv\_len, \textcolor{keywordtype}{int} *extra);}
\DoxyCodeLine{69 \};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \{}
\DoxyCodeLine{72     \textcolor{keyword}{enum} \{ \mbox{\hyperlink{structs2n__cipher_a0693afb80403c8d081c3810596cb2c33a835fd29e4d9d4b12c5c1140f39b0cc65}{S2N\_STREAM}}, \mbox{\hyperlink{structs2n__cipher_a0693afb80403c8d081c3810596cb2c33a16c840859abcc3383f7b3826b39b994d}{S2N\_CBC}}, \mbox{\hyperlink{structs2n__cipher_a0693afb80403c8d081c3810596cb2c33af011e65517b535b357d60807031cf4ae}{S2N\_AEAD}}, \mbox{\hyperlink{structs2n__cipher_a0693afb80403c8d081c3810596cb2c33a8ff9f5c3754f330629e141af92afd54c}{S2N\_COMPOSITE}} \} \mbox{\hyperlink{structs2n__cipher_ab07f43801802cb2dbe4faa81c88169b7}{type}};}
\DoxyCodeLine{73     \textcolor{keyword}{union }\{}
\DoxyCodeLine{74         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stream__cipher}{s2n\_stream\_cipher}} \mbox{\hyperlink{structs2n__cipher_a50c09f5d1cae3eda2c2358d7b37b9fb3}{stream}};}
\DoxyCodeLine{75         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__aead__cipher}{s2n\_aead\_cipher}} \mbox{\hyperlink{structs2n__cipher_a6231380c9377d61eeec3a6938ca923c0}{aead}};}
\DoxyCodeLine{76         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cbc__cipher}{s2n\_cbc\_cipher}} \mbox{\hyperlink{structs2n__cipher_a93ca7243e38f82474fe668345beb8baf}{cbc}};}
\DoxyCodeLine{77         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__composite__cipher}{s2n\_composite\_cipher}} \mbox{\hyperlink{structs2n__cipher_a5a96fc02a7892cb2dc5abee236dc864e}{comp}};}
\DoxyCodeLine{78     \} \mbox{\hyperlink{structs2n__cipher_a1a3210e9812a400fd6661f4c82f21617}{io}};}
\DoxyCodeLine{79     uint8\_t \mbox{\hyperlink{structs2n__cipher_af8ea36ee1645859a214631eeace26756}{key\_material\_size}};}
\DoxyCodeLine{80     uint8\_t (*\mbox{\hyperlink{structs2n__cipher_acb0773b0939628f636ae6c14d9c49bed}{is\_available}}) (void);}
\DoxyCodeLine{81     int     (*\mbox{\hyperlink{structs2n__cipher_a8254d7790f4a87211a826f52efa61461}{init}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key);}
\DoxyCodeLine{82     int     (*\mbox{\hyperlink{structs2n__cipher_a499c5f4e0389262fb16868ecb83f8578}{set\_decryption\_key}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key, \textcolor{keyword}{struct }s2n\_blob *in);}
\DoxyCodeLine{83     int     (*\mbox{\hyperlink{structs2n__cipher_a6fd56739927d38727b181cafe3623e10}{set\_encryption\_key}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key, \textcolor{keyword}{struct }s2n\_blob *in);}
\DoxyCodeLine{84     int     (*\mbox{\hyperlink{structs2n__cipher_a7ac46b0f0acd03072c6ba91c58c1dac4}{destroy\_key}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key);}
\DoxyCodeLine{85 \};}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__cipher_8h_aba1299d02545099884bcff05eed3788b}{s2n\_session\_key\_alloc}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key);}
\DoxyCodeLine{88 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__cipher_8h_a60249079fb9635dd7d7d8f2282d1fe92}{s2n\_session\_key\_free}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__session__key}{s2n\_session\_key}} *key);}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a3b9ffb4a28099b78c0829ebbae74e504}{s2n\_null\_cipher}};}
\DoxyCodeLine{91 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a0b687c26b503f09b9af96abe9cb4e350}{s2n\_rc4}};}
\DoxyCodeLine{92 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_ad9157f5c26e895d54f5bcbf7b3d5fd12}{s2n\_aes128}};}
\DoxyCodeLine{93 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a2cb8c88972784a1123f286a14d9bb5fc}{s2n\_aes256}};}
\DoxyCodeLine{94 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_ab50dfff1c3888a44c1465d78b86b83ce}{s2n\_3des}};}
\DoxyCodeLine{95 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_ad69d1a1adfcd40963920c7f1086e8f0d}{s2n\_aes128\_gcm}};}
\DoxyCodeLine{96 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a440075ab45e872764dc348731695a233}{s2n\_aes256\_gcm}};}
\DoxyCodeLine{97 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a857215a16650959343a8f20aa6b11573}{s2n\_aes128\_sha}};}
\DoxyCodeLine{98 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a1c8767b42c5438f5233093ef50750588}{s2n\_aes256\_sha}};}
\DoxyCodeLine{99 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a9a11a44c3da598848dc1b7cceaa3ce72}{s2n\_aes128\_sha256}};}
\DoxyCodeLine{100 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_aea492947176b7a3a9b7103e1b3b18d8a}{s2n\_aes256\_sha256}};}
\DoxyCodeLine{101 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a0137fb3f62fdc43b18057b843a9e498d}{s2n\_chacha20\_poly1305}};}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_a99a02afdd8a8a9ee29f2e2d7f85f8d34}{s2n\_tls13\_aes128\_gcm}};}
\DoxyCodeLine{104 \textcolor{keyword}{extern} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher}{s2n\_cipher}} \mbox{\hyperlink{s2n__cipher_8h_adf356401c6ee1fdb4f5042ec4cb89ddd}{s2n\_tls13\_aes256\_gcm}};}

\end{DoxyCode}
