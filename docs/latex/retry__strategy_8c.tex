\hypertarget{retry__strategy_8c}{}\doxysection{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/io/source/retry\+\_\+strategy.c File Reference}
\label{retry__strategy_8c}\index{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/io/source/retry\_strategy.c@{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/io/source/retry\_strategy.c}}
{\ttfamily \#include $<$aws/io/retry\+\_\+strategy.\+h$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{retry__strategy_8c_abb2ca1ff67a72849da98ed0a0aed2f5d}{aws\+\_\+retry\+\_\+strategy\+\_\+acquire}} (struct \mbox{\hyperlink{structaws__retry__strategy}{aws\+\_\+retry\+\_\+strategy}} $\ast$retry\+\_\+strategy)
\item 
void \mbox{\hyperlink{retry__strategy_8c_a97e88e3d3d2da7e551eaa6452ff9ebb7}{aws\+\_\+retry\+\_\+strategy\+\_\+release}} (struct \mbox{\hyperlink{structaws__retry__strategy}{aws\+\_\+retry\+\_\+strategy}} $\ast$retry\+\_\+strategy)
\item 
int \mbox{\hyperlink{retry__strategy_8c_ab72bb5210cd0203a7baba13d7241e74c}{aws\+\_\+retry\+\_\+strategy\+\_\+acquire\+\_\+retry\+\_\+token}} (struct \mbox{\hyperlink{structaws__retry__strategy}{aws\+\_\+retry\+\_\+strategy}} $\ast$retry\+\_\+strategy, const struct \mbox{\hyperlink{structaws__byte__cursor}{aws\+\_\+byte\+\_\+cursor}} $\ast$partition\+\_\+id, \mbox{\hyperlink{retry__strategy_8h_a840055993c2a9788207792f45db2e27f}{aws\+\_\+retry\+\_\+strategy\+\_\+on\+\_\+retry\+\_\+token\+\_\+acquired\+\_\+fn}} $\ast$on\+\_\+acquired, void $\ast$\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_af1abaca9a982b3cdb0b118914416c39b}{user\+\_\+data}}, uint64\+\_\+t timeout\+\_\+ms)
\item 
int \mbox{\hyperlink{retry__strategy_8c_a5c990dc3c3f6f3b7574d6435c23a5269}{aws\+\_\+retry\+\_\+strategy\+\_\+schedule\+\_\+retry}} (struct \mbox{\hyperlink{structaws__retry__token}{aws\+\_\+retry\+\_\+token}} $\ast$\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_a3f037ea767197698bc0b4c14fa155431}{token}}, enum \mbox{\hyperlink{retry__strategy_8h_af89c6cafd32c7015ca7157a0c36ecb0c}{aws\+\_\+retry\+\_\+error\+\_\+type}} error\+\_\+type, \mbox{\hyperlink{retry__strategy_8h_ade4a870a92bb428e8688ec1c07273220}{aws\+\_\+retry\+\_\+strategy\+\_\+on\+\_\+retry\+\_\+ready\+\_\+fn}} $\ast$retry\+\_\+ready, void $\ast$\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_af1abaca9a982b3cdb0b118914416c39b}{user\+\_\+data}})
\item 
int \mbox{\hyperlink{retry__strategy_8c_a11a355c471ed49dbefd6f7f932569862}{aws\+\_\+retry\+\_\+token\+\_\+record\+\_\+success}} (struct \mbox{\hyperlink{structaws__retry__token}{aws\+\_\+retry\+\_\+token}} $\ast$\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_a3f037ea767197698bc0b4c14fa155431}{token}})
\item 
void \mbox{\hyperlink{retry__strategy_8c_a784d5374b01e37389ae351d52e72472a}{aws\+\_\+retry\+\_\+token\+\_\+acquire}} (struct \mbox{\hyperlink{structaws__retry__token}{aws\+\_\+retry\+\_\+token}} $\ast$\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_a3f037ea767197698bc0b4c14fa155431}{token}})
\item 
void \mbox{\hyperlink{retry__strategy_8c_a60ca474deb7e9b25086b4de6b7719dde}{aws\+\_\+retry\+\_\+token\+\_\+release}} (struct \mbox{\hyperlink{structaws__retry__token}{aws\+\_\+retry\+\_\+token}} $\ast$\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_a3f037ea767197698bc0b4c14fa155431}{token}})
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{retry__strategy_8c_abb2ca1ff67a72849da98ed0a0aed2f5d}\label{retry__strategy_8c_abb2ca1ff67a72849da98ed0a0aed2f5d}} 
\index{retry\_strategy.c@{retry\_strategy.c}!aws\_retry\_strategy\_acquire@{aws\_retry\_strategy\_acquire}}
\index{aws\_retry\_strategy\_acquire@{aws\_retry\_strategy\_acquire}!retry\_strategy.c@{retry\_strategy.c}}
\doxysubsubsection{\texorpdfstring{aws\_retry\_strategy\_acquire()}{aws\_retry\_strategy\_acquire()}}
{\footnotesize\ttfamily void aws\+\_\+retry\+\_\+strategy\+\_\+acquire (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__retry__strategy}{aws\+\_\+retry\+\_\+strategy}} $\ast$}]{retry\+\_\+strategy }\end{DoxyParamCaption})}

Copyright Amazon.\+com, Inc. or its affiliates. All Rights Reserved. SPDX-\/\+License-\/\+Identifier\+: Apache-\/2.\+0. \mbox{\Hypertarget{retry__strategy_8c_ab72bb5210cd0203a7baba13d7241e74c}\label{retry__strategy_8c_ab72bb5210cd0203a7baba13d7241e74c}} 
\index{retry\_strategy.c@{retry\_strategy.c}!aws\_retry\_strategy\_acquire\_retry\_token@{aws\_retry\_strategy\_acquire\_retry\_token}}
\index{aws\_retry\_strategy\_acquire\_retry\_token@{aws\_retry\_strategy\_acquire\_retry\_token}!retry\_strategy.c@{retry\_strategy.c}}
\doxysubsubsection{\texorpdfstring{aws\_retry\_strategy\_acquire\_retry\_token()}{aws\_retry\_strategy\_acquire\_retry\_token()}}
{\footnotesize\ttfamily int aws\+\_\+retry\+\_\+strategy\+\_\+acquire\+\_\+retry\+\_\+token (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__retry__strategy}{aws\+\_\+retry\+\_\+strategy}} $\ast$}]{retry\+\_\+strategy,  }\item[{const struct \mbox{\hyperlink{structaws__byte__cursor}{aws\+\_\+byte\+\_\+cursor}} $\ast$}]{partition\+\_\+id,  }\item[{\mbox{\hyperlink{retry__strategy_8h_a840055993c2a9788207792f45db2e27f}{aws\+\_\+retry\+\_\+strategy\+\_\+on\+\_\+retry\+\_\+token\+\_\+acquired\+\_\+fn}} $\ast$}]{on\+\_\+acquired,  }\item[{void $\ast$}]{user\+\_\+data,  }\item[{uint64\+\_\+t}]{timeout\+\_\+ms }\end{DoxyParamCaption})}

Attempts to acquire a retry token for use with retries. On success, on\+\_\+acquired will be invoked when a token is available, or an error will be returned if the timeout expires. partition\+\_\+id identifies operations that should be grouped together. This allows for more sophisticated strategies such as AIMD and circuit breaker patterns. Pass NULL to use the global partition. \mbox{\Hypertarget{retry__strategy_8c_a97e88e3d3d2da7e551eaa6452ff9ebb7}\label{retry__strategy_8c_a97e88e3d3d2da7e551eaa6452ff9ebb7}} 
\index{retry\_strategy.c@{retry\_strategy.c}!aws\_retry\_strategy\_release@{aws\_retry\_strategy\_release}}
\index{aws\_retry\_strategy\_release@{aws\_retry\_strategy\_release}!retry\_strategy.c@{retry\_strategy.c}}
\doxysubsubsection{\texorpdfstring{aws\_retry\_strategy\_release()}{aws\_retry\_strategy\_release()}}
{\footnotesize\ttfamily void aws\+\_\+retry\+\_\+strategy\+\_\+release (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__retry__strategy}{aws\+\_\+retry\+\_\+strategy}} $\ast$}]{retry\+\_\+strategy }\end{DoxyParamCaption})}

Releases a reference count on retry\+\_\+strategy. \mbox{\Hypertarget{retry__strategy_8c_a5c990dc3c3f6f3b7574d6435c23a5269}\label{retry__strategy_8c_a5c990dc3c3f6f3b7574d6435c23a5269}} 
\index{retry\_strategy.c@{retry\_strategy.c}!aws\_retry\_strategy\_schedule\_retry@{aws\_retry\_strategy\_schedule\_retry}}
\index{aws\_retry\_strategy\_schedule\_retry@{aws\_retry\_strategy\_schedule\_retry}!retry\_strategy.c@{retry\_strategy.c}}
\doxysubsubsection{\texorpdfstring{aws\_retry\_strategy\_schedule\_retry()}{aws\_retry\_strategy\_schedule\_retry()}}
{\footnotesize\ttfamily int aws\+\_\+retry\+\_\+strategy\+\_\+schedule\+\_\+retry (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__retry__token}{aws\+\_\+retry\+\_\+token}} $\ast$}]{token,  }\item[{enum \mbox{\hyperlink{retry__strategy_8h_af89c6cafd32c7015ca7157a0c36ecb0c}{aws\+\_\+retry\+\_\+error\+\_\+type}}}]{error\+\_\+type,  }\item[{\mbox{\hyperlink{retry__strategy_8h_ade4a870a92bb428e8688ec1c07273220}{aws\+\_\+retry\+\_\+strategy\+\_\+on\+\_\+retry\+\_\+ready\+\_\+fn}} $\ast$}]{retry\+\_\+ready,  }\item[{void $\ast$}]{user\+\_\+data }\end{DoxyParamCaption})}

Schedules a retry based on the backoff and token based strategies. retry\+\_\+ready is invoked when the retry is either ready for execution or if it has been canceled due to application shutdown.

This function can return an error to reject the retry attempt if, for example, a circuit breaker has opened. If this occurs users should fail their calls back to their callers.

error\+\_\+type is used for book keeping. See the comments above for aws\+\_\+retry\+\_\+error\+\_\+type. \mbox{\Hypertarget{retry__strategy_8c_a784d5374b01e37389ae351d52e72472a}\label{retry__strategy_8c_a784d5374b01e37389ae351d52e72472a}} 
\index{retry\_strategy.c@{retry\_strategy.c}!aws\_retry\_token\_acquire@{aws\_retry\_token\_acquire}}
\index{aws\_retry\_token\_acquire@{aws\_retry\_token\_acquire}!retry\_strategy.c@{retry\_strategy.c}}
\doxysubsubsection{\texorpdfstring{aws\_retry\_token\_acquire()}{aws\_retry\_token\_acquire()}}
{\footnotesize\ttfamily void aws\+\_\+retry\+\_\+token\+\_\+acquire (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__retry__token}{aws\+\_\+retry\+\_\+token}} $\ast$}]{token }\end{DoxyParamCaption})}

Increments reference count for token. This should be called any time you seat the token to a pointer you own. \mbox{\Hypertarget{retry__strategy_8c_a11a355c471ed49dbefd6f7f932569862}\label{retry__strategy_8c_a11a355c471ed49dbefd6f7f932569862}} 
\index{retry\_strategy.c@{retry\_strategy.c}!aws\_retry\_token\_record\_success@{aws\_retry\_token\_record\_success}}
\index{aws\_retry\_token\_record\_success@{aws\_retry\_token\_record\_success}!retry\_strategy.c@{retry\_strategy.c}}
\doxysubsubsection{\texorpdfstring{aws\_retry\_token\_record\_success()}{aws\_retry\_token\_record\_success()}}
{\footnotesize\ttfamily int aws\+\_\+retry\+\_\+token\+\_\+record\+\_\+success (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__retry__token}{aws\+\_\+retry\+\_\+token}} $\ast$}]{token }\end{DoxyParamCaption})}

Records a successful retry. This is used for making future decisions to open up token buckets, AIMD breakers etc... some strategies such as exponential backoff will ignore this, but you should always call it after a successful operation or your system will never recover during an outage. \mbox{\Hypertarget{retry__strategy_8c_a60ca474deb7e9b25086b4de6b7719dde}\label{retry__strategy_8c_a60ca474deb7e9b25086b4de6b7719dde}} 
\index{retry\_strategy.c@{retry\_strategy.c}!aws\_retry\_token\_release@{aws\_retry\_token\_release}}
\index{aws\_retry\_token\_release@{aws\_retry\_token\_release}!retry\_strategy.c@{retry\_strategy.c}}
\doxysubsubsection{\texorpdfstring{aws\_retry\_token\_release()}{aws\_retry\_token\_release()}}
{\footnotesize\ttfamily void aws\+\_\+retry\+\_\+token\+\_\+release (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__retry__token}{aws\+\_\+retry\+\_\+token}} $\ast$}]{token }\end{DoxyParamCaption})}

Releases the reference count for token. This should always be invoked after either calling \mbox{\hyperlink{retry__strategy_8h_ae54ea9ff39ddd2a21c87f4ef3e6111d5}{aws\+\_\+retry\+\_\+strategy\+\_\+schedule\+\_\+retry()}} and failing, or after calling \mbox{\hyperlink{retry__strategy_8h_a19f32fa855a56b5234d8abd40fa9922e}{aws\+\_\+retry\+\_\+token\+\_\+record\+\_\+success()}}. 