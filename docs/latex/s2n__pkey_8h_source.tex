\hypertarget{s2n__pkey_8h_source}{}\doxysection{s2n\+\_\+pkey.\+h}
\label{s2n__pkey_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_pkey.h@{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_pkey.h}}
\mbox{\hyperlink{s2n__pkey_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{evp_8h}{openssl/evp.h}}>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__signature_8h}{crypto/s2n\_signature.h}}"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__ecdsa_8h}{crypto/s2n\_ecdsa.h}}"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{crypto_2s2n__hash_8h}{crypto/s2n\_hash.h}}"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__rsa_8h}{crypto/s2n\_rsa.h}}"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include "{}utils/s2n\_blob.h"{}}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{comment}{/* Public/Private Key Type */}}
\DoxyCodeLine{28 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{29     \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441acd4aafd5b2ca2d358da741fa64ceda13}{S2N\_PKEY\_TYPE\_UNKNOWN}} = -\/1,}
\DoxyCodeLine{30     \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441a3ca9c183ae0e3ef10cbc723c2bb52362}{S2N\_PKEY\_TYPE\_RSA}} = 0,}
\DoxyCodeLine{31     \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441a97888f8d7ad005eee08470415684e8ce}{S2N\_PKEY\_TYPE\_ECDSA}},}
\DoxyCodeLine{32     \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441af2e677e652e18e8b6a402675949218de}{S2N\_PKEY\_TYPE\_RSA\_PSS}},}
\DoxyCodeLine{33     \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441aff0d03568f38f32117eb7c6b57b07c9d}{S2N\_PKEY\_TYPE\_SENTINEL}}}
\DoxyCodeLine{34 \} \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\_pkey\_type}};}
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{comment}{/* Structure that models a public or private key and type-\/specific operations */}}
\DoxyCodeLine{37 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} \{}
\DoxyCodeLine{38     \textcolor{comment}{/* Legacy OpenSSL APIs operate on specific keys, but the more recent}}
\DoxyCodeLine{39 \textcolor{comment}{     * APIs all operate on EVP\_PKEY. Let's store both for backwards compatibility. */}}
\DoxyCodeLine{40     \textcolor{keyword}{union }\{}
\DoxyCodeLine{41         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__rsa__key}{s2n\_rsa\_key}} \mbox{\hyperlink{structs2n__pkey_ac9a95739f5cf56168824be1fb6f66a43}{rsa\_key}};}
\DoxyCodeLine{42         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__ecdsa__key}{s2n\_ecdsa\_key}} \mbox{\hyperlink{structs2n__pkey_a0118458b0931834f9d5b97ac4f59d927}{ecdsa\_key}};}
\DoxyCodeLine{43     \} \mbox{\hyperlink{structs2n__pkey_a80c4b244a243aab8b0ef3be745c2b135}{key}};}
\DoxyCodeLine{44     \mbox{\hyperlink{ossl__typ_8h_a2fca4fef9e4c7a2a739b1ea04acb56ce}{EVP\_PKEY}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}};}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     int (*\mbox{\hyperlink{structs2n__pkey_a340dbedee000c9a64ceac3768f5065f5}{size}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a80c4b244a243aab8b0ef3be745c2b135}{key}});}
\DoxyCodeLine{47     int (*\mbox{\hyperlink{structs2n__pkey_a5302537b80a82867dce1a5aaaa31c2a4}{sign}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *priv\_key, \mbox{\hyperlink{s2n__signature_8h_a28050d82b8dc7de14b8b0698eb526780}{s2n\_signature\_algorithm}} sig\_alg,}
\DoxyCodeLine{48             \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structs2n__hash__state_ac7baf712897bf5b0d3f83bf038b1e234}{digest}}, \textcolor{keyword}{struct }s2n\_blob *signature);}
\DoxyCodeLine{49     int (*\mbox{\hyperlink{structs2n__pkey_a2d2e869a50380471fb171469fad46869}{verify}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *pub\_key, \mbox{\hyperlink{s2n__signature_8h_a28050d82b8dc7de14b8b0698eb526780}{s2n\_signature\_algorithm}} sig\_alg,}
\DoxyCodeLine{50             \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structs2n__hash__state_ac7baf712897bf5b0d3f83bf038b1e234}{digest}}, \textcolor{keyword}{struct }s2n\_blob *signature);}
\DoxyCodeLine{51     int (*\mbox{\hyperlink{structs2n__pkey_a5e42c995a5eef288eba09c27298c3b9f}{encrypt}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a80c4b244a243aab8b0ef3be745c2b135}{key}}, \textcolor{keyword}{struct }s2n\_blob *in, \textcolor{keyword}{struct }s2n\_blob *out);}
\DoxyCodeLine{52     int (*\mbox{\hyperlink{structs2n__pkey_af20c1671c32be6b9f6974a7013325d5a}{decrypt}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a80c4b244a243aab8b0ef3be745c2b135}{key}}, \textcolor{keyword}{struct }s2n\_blob *in, \textcolor{keyword}{struct }s2n\_blob *out);}
\DoxyCodeLine{53     int (*\mbox{\hyperlink{structs2n__pkey_a858a093b3866390458ba4ba78c565f68}{match}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *pub\_key, \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *priv\_key); }
\DoxyCodeLine{54     int (*\mbox{\hyperlink{structs2n__pkey_a147fb4594674db55f9ae154422d4be48}{free}})(\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a80c4b244a243aab8b0ef3be745c2b135}{key}});}
\DoxyCodeLine{55     int (*\mbox{\hyperlink{structs2n__pkey_aa1189a112394f3925489db9b886d01e7}{check\_key}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a80c4b244a243aab8b0ef3be745c2b135}{key}});}
\DoxyCodeLine{56 \};}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a576cae2e77ec22cbdf6fc66c51264a3c}{s2n\_pkey\_zero\_init}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}});}
\DoxyCodeLine{59 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_aef5fd8b617493ca7b0a3bf3d866ecf5b}{s2n\_pkey\_setup\_for\_type}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}}, \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\_pkey\_type}} pkey\_type);}
\DoxyCodeLine{60 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a5fdf76bf738d6616800591d2cac21b39}{s2n\_pkey\_check\_key\_exists}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}});}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_ac4435bbfaabe6b7eb8012ad2f4f644f1}{s2n\_pkey\_size}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}});}
\DoxyCodeLine{63 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_ac613c9efcdd4097f33e9ee1e9ac53038}{s2n\_pkey\_sign}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}}, \mbox{\hyperlink{s2n__signature_8h_a28050d82b8dc7de14b8b0698eb526780}{s2n\_signature\_algorithm}} sig\_alg,}
\DoxyCodeLine{64         \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *digest, \textcolor{keyword}{struct} s2n\_blob *signature);}
\DoxyCodeLine{65 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a55daf90a0aeeac46e3e64de5db9ca54f}{s2n\_pkey\_verify}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}}, \mbox{\hyperlink{s2n__signature_8h_a28050d82b8dc7de14b8b0698eb526780}{s2n\_signature\_algorithm}} sig\_alg,}
\DoxyCodeLine{66         \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *digest, \textcolor{keyword}{struct} s2n\_blob *signature);}
\DoxyCodeLine{67 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a549bd0d88d9885011ea11c2b456e9755}{s2n\_pkey\_encrypt}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}}, \textcolor{keyword}{struct} s2n\_blob *in, \textcolor{keyword}{struct} s2n\_blob *out);}
\DoxyCodeLine{68 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a0e7f6be5c29b9d7124c5fabc32c840d5}{s2n\_pkey\_decrypt}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}}, \textcolor{keyword}{struct} s2n\_blob *in, \textcolor{keyword}{struct} s2n\_blob *out);}
\DoxyCodeLine{69 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a6c83c4764ea978fe9c42f0831888fa4b}{s2n\_pkey\_match}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *pub\_key, \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *priv\_key);}
\DoxyCodeLine{70 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a3117e4590088cfa7fdfa383ba80c58c5}{s2n\_pkey\_free}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *\mbox{\hyperlink{structs2n__pkey_a6ca7a2edd3efbada2611579749dd959a}{pkey}});}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a88c5a69d63827b20f4b0b1ec99b7d2a3}{s2n\_asn1der\_to\_private\_key}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *priv\_key, \textcolor{keyword}{struct} s2n\_blob *asn1der);}
\DoxyCodeLine{73 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__pkey_8h_a2dfec1f3146d63ef91db4c0cd2e45326}{s2n\_asn1der\_to\_public\_key\_and\_type}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__pkey}{s2n\_pkey}} *pub\_key, \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\_pkey\_type}} *pkey\_type, \textcolor{keyword}{struct} s2n\_blob *asn1der);}

\end{DoxyCode}
