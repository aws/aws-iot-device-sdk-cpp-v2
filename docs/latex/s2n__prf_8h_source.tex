\hypertarget{s2n__prf_8h_source}{}\doxysection{s2n\+\_\+prf.\+h}
\label{s2n__prf_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_prf.h@{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_prf.h}}
\mbox{\hyperlink{s2n__prf_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{crypto_2s2n__hash_8h}{crypto/s2n\_hash.h}}"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__hmac_8h}{crypto/s2n\_hmac.h}}"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__openssl_8h}{crypto/s2n\_openssl.h}}"{}}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}utils/s2n\_blob.h"{}}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{comment}{/* Enough to support TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384, 2*SHA384\_DIGEST\_LEN + 2*AES256\_KEY\_SIZE */}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define S2N\_MAX\_KEY\_BLOCK\_LEN 160}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{struct }\mbox{\hyperlink{structp__hash__state}{p\_hash\_state}} \{}
\DoxyCodeLine{30     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} \mbox{\hyperlink{structp__hash__state_a5ee803262676ee80f839e99111335031}{s2n\_hmac}};}
\DoxyCodeLine{31     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__evp__hmac__state}{s2n\_evp\_hmac\_state}} \mbox{\hyperlink{structp__hash__state_a0b375d8b01dd7171061960084093ca8f}{evp\_hmac}};}
\DoxyCodeLine{32 \};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} \{}
\DoxyCodeLine{35     \textcolor{keyword}{struct }\{}
\DoxyCodeLine{36         \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__p__hash__hmac}{s2n\_p\_hash\_hmac}} *\mbox{\hyperlink{structs2n__prf__working__space_a8148080c941e4616d7f507ef32fd47d1}{p\_hash\_hmac\_impl}};}
\DoxyCodeLine{37         \textcolor{keyword}{struct }\mbox{\hyperlink{structp__hash__state}{p\_hash\_state}} \mbox{\hyperlink{structs2n__prf__working__space_a337f631c34b85c29404e8be8757a6b06}{p\_hash}};}
\DoxyCodeLine{38         uint8\_t \mbox{\hyperlink{structs2n__prf__working__space_abc9fb48e840cd552ae96e9dcb9aeda8f}{digest0}}[\mbox{\hyperlink{crypto_2s2n__hash_8h_a6e72344ee5c9fe106257b029521e675e}{S2N\_MAX\_DIGEST\_LEN}}];}
\DoxyCodeLine{39         uint8\_t \mbox{\hyperlink{structs2n__prf__working__space_ad4487858f744b273a0c2158bb53fab17}{digest1}}[\mbox{\hyperlink{crypto_2s2n__hash_8h_a6e72344ee5c9fe106257b029521e675e}{S2N\_MAX\_DIGEST\_LEN}}];}
\DoxyCodeLine{40     \} \mbox{\hyperlink{structs2n__prf__working__space_a23d52f485777c3527775c8a0f4e0da2d}{tls}};}
\DoxyCodeLine{41 }
\DoxyCodeLine{42     \textcolor{keyword}{struct }\{}
\DoxyCodeLine{43         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} \mbox{\hyperlink{structs2n__prf__working__space_a8a6d23c355d24bdffa0799cc41165d03}{md5}};}
\DoxyCodeLine{44         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} \mbox{\hyperlink{structs2n__prf__working__space_a86396cf40a67f3e8c6e92fdc7165986a}{sha1}};}
\DoxyCodeLine{45         uint8\_t \mbox{\hyperlink{structs2n__prf__working__space_a7515884b7813a9c1cc653f24babbc37f}{md5\_digest}}[\mbox{\hyperlink{md5_8h_a09a4f4b2f28cbe522d9b80153666029c}{MD5\_DIGEST\_LENGTH}}];}
\DoxyCodeLine{46         uint8\_t \mbox{\hyperlink{structs2n__prf__working__space_a98d57bf891c0c95ef3ff6ee94b1ca1bb}{sha1\_digest}}[\mbox{\hyperlink{tests_2cbmc_2include_2openssl_2sha_8h_a1a715db7b4403fe6c165e49a32f5fe3d}{SHA\_DIGEST\_LENGTH}}];}
\DoxyCodeLine{47     \} \mbox{\hyperlink{structs2n__prf__working__space_a2552398b4b2e08118c6e002673fcbed3}{ssl3}};}
\DoxyCodeLine{48 \};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{comment}{/* The s2n p\_hash implementation is abstracted to allow for separate implementations, using}}
\DoxyCodeLine{51 \textcolor{comment}{ * either s2n's formally verified HMAC or OpenSSL's EVP HMAC, for use by the TLS PRF. */}}
\DoxyCodeLine{52 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__p__hash__hmac}{s2n\_p\_hash\_hmac}} \{}
\DoxyCodeLine{53     int (*\mbox{\hyperlink{structs2n__p__hash__hmac_a184637d086efdc03b651561ea03d3792}{alloc}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} *ws);}
\DoxyCodeLine{54     int (*\mbox{\hyperlink{structs2n__p__hash__hmac_aa3931a6520197af9daf2f55639a213bd}{init}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} *ws, \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} alg, \textcolor{keyword}{struct }s2n\_blob *secret);}
\DoxyCodeLine{55     int (*\mbox{\hyperlink{structs2n__p__hash__hmac_a58e15dc6a70f4b0ccb5135fb368be308}{update}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} *ws, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, uint32\_t size);}
\DoxyCodeLine{56     int (*\textcolor{keyword}{final}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} *ws, \textcolor{keywordtype}{void} *digest, uint32\_t size);}
\DoxyCodeLine{57     int (*\mbox{\hyperlink{structs2n__p__hash__hmac_a27d5e17f6a85bbf0fab8661ce609354c}{reset}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} *ws);}
\DoxyCodeLine{58     int (*\mbox{\hyperlink{structs2n__p__hash__hmac_ae3870135cb82deea57f49cd173d35d9a}{cleanup}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} *ws);}
\DoxyCodeLine{59     int (*\mbox{\hyperlink{structs2n__p__hash__hmac_a1a88b7b02106b40b961e3d49cf244fb4}{free}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} *ws);}
\DoxyCodeLine{60 \};}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__connection_8h}{tls/s2n\_connection.h}}"{}}}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__prf_8h_a17bd54c706160d1c5fdd67b32b9a9344}{s2n\_prf\_new}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{65 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__prf_8h_af2288749810fb34819cb25fed45ea328}{s2n\_prf\_free}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{66 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__prf_8h_a4014572c10b4fd05b559b71d860595e3}{s2n\_tls\_prf\_master\_secret}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} s2n\_blob *premaster\_secret);}
\DoxyCodeLine{67 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__prf_8h_af3fdd7f81f19fbe15d1fbc68673bbea6}{s2n\_hybrid\_prf\_master\_secret}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} s2n\_blob *premaster\_secret);}
\DoxyCodeLine{68 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__prf_8h_a1425bb608ed69a0cc582af0a57955e1f}{s2n\_prf\_key\_expansion}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{69 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__prf_8h_a4d977ca107f8b2ac76823eb6281ca69b}{s2n\_prf\_server\_finished}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{70 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__prf_8h_a809931120983e64ed6602dbac2b9b1fc}{s2n\_prf\_client\_finished}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}

\end{DoxyCode}
