\hypertarget{s2n__testlib_8h_source}{}\doxysection{s2n\+\_\+testlib.\+h}
\label{s2n__testlib_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/tests/testlib/s2n\_testlib.h@{crt/aws-\/crt-\/cpp/crt/s2n/tests/testlib/s2n\_testlib.h}}
\mbox{\hyperlink{s2n__testlib_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__stuffer_8h}{stuffer/s2n\_stuffer.h}}"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__connection_8h}{tls/s2n\_connection.h}}"{}}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{comment}{/* Read and write hex */}}
\DoxyCodeLine{24 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a118ca423ee9bf8370cb1992b09db99a9}{s2n\_stuffer\_read\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *out, uint32\_t \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}});}
\DoxyCodeLine{25 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a98bbca4d5251f6db21061e6feb95da1b}{s2n\_stuffer\_read\_uint8\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint8\_t *u);}
\DoxyCodeLine{26 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a517d2c591ca95c161a672561e12c89b8}{s2n\_stuffer\_read\_uint16\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint16\_t *u);}
\DoxyCodeLine{27 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a8b0792099ca5ef6812afc44337ee8af0}{s2n\_stuffer\_read\_uint32\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint32\_t *u);}
\DoxyCodeLine{28 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a9bd6a743e1bc57c276e2af9300a81933}{s2n\_stuffer\_read\_uint64\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint64\_t *u);}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_ab61e2b928f2722daff666b6da94f3f13}{s2n\_stuffer\_write\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *in, uint32\_t \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}});}
\DoxyCodeLine{31 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_afa09f772b334ba411a27ba2d52747b7d}{s2n\_stuffer\_write\_uint8\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint8\_t u);}
\DoxyCodeLine{32 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_aed0ab9f1bb48ba81d2f43422b5c543e5}{s2n\_stuffer\_write\_uint16\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint16\_t u);}
\DoxyCodeLine{33 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a1ee9f3813116985bd87e1fcf747f2187}{s2n\_stuffer\_write\_uint32\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint32\_t u);}
\DoxyCodeLine{34 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a03dd5e430cd385de83b204fba40c2d1f}{s2n\_stuffer\_write\_uint64\_hex}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint64\_t u);}
\DoxyCodeLine{35 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a1c990dcff5ccd1778a80bdcdd0034719}{s2n\_stuffer\_alloc\_ro\_from\_hex\_string}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\mbox{\hyperlink{namespacecreate-projects_a6690bd467c6241951130aa0bf17e373d}{str}});}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 \textcolor{keywordtype}{void} \mbox{\hyperlink{s2n__testlib_8h_a444dd08e471959c18195eb6236de37a2}{s2n\_print\_connection}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *marker);}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a7f04331a943cac05b3c7cbc6c3268730}{s2n\_connection\_set\_io\_stuffers}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *input, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{log__formatter__test_8c_ae73289c5189c80c0661459b0f4743217}{output}}, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__test__io__pair}{s2n\_test\_io\_pair}} \{}
\DoxyCodeLine{42     \textcolor{keywordtype}{int} \mbox{\hyperlink{structs2n__test__io__pair_a7afe28421c5f70297dbacc00d8b4e67d}{client}};}
\DoxyCodeLine{43     \textcolor{keywordtype}{int} \mbox{\hyperlink{structs2n__test__io__pair_ac830a021696b2e1b84d2e840c1d2d88d}{server}};}
\DoxyCodeLine{44 \};}
\DoxyCodeLine{45 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_aa8af92c3001433ada6060960ceb5be36}{s2n\_io\_pair\_init}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__test__io__pair}{s2n\_test\_io\_pair}} *io\_pair);}
\DoxyCodeLine{46 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a107d4430cc552e0be65b149fb5ab577c}{s2n\_io\_pair\_init\_non\_blocking}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__test__io__pair}{s2n\_test\_io\_pair}} *io\_pair);}
\DoxyCodeLine{47 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a82b26dd328f735caa3c8897e221bcdf5}{s2n\_io\_pair\_close}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__test__io__pair}{s2n\_test\_io\_pair}} *io\_pair);}
\DoxyCodeLine{48 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_afcbe2ad010098b320f2dae2c8d6d18e1}{s2n\_io\_pair\_close\_one\_end}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__test__io__pair}{s2n\_test\_io\_pair}} *io\_pair, \textcolor{keywordtype}{int} mode\_to\_close);}
\DoxyCodeLine{49 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a9ac849d062969d355f7fcb2453b6bee8}{s2n\_io\_pair\_shutdown\_one\_end}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__test__io__pair}{s2n\_test\_io\_pair}} *io\_pair, \textcolor{keywordtype}{int} mode\_to\_close, \textcolor{keywordtype}{int} how);}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_ac72da7204d570c3d605f226dfc8a45a3}{s2n\_connection\_set\_io\_pair}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__test__io__pair}{s2n\_test\_io\_pair}} *io\_pair);}
\DoxyCodeLine{52 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_ab5ef47e499ebed5f3d5edae1fcea28c4}{s2n\_connections\_set\_io\_pair}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *client, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *server,}
\DoxyCodeLine{53                                 \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__test__io__pair}{s2n\_test\_io\_pair}} *io\_pair);}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a21ae1656f754bbcbd451eb243ad16589}{s2n\_fd\_set\_blocking}}(\textcolor{keywordtype}{int} fd);}
\DoxyCodeLine{56 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a19fa83c0fdd2911233c21613ab759123}{s2n\_fd\_set\_non\_blocking}}(\textcolor{keywordtype}{int} fd);}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a6bf80c3436761cb5fa9706f5aeb51bda}{s2n\_set\_connection\_hello\_retry\_flags}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{59 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a59d8ccbe55130dfb2f131ab1404c8f62}{s2n\_connection\_allow\_all\_response\_extensions}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{60 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_aa6b6897afba27ba228e94c77f21e9391}{s2n\_connection\_set\_all\_protocol\_versions}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, uint8\_t version);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{preprocessor}{\#define S2N\_MAX\_TEST\_PEM\_SIZE 4096}}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 \textcolor{comment}{/* These paths assume that the unit tests are run from inside the unit/ directory.}}
\DoxyCodeLine{65 \textcolor{comment}{ * Absolute paths will be needed if test directories go to deeper levels.}}
\DoxyCodeLine{66 \textcolor{comment}{ */}}
\DoxyCodeLine{67 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_PKCS8\_CERT\_CHAIN   "{}../pems/rsa\_2048\_pkcs8\_cert.pem"{}}}
\DoxyCodeLine{68 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_PKCS1\_CERT\_CHAIN   "{}../pems/rsa\_2048\_pkcs1\_cert.pem"{}}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_PKCS1\_LEAF\_CERT    "{}../pems/rsa\_2048\_pkcs1\_leaf.pem"{}}}
\DoxyCodeLine{71 \textcolor{preprocessor}{\#define S2N\_ECDSA\_P256\_PKCS1\_CERT\_CHAIN "{}../pems/ecdsa\_p256\_pkcs1\_cert.pem"{}}}
\DoxyCodeLine{72 \textcolor{preprocessor}{\#define S2N\_ECDSA\_P384\_PKCS1\_CERT\_CHAIN "{}../pems/ecdsa\_p384\_pkcs1\_cert.pem"{}}}
\DoxyCodeLine{73 \textcolor{preprocessor}{\#define S2N\_RSA\_CERT\_CHAIN\_CRLF         "{}../pems/rsa\_2048\_pkcs1\_cert\_crlf.pem"{}}}
\DoxyCodeLine{74 \textcolor{preprocessor}{\#define S2N\_RSA\_KEY\_CRLF                "{}../pems/rsa\_2048\_pkcs1\_key\_crlf.pem"{}}}
\DoxyCodeLine{75 \textcolor{preprocessor}{\#define S2N\_ECDSA\_P256\_PKCS1\_KEY        "{}../pems/ecdsa\_p256\_pkcs1\_key.pem"{}}}
\DoxyCodeLine{76 \textcolor{preprocessor}{\#define S2N\_ECDSA\_P384\_PKCS1\_KEY        "{}../pems/ecdsa\_p384\_pkcs1\_key.pem"{}}}
\DoxyCodeLine{77 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_PKCS1\_KEY          "{}../pems/rsa\_2048\_pkcs1\_key.pem"{}}}
\DoxyCodeLine{78 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_PKCS8\_KEY          "{}../pems/rsa\_2048\_pkcs8\_key.pem"{}}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{preprocessor}{\#define S2N\_RSA\_PSS\_2048\_SHA256\_CA\_KEY         "{}../pems/rsa\_pss\_2048\_sha256\_CA\_key.pem"{}}}
\DoxyCodeLine{81 \textcolor{preprocessor}{\#define S2N\_RSA\_PSS\_2048\_SHA256\_CA\_CERT        "{}../pems/rsa\_pss\_2048\_sha256\_CA\_cert.pem"{}}}
\DoxyCodeLine{82 \textcolor{preprocessor}{\#define S2N\_RSA\_PSS\_2048\_SHA256\_LEAF\_KEY       "{}../pems/rsa\_pss\_2048\_sha256\_leaf\_key.pem"{}}}
\DoxyCodeLine{83 \textcolor{preprocessor}{\#define S2N\_RSA\_PSS\_2048\_SHA256\_LEAF\_CERT      "{}../pems/rsa\_pss\_2048\_sha256\_leaf\_cert.pem"{}}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_SHA256\_CLIENT\_CERT "{}../pems/rsa\_2048\_sha256\_client\_cert.pem"{}}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_SHA256\_NO\_DNS\_SANS\_CERT "{}../pems/rsa\_2048\_sha256\_no\_dns\_sans\_cert.pem"{}}}
\DoxyCodeLine{88 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_SHA256\_WILDCARD\_CERT    "{}../pems/rsa\_2048\_sha256\_wildcard\_cert.pem"{}}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \textcolor{preprocessor}{\#define S2N\_RSA\_2048\_SHA256\_URI\_SANS\_CERT "{}../pems/rsa\_2048\_sha256\_uri\_sans\_cert.pem"{}}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{comment}{/* "{}Strangely"{} formatted PEMs that should still parse successfully */}}
\DoxyCodeLine{93 \textcolor{preprocessor}{\#define S2N\_LEAF\_WHITESPACE\_CERT\_CHAIN         "{}../pems/rsa\_2048\_leaf\_whitespace\_cert.pem"{}}}
\DoxyCodeLine{94 \textcolor{preprocessor}{\#define S2N\_INTERMEDIATE\_WHITESPACE\_CERT\_CHAIN "{}../pems/rsa\_2048\_intermediate\_whitespace\_cert.pem"{}}}
\DoxyCodeLine{95 \textcolor{preprocessor}{\#define S2N\_ROOT\_WHITESPACE\_CERT\_CHAIN         "{}../pems/rsa\_2048\_root\_whitespace\_cert.pem"{}}}
\DoxyCodeLine{96 \textcolor{preprocessor}{\#define S2N\_TRAILING\_WHITESPACE\_CERT\_CHAIN     "{}../pems/rsa\_2048\_trailing\_whitespace\_cert.pem"{}}}
\DoxyCodeLine{97 \textcolor{preprocessor}{\#define S2N\_LEADING\_COMMENT\_TEXT\_CERT\_CHAIN    "{}../pems/rsa\_2048\_leading\_comment\_text\_cert.pem"{}}}
\DoxyCodeLine{98 \textcolor{preprocessor}{\#define S2N\_LONG\_BASE64\_LINES\_CERT\_CHAIN       "{}../pems/rsa\_2048\_varying\_base64\_len\_cert.pem"{}}}
\DoxyCodeLine{99 \textcolor{comment}{/* Missing line endings between PEM encapsulation boundaries */}}
\DoxyCodeLine{100 \textcolor{preprocessor}{\#define S2N\_MISSING\_LINE\_ENDINGS\_CERT\_CHAIN    "{}../pems/rsa\_2048\_missing\_line\_endings\_cert.pem"{}}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102 \textcolor{comment}{/* Illegally formatted PEMs */}}
\DoxyCodeLine{103 \textcolor{preprocessor}{\#define S2N\_INVALID\_HEADER\_CERT\_CHAIN   "{}../pems/rsa\_2048\_invalid\_header\_cert.pem"{}}}
\DoxyCodeLine{104 \textcolor{preprocessor}{\#define S2N\_INVALID\_TRAILER\_CERT\_CHAIN  "{}../pems/rsa\_2048\_invalid\_trailer\_cert.pem"{}}}
\DoxyCodeLine{105 \textcolor{preprocessor}{\#define S2N\_UNKNOWN\_KEYWORD\_CERT\_CHAIN  "{}../pems/rsa\_2048\_unknown\_keyword\_cert.pem"{}}}
\DoxyCodeLine{106 \textcolor{preprocessor}{\#define S2N\_INVALID\_HEADER\_KEY          "{}../pems/rsa\_2048\_invalid\_header\_key.pem"{}}}
\DoxyCodeLine{107 \textcolor{preprocessor}{\#define S2N\_INVALID\_TRAILER\_KEY         "{}../pems/rsa\_2048\_invalid\_trailer\_key.pem"{}}}
\DoxyCodeLine{108 \textcolor{preprocessor}{\#define S2N\_UNKNOWN\_KEYWORD\_KEY         "{}../pems/rsa\_2048\_unknown\_keyword\_key.pem"{}}}
\DoxyCodeLine{109 \textcolor{preprocessor}{\#define S2N\_WEIRD\_DASHES\_CERT\_CHAIN     "{}../pems/rsa\_2048\_weird\_dashes\_cert.pem"{}}}
\DoxyCodeLine{110 \textcolor{preprocessor}{\#define S2N\_NO\_DASHES\_CERT\_CHAIN        "{}../pems/rsa\_2048\_no\_dashes\_cert.pem"{}}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 \textcolor{comment}{/* OCSP Stapled Response Testing files */}}
\DoxyCodeLine{113 \textcolor{preprocessor}{\#define S2N\_OCSP\_SERVER\_CERT                   "{}../pems/ocsp/server\_cert.pem"{}}}
\DoxyCodeLine{114 \textcolor{preprocessor}{\#define S2N\_OCSP\_SERVER\_ECDSA\_CERT             "{}../pems/ocsp/server\_ecdsa\_cert.pem"{}}}
\DoxyCodeLine{115 }
\DoxyCodeLine{116 \textcolor{preprocessor}{\#define S2N\_OCSP\_SERVER\_KEY                    "{}../pems/ocsp/server\_key.pem"{}}}
\DoxyCodeLine{117 \textcolor{preprocessor}{\#define S2N\_OCSP\_CA\_CERT                       "{}../pems/ocsp/ca\_cert.pem"{}}}
\DoxyCodeLine{118 \textcolor{preprocessor}{\#define S2N\_OCSP\_CA\_KEY                        "{}../pems/ocsp/ca\_key.pem"{}}}
\DoxyCodeLine{119 \textcolor{preprocessor}{\#define S2N\_OCSP\_RESPONSE\_DER                  "{}../pems/ocsp/ocsp\_response.der"{}}}
\DoxyCodeLine{120 \textcolor{preprocessor}{\#define S2N\_OCSP\_RESPONSE\_NO\_NEXT\_UPDATE\_DER   "{}../pems/ocsp/ocsp\_response\_no\_next\_update.der"{}}}
\DoxyCodeLine{121 \textcolor{preprocessor}{\#define S2N\_OCSP\_RESPONSE\_REVOKED\_DER          "{}../pems/ocsp/ocsp\_response\_revoked.der"{}}}
\DoxyCodeLine{122 \textcolor{preprocessor}{\#define S2N\_OCSP\_RESPONSE\_WRONG\_SIGNER\_DER     "{}../pems/ocsp/ocsp\_response\_wrong\_signer.der"{}}}
\DoxyCodeLine{123 \textcolor{preprocessor}{\#define S2N\_OCSP\_RESPONSE\_CERT                 "{}../pems/ocsp/ocsp\_cert.pem"{}}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125 \textcolor{preprocessor}{\#define S2N\_ALLIGATOR\_SAN\_CERT                 "{}../pems/sni/alligator\_cert.pem"{}}}
\DoxyCodeLine{126 \textcolor{preprocessor}{\#define S2N\_ALLIGATOR\_SAN\_KEY                  "{}../pems/sni/alligator\_key.pem"{}}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \textcolor{preprocessor}{\#define S2N\_DHPARAMS\_2048 "{}../pems/dhparams\_2048.pem"{}}}
\DoxyCodeLine{129 }
\DoxyCodeLine{130 \textcolor{preprocessor}{\#define S2N\_DEFAULT\_TEST\_CERT\_CHAIN  S2N\_RSA\_2048\_PKCS1\_CERT\_CHAIN}}
\DoxyCodeLine{131 \textcolor{preprocessor}{\#define S2N\_DEFAULT\_TEST\_PRIVATE\_KEY S2N\_RSA\_2048\_PKCS1\_KEY}}
\DoxyCodeLine{132 }
\DoxyCodeLine{133 \textcolor{preprocessor}{\#define S2N\_DEFAULT\_ECDSA\_TEST\_CERT\_CHAIN  S2N\_ECDSA\_P384\_PKCS1\_CERT\_CHAIN}}
\DoxyCodeLine{134 \textcolor{preprocessor}{\#define S2N\_DEFAULT\_ECDSA\_TEST\_PRIVATE\_KEY S2N\_ECDSA\_P384\_PKCS1\_KEY}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{preprocessor}{\#define S2N\_DEFAULT\_TEST\_DHPARAMS S2N\_DHPARAMS\_2048}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138 \textcolor{comment}{/* Read a cert given a path into pem\_out */}}
\DoxyCodeLine{139 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a6a406c835d464be9d04b55d3af3765fd}{s2n\_read\_test\_pem}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *pem\_path, \textcolor{keywordtype}{char} *pem\_out, \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} max\_size);}
\DoxyCodeLine{140 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a62c2f85ff73b9790a618eba0abd1df9e}{s2n\_test\_cert\_chain\_and\_key\_new}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cert__chain__and__key}{s2n\_cert\_chain\_and\_key}} **\mbox{\hyperlink{s2n__client__key__recv__fuzz__test_8c_aac2a6f1aab996a327b37797f9c1209ae}{chain\_and\_key}},}
\DoxyCodeLine{141         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *cert\_chain\_file, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *private\_key\_file);}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_af4905cbb179a9a65737d7978e9d6c9a4}{s2n\_negotiate\_test\_server\_and\_client}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *server\_conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *client\_conn);}
\DoxyCodeLine{144 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_ac97ed84daa070d69d256ffcaae35d3fb}{s2n\_shutdown\_test\_server\_and\_client}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *server\_conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *client\_conn);}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a090db03a9c5123b523542919a2a5f8cf}{s2n\_test\_kem\_with\_kat}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kem}{s2n\_kem}} *kem, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *kat\_file);}
\DoxyCodeLine{147 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a5f9f86570bca88a725cd641a60cb2a28}{s2n\_test\_hybrid\_ecdhe\_kem\_with\_kat}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kem}{s2n\_kem}} *kem, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cipher__suite}{s2n\_cipher\_suite}} *cipher\_suite,}
\DoxyCodeLine{148         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *cipher\_pref\_version, \textcolor{keyword}{const} \textcolor{keywordtype}{char} * kat\_file\_name, uint32\_t server\_key\_message\_length,}
\DoxyCodeLine{149         uint32\_t client\_key\_message\_length);}
\DoxyCodeLine{150 }
\DoxyCodeLine{151 \textcolor{comment}{/* Expects 2 s2n\_blobs to be equal (same size and contents) */}}
\DoxyCodeLine{152 \textcolor{preprocessor}{\#define S2N\_BLOB\_EXPECT\_EQUAL( blob1, blob2 ) do \{              \(\backslash\)}}
\DoxyCodeLine{153 \textcolor{preprocessor}{    EXPECT\_EQUAL(blob1.size, blob2.size);                       \(\backslash\)}}
\DoxyCodeLine{154 \textcolor{preprocessor}{    EXPECT\_BYTEARRAY\_EQUAL(blob1.data, blob2.data, blob1.size); \(\backslash\)}}
\DoxyCodeLine{155 \textcolor{preprocessor}{\} while (0)}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157 \textcolor{comment}{/* Expects data of type in stuffer, where type is uint32, uint64 etc.. */}}
\DoxyCodeLine{158 \textcolor{preprocessor}{\#define S2N\_STUFFER\_READ\_EXPECT\_EQUAL( stuffer, expected, type ) do \{ \(\backslash\)}}
\DoxyCodeLine{159 \textcolor{preprocessor}{    type\#\#\_t value;                                                   \(\backslash\)}}
\DoxyCodeLine{160 \textcolor{preprocessor}{    EXPECT\_SUCCESS(s2n\_stuffer\_read\_\#\#type(stuffer, \&value));         \(\backslash\)}}
\DoxyCodeLine{161 \textcolor{preprocessor}{    EXPECT\_EQUAL(value, expected);                                    \(\backslash\)}}
\DoxyCodeLine{162 \textcolor{preprocessor}{\} while (0)}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{comment}{/* Expects written length in stuffer */}}
\DoxyCodeLine{165 \textcolor{preprocessor}{\#define S2N\_STUFFER\_LENGTH\_WRITTEN\_EXPECT\_EQUAL( stuffer, bytes ) do \{ \(\backslash\)}}
\DoxyCodeLine{166 \textcolor{preprocessor}{    EXPECT\_SUCCESS(s2n\_stuffer\_skip\_read(stuffer, bytes));      \(\backslash\)}}
\DoxyCodeLine{167 \textcolor{preprocessor}{    EXPECT\_EQUAL(s2n\_stuffer\_data\_available(stuffer), 0);       \(\backslash\)}}
\DoxyCodeLine{168 \textcolor{preprocessor}{\} while (0)}}
\DoxyCodeLine{169 }
\DoxyCodeLine{170 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a6efb873b95b470e104430ad82823797c}{s2n\_public\_ecc\_keys\_are\_equal}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__ecc__evp__params}{s2n\_ecc\_evp\_params}} *params\_1, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__ecc__evp__params}{s2n\_ecc\_evp\_params}} *params\_2);}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{keyword}{extern} \textcolor{keyword}{const} \mbox{\hyperlink{structs2n__parsed__extension}{s2n\_parsed\_extension}} \mbox{\hyperlink{s2n__testlib_8h_a6a664bdbbd0da59874fa63d9c51395ac}{EMPTY\_PARSED\_EXTENSIONS}}[\mbox{\hyperlink{s2n__extension__list_8h_a72b0df34cf938c67bedcc6285ad294c9}{S2N\_PARSED\_EXTENSIONS\_COUNT}}];}
\DoxyCodeLine{173 \textcolor{preprocessor}{\#define EXPECT\_PARSED\_EXTENSION\_LIST\_EMPTY(list) EXPECT\_BYTEARRAY\_EQUAL(list.parsed\_extensions, EMPTY\_PARSED\_EXTENSIONS, sizeof(EMPTY\_PARSED\_EXTENSIONS))}}
\DoxyCodeLine{174 \textcolor{preprocessor}{\#define EXPECT\_PARSED\_EXTENSION\_LIST\_NOT\_EMPTY(list) EXPECT\_BYTEARRAY\_NOT\_EQUAL(list.parsed\_extensions, EMPTY\_PARSED\_EXTENSIONS, sizeof(EMPTY\_PARSED\_EXTENSIONS))}}
\DoxyCodeLine{175 }
\DoxyCodeLine{176 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a595c8a7f7d8b7fae0a6282c265542c5e}{s2n\_kem\_recv\_public\_key\_fuzz\_test}}(\textcolor{keyword}{const} uint8\_t *\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}, \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kem__params}{s2n\_kem\_params}} *\mbox{\hyperlink{s2n__bike__r1__recv__ciphertext__fuzz__test_8c_aab0dead5ec3d49b6b611891e34170741}{kem\_params}});}
\DoxyCodeLine{177 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a572809525c8d6ede7b2677a020a24b02}{s2n\_kem\_recv\_ciphertext\_fuzz\_test}}(\textcolor{keyword}{const} uint8\_t *\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1fe855c208bc17a51a4d34fefdb2d5b1}{buf}}, \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kem__params}{s2n\_kem\_params}} *\mbox{\hyperlink{s2n__bike__r1__recv__ciphertext__fuzz__test_8c_aab0dead5ec3d49b6b611891e34170741}{kem\_params}});}
\DoxyCodeLine{178 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__testlib_8h_a0a5aa23739c4441a5bee5bb9d6f4ca28}{s2n\_kem\_recv\_ciphertext\_fuzz\_test\_init}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *kat\_file\_path, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kem__params}{s2n\_kem\_params}} *\mbox{\hyperlink{s2n__bike__r1__recv__ciphertext__fuzz__test_8c_aab0dead5ec3d49b6b611891e34170741}{kem\_params}});}

\end{DoxyCode}
