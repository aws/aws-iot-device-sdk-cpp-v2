\hypertarget{s2n__drbg_8h_source}{}\doxysection{s2n\+\_\+drbg.\+h}
\label{s2n__drbg_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_drbg.h@{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_drbg.h}}
\mbox{\hyperlink{s2n__drbg_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <openssl/evp.h>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__hash_8h}{crypto/s2n\_hash.h}}"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}utils/s2n\_blob.h"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}utils/s2n\_result.h"{}}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define S2N\_DRBG\_BLOCK\_SIZE 16}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#define S2N\_DRBG\_MAX\_KEY\_SIZE 32}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#define S2N\_DRBG\_MAX\_SEED\_SIZE (S2N\_DRBG\_BLOCK\_SIZE + S2N\_DRBG\_MAX\_KEY\_SIZE)}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{comment}{/* The maximum size of any one request: from NIST SP800-\/90A 10.2.1 Table 3 */}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#define S2N\_DRBG\_GENERATE\_LIMIT 8192}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{comment}{/* We reseed after 2\string^35 bytes have been generated: from NIST SP800-\/90A 10.2.1 Table 3 */}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#define S2N\_DRBG\_RESEED\_LIMIT   34359738368}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__drbg}{s2n\_drbg}} \{}
\DoxyCodeLine{35     \textcolor{comment}{/* Track how many bytes have been used */}}
\DoxyCodeLine{36     uint64\_t \mbox{\hyperlink{structs2n__drbg_a7ed373639dfea5219d4902fb2a25602f}{bytes\_used}};}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     EVP\_CIPHER\_CTX *\mbox{\hyperlink{structs2n__drbg_a86809ad6f07871f57c0807f993ca3ca3}{ctx}};}
\DoxyCodeLine{39 }
\DoxyCodeLine{40     \textcolor{comment}{/* The current DRBG 'value' */}}
\DoxyCodeLine{41     uint8\_t \mbox{\hyperlink{structs2n__drbg_a03dcdc422f94f0159b2a8fd7a5502a43}{v}}[\mbox{\hyperlink{s2n__drbg_8h_a74d3844503fa6b8393fe438719d4d621}{S2N\_DRBG\_BLOCK\_SIZE}}];}
\DoxyCodeLine{42 }
\DoxyCodeLine{43     \textcolor{comment}{/* Used only by the unit tests: how many times has entropy been mixed in */}}
\DoxyCodeLine{44     uint64\_t \mbox{\hyperlink{structs2n__drbg_ad0cda9a3d17d0977f6467a1102a42e59}{mixes}};}
\DoxyCodeLine{45 \};}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \textcolor{comment}{/*}}
\DoxyCodeLine{48 \textcolor{comment}{ * S2N\_AES\_128\_CTR\_NO\_DF\_PR is a deterministic random bit generator using AES 128 in counter mode (AES\_128\_CTR). It does not}}
\DoxyCodeLine{49 \textcolor{comment}{ * use a derivation function (NO\_DF) on the seed but does have prediction resistance (PR).}}
\DoxyCodeLine{50 \textcolor{comment}{ *}}
\DoxyCodeLine{51 \textcolor{comment}{ * S2N\_AES\_256\_CTR\_NO\_DF\_PR is a deterministic random bit generator using AES 256 in counter mode (AES\_128\_CTR). It does not}}
\DoxyCodeLine{52 \textcolor{comment}{ * use a derivation function on the seed but does have prediction resistance.}}
\DoxyCodeLine{53 \textcolor{comment}{ */}}
\DoxyCodeLine{54 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{\mbox{\hyperlink{s2n__drbg_8h_a73f6f4cdb4824dea73b369d606010f37a1bf82507475b67b3b521d0aeced92028}{S2N\_AES\_128\_CTR\_NO\_DF\_PR}}, \mbox{\hyperlink{s2n__drbg_8h_a73f6f4cdb4824dea73b369d606010f37aac294c6931c88200e3018a55638245f6}{S2N\_AES\_256\_CTR\_NO\_DF\_PR}}\} \mbox{\hyperlink{s2n__drbg_8h_a73f6f4cdb4824dea73b369d606010f37}{s2n\_drbg\_mode}};}
\DoxyCodeLine{55 }
\DoxyCodeLine{56 \textcolor{comment}{/* Per NIST SP 800-\/90C 6.3}}
\DoxyCodeLine{57 \textcolor{comment}{ *}}
\DoxyCodeLine{58 \textcolor{comment}{ * s2n's DRBG does provide prediction resistance}}
\DoxyCodeLine{59 \textcolor{comment}{ * and does not support the additional\_input parameter (which per 800-\/90C may be zero).}}
\DoxyCodeLine{60 \textcolor{comment}{ *}}
\DoxyCodeLine{61 \textcolor{comment}{  * The security strength provided by s2n's DRBG is either 128 or 256 bits depending on the s2n\_drbg\_mode passed in.}}
\DoxyCodeLine{62 \textcolor{comment}{ */}}
\DoxyCodeLine{63 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__drbg_8h_aaddf30a3efa9f5a82906baa37cc89957}{s2n\_drbg\_instantiate}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__drbg}{s2n\_drbg}} *drbg, \textcolor{keyword}{struct} s2n\_blob *personalization\_string, \textcolor{keyword}{const} \mbox{\hyperlink{s2n__drbg_8h_a73f6f4cdb4824dea73b369d606010f37}{s2n\_drbg\_mode}} mode);}
\DoxyCodeLine{64 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__drbg_8h_ad4cdf82519f0ee79c8b92ed0fc1db349}{s2n\_drbg\_generate}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__drbg}{s2n\_drbg}} *drbg, \textcolor{keyword}{struct} s2n\_blob *returned\_bits);}
\DoxyCodeLine{65 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__drbg_8h_a4ce9d0f91b5ddb06f136bd1029e88f15}{s2n\_drbg\_wipe}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__drbg}{s2n\_drbg}} *drbg);}
\DoxyCodeLine{66 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__drbg_8h_a0260b5f9c83b348b295782ef6ad61ec3}{s2n\_drbg\_bytes\_used}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__drbg}{s2n\_drbg}} *drbg, uint64\_t *bytes\_used);}

\end{DoxyCode}
