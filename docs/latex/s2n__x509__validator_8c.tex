\hypertarget{s2n__x509__validator_8c}{}\doxysection{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\+\_\+x509\+\_\+validator.c File Reference}
\label{s2n__x509__validator_8c}\index{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_x509\_validator.c@{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_x509\_validator.c}}
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+openssl.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+openssl\+\_\+x509.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+asn1\+\_\+time.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+result.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+safety.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+rfc5952.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls/extensions/s2n\+\_\+extension\+\_\+list.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+connection.\+h\char`\"{}}\newline
{\ttfamily \#include $<$arpa/inet.\+h$>$}\newline
{\ttfamily \#include $<$sys/socket.\+h$>$}\newline
{\ttfamily \#include $<$openssl/err.\+h$>$}\newline
{\ttfamily \#include $<$openssl/asn1.\+h$>$}\newline
{\ttfamily \#include $<$openssl/ocsp.\+h$>$}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{s2n__x509__validator_8c_a471f0fe074ef5c1620ad661086249dbb}{X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+PARTIAL\+\_\+\+CHAIN}}~0x80000
\item 
\#define \mbox{\hyperlink{s2n__x509__validator_8c_ad0b0a7ec728adf09e312a414898a5ff1}{DEFAULT\+\_\+\+MAX\+\_\+\+CHAIN\+\_\+\+DEPTH}}~7
\item 
\#define \mbox{\hyperlink{s2n__x509__validator_8c_a9d4d7f73e12c4a07000db10fa16033b1}{DEFAULT\+\_\+\+OCSP\+\_\+\+NEXT\+\_\+\+UPDATE\+\_\+\+PERIOD}}~3600000000000
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffc}{validator\+\_\+state}} \{ \mbox{\hyperlink{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca2a68f51b73db179a30b6a8aea11f7485}{UNINIT}}
, \mbox{\hyperlink{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca0cb1b2c6a7db1f1084886c98909a3f36}{INIT}}
, \mbox{\hyperlink{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca8daa9f7da396ee1daa4747035feff4ec}{VALIDATED}}
, \mbox{\hyperlink{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca0ee8a0c210661d337874478738885da9}{OCSP\+\_\+\+VALIDATED}}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \mbox{\hyperlink{s2n__x509__validator_8c_a288e4c79746a86e09ee8a398bb14c512}{s2n\+\_\+x509\+\_\+ocsp\+\_\+stapling\+\_\+supported}} (void)
\item 
void \mbox{\hyperlink{s2n__x509__validator_8c_a9420691912d2b27885e752cf5e3a255d}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+init\+\_\+empty}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store)
\item 
uint8\+\_\+t \mbox{\hyperlink{s2n__x509__validator_8c_ab79d51c6a30bb86a6ff1ac773d0e38ea}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+has\+\_\+certs}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8c_ab1f058ecf0f93d94b6eecb634050be58}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+from\+\_\+system\+\_\+defaults}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8c_a9d1721ad7ba85938d51914e70ab93d64}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+add\+\_\+pem}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store, const char $\ast$pem)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8c_a02f94f7855f8de1ba96cf0358ec9d69d}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+from\+\_\+ca\+\_\+file}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store, const char $\ast$ca\+\_\+pem\+\_\+filename, const char $\ast$ca\+\_\+dir)
\item 
void \mbox{\hyperlink{s2n__x509__validator_8c_ad80262ea13eecda7dbec5812576dc732}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+wipe}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8c_a3c01448c0eba6f3da070efca52a9beb1}{s2n\+\_\+x509\+\_\+validator\+\_\+init\+\_\+no\+\_\+x509\+\_\+validation}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8c_a14de21f9d6b7b411e1eee66a98d64feb}{s2n\+\_\+x509\+\_\+validator\+\_\+init}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$trust\+\_\+store, uint8\+\_\+t check\+\_\+ocsp)
\item 
static void \mbox{\hyperlink{s2n__x509__validator_8c_a2bb65909f7e2156383aeb1c9d03b49c8}{wipe\+\_\+cert\+\_\+chain}} (STACK\+\_\+\+OF(X509) $\ast$\mbox{\hyperlink{s2n__tls13__cert__verify__recv__test_8c_aaed4d7a47677e806a98bdad84cc812ba}{cert\+\_\+chain}})
\item 
void \mbox{\hyperlink{s2n__x509__validator_8c_a7a9cb1ed3f0786296ad988185adce278}{s2n\+\_\+x509\+\_\+validator\+\_\+wipe}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8c_ae4f3e82ce716b7f639c01dfa333c5b10}{s2n\+\_\+x509\+\_\+validator\+\_\+set\+\_\+max\+\_\+chain\+\_\+depth}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, uint16\+\_\+t max\+\_\+depth)
\item 
static uint8\+\_\+t \mbox{\hyperlink{s2n__x509__validator_8c_ade587be2414188b349cb89c0b94b4b1c}{s2n\+\_\+verify\+\_\+host\+\_\+information}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, X509 $\ast$public\+\_\+cert)
\item 
\mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} \mbox{\hyperlink{s2n__x509__validator_8c_a3f135290f89f1c43d55f9b7667543aca}{s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+chain}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, uint8\+\_\+t $\ast$cert\+\_\+chain\+\_\+in, uint32\+\_\+t cert\+\_\+chain\+\_\+len, \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\+\_\+pkey\+\_\+type}} $\ast$pkey\+\_\+type, struct \mbox{\hyperlink{structs2n__pkey}{s2n\+\_\+pkey}} $\ast$public\+\_\+key\+\_\+out)
\item 
\mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} \mbox{\hyperlink{s2n__x509__validator_8c_a0ed4a60b0e3393d1c7d0fb0399a348f6}{s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+stapled\+\_\+ocsp\+\_\+response}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, const uint8\+\_\+t $\ast$ocsp\+\_\+response\+\_\+raw, uint32\+\_\+t ocsp\+\_\+response\+\_\+length)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{s2n__x509__validator_8c_ad0b0a7ec728adf09e312a414898a5ff1}\label{s2n__x509__validator_8c_ad0b0a7ec728adf09e312a414898a5ff1}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!DEFAULT\_MAX\_CHAIN\_DEPTH@{DEFAULT\_MAX\_CHAIN\_DEPTH}}
\index{DEFAULT\_MAX\_CHAIN\_DEPTH@{DEFAULT\_MAX\_CHAIN\_DEPTH}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{DEFAULT\_MAX\_CHAIN\_DEPTH}{DEFAULT\_MAX\_CHAIN\_DEPTH}}
{\footnotesize\ttfamily \#define DEFAULT\+\_\+\+MAX\+\_\+\+CHAIN\+\_\+\+DEPTH~7}

\mbox{\Hypertarget{s2n__x509__validator_8c_a9d4d7f73e12c4a07000db10fa16033b1}\label{s2n__x509__validator_8c_a9d4d7f73e12c4a07000db10fa16033b1}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!DEFAULT\_OCSP\_NEXT\_UPDATE\_PERIOD@{DEFAULT\_OCSP\_NEXT\_UPDATE\_PERIOD}}
\index{DEFAULT\_OCSP\_NEXT\_UPDATE\_PERIOD@{DEFAULT\_OCSP\_NEXT\_UPDATE\_PERIOD}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{DEFAULT\_OCSP\_NEXT\_UPDATE\_PERIOD}{DEFAULT\_OCSP\_NEXT\_UPDATE\_PERIOD}}
{\footnotesize\ttfamily \#define DEFAULT\+\_\+\+OCSP\+\_\+\+NEXT\+\_\+\+UPDATE\+\_\+\+PERIOD~3600000000000}

\mbox{\Hypertarget{s2n__x509__validator_8c_a471f0fe074ef5c1620ad661086249dbb}\label{s2n__x509__validator_8c_a471f0fe074ef5c1620ad661086249dbb}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!X509\_V\_FLAG\_PARTIAL\_CHAIN@{X509\_V\_FLAG\_PARTIAL\_CHAIN}}
\index{X509\_V\_FLAG\_PARTIAL\_CHAIN@{X509\_V\_FLAG\_PARTIAL\_CHAIN}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{X509\_V\_FLAG\_PARTIAL\_CHAIN}{X509\_V\_FLAG\_PARTIAL\_CHAIN}}
{\footnotesize\ttfamily \#define X509\+\_\+\+V\+\_\+\+FLAG\+\_\+\+PARTIAL\+\_\+\+CHAIN~0x80000}



\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffc}\label{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffc}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!validator\_state@{validator\_state}}
\index{validator\_state@{validator\_state}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{validator\_state}{validator\_state}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffc}{validator\+\_\+state}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{UNINIT@{UNINIT}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!UNINIT@{UNINIT}}}\mbox{\Hypertarget{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca2a68f51b73db179a30b6a8aea11f7485}\label{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca2a68f51b73db179a30b6a8aea11f7485}} 
UNINIT&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{INIT@{INIT}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!INIT@{INIT}}}\mbox{\Hypertarget{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca0cb1b2c6a7db1f1084886c98909a3f36}\label{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca0cb1b2c6a7db1f1084886c98909a3f36}} 
INIT&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{VALIDATED@{VALIDATED}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!VALIDATED@{VALIDATED}}}\mbox{\Hypertarget{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca8daa9f7da396ee1daa4747035feff4ec}\label{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca8daa9f7da396ee1daa4747035feff4ec}} 
VALIDATED&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{OCSP\_VALIDATED@{OCSP\_VALIDATED}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!OCSP\_VALIDATED@{OCSP\_VALIDATED}}}\mbox{\Hypertarget{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca0ee8a0c210661d337874478738885da9}\label{s2n__x509__validator_8c_abfd35f225f4b7fc495ebb1c5f7976ffca0ee8a0c210661d337874478738885da9}} 
OCSP\+\_\+\+VALIDATED&\\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{s2n__x509__validator_8c_ade587be2414188b349cb89c0b94b4b1c}\label{s2n__x509__validator_8c_ade587be2414188b349cb89c0b94b4b1c}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_verify\_host\_information@{s2n\_verify\_host\_information}}
\index{s2n\_verify\_host\_information@{s2n\_verify\_host\_information}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_verify\_host\_information()}{s2n\_verify\_host\_information()}}
{\footnotesize\ttfamily static uint8\+\_\+t s2n\+\_\+verify\+\_\+host\+\_\+information (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{X509 $\ast$}]{public\+\_\+cert }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__x509__validator_8c_a288e4c79746a86e09ee8a398bb14c512}\label{s2n__x509__validator_8c_a288e4c79746a86e09ee8a398bb14c512}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_ocsp\_stapling\_supported@{s2n\_x509\_ocsp\_stapling\_supported}}
\index{s2n\_x509\_ocsp\_stapling\_supported@{s2n\_x509\_ocsp\_stapling\_supported}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_ocsp\_stapling\_supported()}{s2n\_x509\_ocsp\_stapling\_supported()}}
{\footnotesize\ttfamily uint8\+\_\+t s2n\+\_\+x509\+\_\+ocsp\+\_\+stapling\+\_\+supported (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Some libcrypto implementations do not support OCSP validation. Returns 1 if supported, 0 otherwise. \mbox{\Hypertarget{s2n__x509__validator_8c_a9d1721ad7ba85938d51914e70ab93d64}\label{s2n__x509__validator_8c_a9d1721ad7ba85938d51914e70ab93d64}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_trust\_store\_add\_pem@{s2n\_x509\_trust\_store\_add\_pem}}
\index{s2n\_x509\_trust\_store\_add\_pem@{s2n\_x509\_trust\_store\_add\_pem}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_add\_pem()}{s2n\_x509\_trust\_store\_add\_pem()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+add\+\_\+pem (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store,  }\item[{const char $\ast$}]{pem }\end{DoxyParamCaption})}

Initialize trust store from a PEM. This will allocate memory, and load PEM into the Trust Store \mbox{\Hypertarget{s2n__x509__validator_8c_a02f94f7855f8de1ba96cf0358ec9d69d}\label{s2n__x509__validator_8c_a02f94f7855f8de1ba96cf0358ec9d69d}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_trust\_store\_from\_ca\_file@{s2n\_x509\_trust\_store\_from\_ca\_file}}
\index{s2n\_x509\_trust\_store\_from\_ca\_file@{s2n\_x509\_trust\_store\_from\_ca\_file}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_from\_ca\_file()}{s2n\_x509\_trust\_store\_from\_ca\_file()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+from\+\_\+ca\+\_\+file (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store,  }\item[{const char $\ast$}]{ca\+\_\+pem\+\_\+filename,  }\item[{const char $\ast$}]{ca\+\_\+dir }\end{DoxyParamCaption})}

Initialize trust store from a CA file. This will allocate memory, and load each cert in the file into the trust store Returns 0 on success, or S2N error codes on failure. \mbox{\Hypertarget{s2n__x509__validator_8c_ab1f058ecf0f93d94b6eecb634050be58}\label{s2n__x509__validator_8c_ab1f058ecf0f93d94b6eecb634050be58}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_trust\_store\_from\_system\_defaults@{s2n\_x509\_trust\_store\_from\_system\_defaults}}
\index{s2n\_x509\_trust\_store\_from\_system\_defaults@{s2n\_x509\_trust\_store\_from\_system\_defaults}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_from\_system\_defaults()}{s2n\_x509\_trust\_store\_from\_system\_defaults()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+from\+\_\+system\+\_\+defaults (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store }\end{DoxyParamCaption})}

Initializes the trust store to default system paths \mbox{\Hypertarget{s2n__x509__validator_8c_ab79d51c6a30bb86a6ff1ac773d0e38ea}\label{s2n__x509__validator_8c_ab79d51c6a30bb86a6ff1ac773d0e38ea}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_trust\_store\_has\_certs@{s2n\_x509\_trust\_store\_has\_certs}}
\index{s2n\_x509\_trust\_store\_has\_certs@{s2n\_x509\_trust\_store\_has\_certs}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_has\_certs()}{s2n\_x509\_trust\_store\_has\_certs()}}
{\footnotesize\ttfamily uint8\+\_\+t s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+has\+\_\+certs (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store }\end{DoxyParamCaption})}

Returns TRUE if the trust store has certificates installed, FALSE otherwise \mbox{\Hypertarget{s2n__x509__validator_8c_a9420691912d2b27885e752cf5e3a255d}\label{s2n__x509__validator_8c_a9420691912d2b27885e752cf5e3a255d}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_trust\_store\_init\_empty@{s2n\_x509\_trust\_store\_init\_empty}}
\index{s2n\_x509\_trust\_store\_init\_empty@{s2n\_x509\_trust\_store\_init\_empty}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_init\_empty()}{s2n\_x509\_trust\_store\_init\_empty()}}
{\footnotesize\ttfamily void s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+init\+\_\+empty (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store }\end{DoxyParamCaption})}

Initialize the trust store to empty defaults (no allocations happen here) \mbox{\Hypertarget{s2n__x509__validator_8c_ad80262ea13eecda7dbec5812576dc732}\label{s2n__x509__validator_8c_ad80262ea13eecda7dbec5812576dc732}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_trust\_store\_wipe@{s2n\_x509\_trust\_store\_wipe}}
\index{s2n\_x509\_trust\_store\_wipe@{s2n\_x509\_trust\_store\_wipe}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_wipe()}{s2n\_x509\_trust\_store\_wipe()}}
{\footnotesize\ttfamily void s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+wipe (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store }\end{DoxyParamCaption})}

Cleans up, and frees any underlying memory in the trust store. \mbox{\Hypertarget{s2n__x509__validator_8c_a14de21f9d6b7b411e1eee66a98d64feb}\label{s2n__x509__validator_8c_a14de21f9d6b7b411e1eee66a98d64feb}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_validator\_init@{s2n\_x509\_validator\_init}}
\index{s2n\_x509\_validator\_init@{s2n\_x509\_validator\_init}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_init()}{s2n\_x509\_validator\_init()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+validator\+\_\+init (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{trust\+\_\+store,  }\item[{uint8\+\_\+t}]{check\+\_\+ocsp }\end{DoxyParamCaption})}

Initialize the validator in safe mode. Will use trust store to validate x.\+509 cerficiates, ocsp responses, and will call the verify host callback to determine if a subject name or alternative name from the cert should be trusted. Returns 0 on success, and an S2\+N\+\_\+\+ERR\+\_\+$\ast$ on failure. \mbox{\Hypertarget{s2n__x509__validator_8c_a3c01448c0eba6f3da070efca52a9beb1}\label{s2n__x509__validator_8c_a3c01448c0eba6f3da070efca52a9beb1}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_validator\_init\_no\_x509\_validation@{s2n\_x509\_validator\_init\_no\_x509\_validation}}
\index{s2n\_x509\_validator\_init\_no\_x509\_validation@{s2n\_x509\_validator\_init\_no\_x509\_validation}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_init\_no\_x509\_validation()}{s2n\_x509\_validator\_init\_no\_x509\_validation()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+validator\+\_\+init\+\_\+no\+\_\+x509\+\_\+validation (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator }\end{DoxyParamCaption})}

Initialize the validator in unsafe mode. No validity checks for OCSP, host checks, or X.\+509 will be performed. \mbox{\Hypertarget{s2n__x509__validator_8c_ae4f3e82ce716b7f639c01dfa333c5b10}\label{s2n__x509__validator_8c_ae4f3e82ce716b7f639c01dfa333c5b10}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_validator\_set\_max\_chain\_depth@{s2n\_x509\_validator\_set\_max\_chain\_depth}}
\index{s2n\_x509\_validator\_set\_max\_chain\_depth@{s2n\_x509\_validator\_set\_max\_chain\_depth}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_set\_max\_chain\_depth()}{s2n\_x509\_validator\_set\_max\_chain\_depth()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+validator\+\_\+set\+\_\+max\+\_\+chain\+\_\+depth (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{uint16\+\_\+t}]{max\+\_\+depth }\end{DoxyParamCaption})}

Sets the maximum depth for a cert chain that can be used at validation. \mbox{\Hypertarget{s2n__x509__validator_8c_a3f135290f89f1c43d55f9b7667543aca}\label{s2n__x509__validator_8c_a3f135290f89f1c43d55f9b7667543aca}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_validator\_validate\_cert\_chain@{s2n\_x509\_validator\_validate\_cert\_chain}}
\index{s2n\_x509\_validator\_validate\_cert\_chain@{s2n\_x509\_validator\_validate\_cert\_chain}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_validate\_cert\_chain()}{s2n\_x509\_validator\_validate\_cert\_chain()}}
{\footnotesize\ttfamily \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+chain (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{uint8\+\_\+t $\ast$}]{cert\+\_\+chain\+\_\+in,  }\item[{uint32\+\_\+t}]{cert\+\_\+chain\+\_\+len,  }\item[{\mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\+\_\+pkey\+\_\+type}} $\ast$}]{pkey\+\_\+type,  }\item[{struct \mbox{\hyperlink{structs2n__pkey}{s2n\+\_\+pkey}} $\ast$}]{public\+\_\+key\+\_\+out }\end{DoxyParamCaption})}

Validates a certificate chain against the configured trust store in safe mode. In unsafe mode, it will find the public key and return it but not validate the certificates. Alternative Names and Subject Name will be passed to the host verification callback. The verification callback will be possibly called multiple times depending on how many names are found. If any of those calls return TRUE, that stage of the validation will continue, otherwise once all names are tried and none matched as trusted, the chain will be considered UNTRUSTED.

This function can only be called once per instance of an \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}}. If must be called prior to calling \mbox{\hyperlink{s2n__x509__validator_8h_aac701ea2519babd138e34ee9089f8a6f}{s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+stapled\+\_\+ocsp\+\_\+response()}}. \mbox{\Hypertarget{s2n__x509__validator_8c_a0ed4a60b0e3393d1c7d0fb0399a348f6}\label{s2n__x509__validator_8c_a0ed4a60b0e3393d1c7d0fb0399a348f6}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response@{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response}}
\index{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response@{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response()}{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response()}}
{\footnotesize\ttfamily \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+stapled\+\_\+ocsp\+\_\+response (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{const uint8\+\_\+t $\ast$}]{ocsp\+\_\+response,  }\item[{uint32\+\_\+t}]{size }\end{DoxyParamCaption})}

Validates an ocsp response against the most recent certificate chain. Also verifies the timestamps on the response. This function can only be called once per instance of an \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} and only after a successful call to \mbox{\hyperlink{s2n__x509__validator_8h_a3f135290f89f1c43d55f9b7667543aca}{s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+chain()}}. \mbox{\Hypertarget{s2n__x509__validator_8c_a7a9cb1ed3f0786296ad988185adce278}\label{s2n__x509__validator_8c_a7a9cb1ed3f0786296ad988185adce278}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!s2n\_x509\_validator\_wipe@{s2n\_x509\_validator\_wipe}}
\index{s2n\_x509\_validator\_wipe@{s2n\_x509\_validator\_wipe}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_wipe()}{s2n\_x509\_validator\_wipe()}}
{\footnotesize\ttfamily void s2n\+\_\+x509\+\_\+validator\+\_\+wipe (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator }\end{DoxyParamCaption})}

Cleans up underlying memory and data members. Struct can be reused afterwards. \mbox{\Hypertarget{s2n__x509__validator_8c_a2bb65909f7e2156383aeb1c9d03b49c8}\label{s2n__x509__validator_8c_a2bb65909f7e2156383aeb1c9d03b49c8}} 
\index{s2n\_x509\_validator.c@{s2n\_x509\_validator.c}!wipe\_cert\_chain@{wipe\_cert\_chain}}
\index{wipe\_cert\_chain@{wipe\_cert\_chain}!s2n\_x509\_validator.c@{s2n\_x509\_validator.c}}
\doxysubsubsection{\texorpdfstring{wipe\_cert\_chain()}{wipe\_cert\_chain()}}
{\footnotesize\ttfamily static void wipe\+\_\+cert\+\_\+chain (\begin{DoxyParamCaption}\item[{STACK\+\_\+\+OF(X509) $\ast$}]{cert\+\_\+chain }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}

