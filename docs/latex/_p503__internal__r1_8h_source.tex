\hypertarget{_p503__internal__r1_8h_source}{}\doxysection{P503\+\_\+internal\+\_\+r1.\+h}
\label{_p503__internal__r1_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/pq-\/crypto/sike\_r1/P503\_internal\_r1.h@{crt/aws-\/crt-\/cpp/crt/s2n/pq-\/crypto/sike\_r1/P503\_internal\_r1.h}}
\mbox{\hyperlink{_p503__internal__r1_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/********************************************************************************************}}
\DoxyCodeLine{2 \textcolor{comment}{* Supersingular Isogeny Key Encapsulation Library}}
\DoxyCodeLine{3 \textcolor{comment}{*}}
\DoxyCodeLine{4 \textcolor{comment}{* Abstract: internal header file for P503}}
\DoxyCodeLine{5 \textcolor{comment}{*********************************************************************************************/}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#ifndef \_\_P503\_INTERNAL\_H\_\_}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#define \_\_P503\_INTERNAL\_H\_\_}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{sike__r1__namespace_8h}{sike\_r1\_namespace.h}}"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{api__r1_8h}{api\_r1.h}}"{}}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#if (TARGET == TARGET\_AMD64)}}
\DoxyCodeLine{14 \textcolor{preprocessor}{    \#define NWORDS\_FIELD    8               }\textcolor{comment}{// Number of words of a 503-\/bit field element}}
\DoxyCodeLine{15 \textcolor{preprocessor}{    \#define p503\_ZERO\_WORDS 3               }\textcolor{comment}{// Number of "{}0"{} digits in the least significant part of p503 + 1}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#elif (TARGET == TARGET\_x86)}}
\DoxyCodeLine{17 \textcolor{preprocessor}{    \#define NWORDS\_FIELD    16}}
\DoxyCodeLine{18 \textcolor{preprocessor}{    \#define p503\_ZERO\_WORDS 7}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#elif (TARGET == TARGET\_ARM)}}
\DoxyCodeLine{20 \textcolor{preprocessor}{    \#define NWORDS\_FIELD    16}}
\DoxyCodeLine{21 \textcolor{preprocessor}{    \#define p503\_ZERO\_WORDS 7}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#elif (TARGET == TARGET\_ARM64)}}
\DoxyCodeLine{23 \textcolor{preprocessor}{    \#define NWORDS\_FIELD    8}}
\DoxyCodeLine{24 \textcolor{preprocessor}{    \#define p503\_ZERO\_WORDS 3}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{comment}{// Basic constants}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#define NBITS\_FIELD             503}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#define MAXBITS\_FIELD           512}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#define MAXWORDS\_FIELD          ((MAXBITS\_FIELD+RADIX-\/1)/RADIX)     }\textcolor{comment}{// Max. number of words to represent field elements}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#define NWORDS64\_FIELD          ((NBITS\_FIELD+63)/64)               }\textcolor{comment}{// Number of 64-\/bit words of a 503-\/bit field element}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#define NBITS\_ORDER             256}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#define NWORDS\_ORDER            ((NBITS\_ORDER+RADIX-\/1)/RADIX)       }\textcolor{comment}{// Number of words of oA and oB, where oA and oB are the subgroup orders of Alice and Bob, resp.}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#define NWORDS64\_ORDER          ((NBITS\_ORDER+63)/64)               }\textcolor{comment}{// Number of 64-\/bit words of a 256-\/bit element}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#define MAXBITS\_ORDER           NBITS\_ORDER}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#define MAXWORDS\_ORDER          ((MAXBITS\_ORDER+RADIX-\/1)/RADIX)     }\textcolor{comment}{// Max. number of words to represent elements in [1, oA-\/1] or [1, oB].}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#define ALICE                   0}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#define BOB                     1}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#define OALICE\_BITS             250}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#define OBOB\_BITS               253}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#define OBOB\_EXPON              159}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#define MASK\_ALICE              0x03}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#define MASK\_BOB                0x0F}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#define PRIME                   p503}}
\DoxyCodeLine{46 \textcolor{preprocessor}{\#define PARAM\_A                 0}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#define PARAM\_C                 1}}
\DoxyCodeLine{48 \textcolor{comment}{// Fixed parameters for isogeny tree computation}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#define MAX\_INT\_POINTS\_ALICE    7}}
\DoxyCodeLine{50 \textcolor{preprocessor}{\#define MAX\_INT\_POINTS\_BOB      8}}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#define MAX\_Alice               125}}
\DoxyCodeLine{52 \textcolor{preprocessor}{\#define MAX\_Bob                 159}}
\DoxyCodeLine{53 \textcolor{preprocessor}{\#define MSG\_BYTES               24}}
\DoxyCodeLine{54 \textcolor{preprocessor}{\#define SECRETKEY\_A\_BYTES       (OALICE\_BITS + 7) / 8}}
\DoxyCodeLine{55 \textcolor{preprocessor}{\#define SECRETKEY\_B\_BYTES       (OBOB\_BITS + 7) / 8}}
\DoxyCodeLine{56 \textcolor{preprocessor}{\#define FP2\_ENCODED\_BYTES       2*((NBITS\_FIELD + 7) / 8)}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 }
\DoxyCodeLine{59 \textcolor{comment}{// SIDH's basic element definitions and point representations}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61 \textcolor{keyword}{typedef} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}}[\mbox{\hyperlink{_p503__internal__r1_8h_a845fbff3d62178842cd6697c6bff0e88}{NWORDS\_FIELD}}];                                 \textcolor{comment}{// Datatype for representing 503-\/bit field elements (512-\/bit max.)}}
\DoxyCodeLine{62 \textcolor{keyword}{typedef} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} \mbox{\hyperlink{_p503__internal__r1_8h_a0a9b40e430ec0717b4266fbe825ef6f6}{dfelm\_t}}[2*\mbox{\hyperlink{_p503__internal__r1_8h_a845fbff3d62178842cd6697c6bff0e88}{NWORDS\_FIELD}}];                              \textcolor{comment}{// Datatype for representing double-\/precision 2x503-\/bit field elements (512-\/bit max.)}}
\DoxyCodeLine{63 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{structfelm__s}{felm\_s}}}
\DoxyCodeLine{64 \{}
\DoxyCodeLine{65     \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{structfelm__s_a7b82fb9a347bc360342b028eaecb028a}{e}}[2];}
\DoxyCodeLine{66 \} \mbox{\hyperlink{_p503__internal__r1_8h_a129bf71adc2a56efba66b0ffb21894a3}{f2elm\_t}}; \textcolor{comment}{// Datatype for representing quadratic extension field elements GF(p503\string^2)}}
\DoxyCodeLine{67 \textcolor{keyword}{typedef} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} \mbox{\hyperlink{_p503__internal__r1_8h_a34f8299b22a92798da3f6371234e3513}{publickey\_t}}[3];                                       \textcolor{comment}{// Datatype for representing public keys equivalent to three GF(p503\string^2) elements}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{ \mbox{\hyperlink{structfelm__s}{f2elm\_t}} \mbox{\hyperlink{structpoint__proj_aa86b0425fac42d908f34f2bc6c4ec277}{X}}; \mbox{\hyperlink{structfelm__s}{f2elm\_t}} Z; \} \mbox{\hyperlink{structpoint__proj}{point\_proj}};                  \textcolor{comment}{// Point representation in projective XZ Montgomery coordinates.}}
\DoxyCodeLine{70 \textcolor{keyword}{typedef} \mbox{\hyperlink{structpoint__proj}{point\_proj}} \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}}[1];}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 }
\DoxyCodeLine{73 }
\DoxyCodeLine{74 \textcolor{comment}{/**************** Function prototypes ****************/}}
\DoxyCodeLine{75 \textcolor{comment}{/************* Multiprecision functions **************/}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 \textcolor{comment}{// Copy wordsize digits, c = a, where lng(a) = nwords}}
\DoxyCodeLine{78 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_adc2332c660d241ff0a02f501d6ac3012}{copy\_words}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nwords);}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{comment}{// Multiprecision addition, c = a+b, where lng(a) = lng(b) = nwords. Returns the carry bit}}
\DoxyCodeLine{81 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{_p503__internal__r1_8h_a4401f7c09fd1e9219781e513fcb79359}{mp\_add}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nwords);}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{comment}{// 503-\/bit multiprecision addition, c = a+b}}
\DoxyCodeLine{84 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a25b56b90d5dd12242326a78e64133a80}{mp\_add503}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{85 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a4dd98d92e43a1cd0199d26b7082130bc}{mp\_add503\_asm}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{86 \textcolor{comment}{//void mp\_addmask503\_asm(const digit\_t* a, const digit\_t mask, digit\_t* c);}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88 \textcolor{comment}{// 2x503-\/bit multiprecision addition, c = a+b}}
\DoxyCodeLine{89 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a4129d094f48653e43efdb024f5aa8cf3}{mp\_add503x2}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{90 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a3cf7698946ddc8c4c66eb3f89f4c82a1}{mp\_add503x2\_asm}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{comment}{// Multiprecision subtraction, c = a-\/b, where lng(a) = lng(b) = nwords. Returns the borrow bit}}
\DoxyCodeLine{93 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{_p503__internal__r1_8h_a695a1bdbd239590a7f2e7640fae1131d}{mp\_sub}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nwords);}
\DoxyCodeLine{94 \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} \mbox{\hyperlink{_p503__internal__r1_8h_a0330181cbc3d54c4e6ec596647398997}{mp\_sub503x2\_asm}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{comment}{// Multiprecision right shift by one}}
\DoxyCodeLine{97 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a95cc5c62f07490dd1dd1310723fb8b0c}{mp\_shiftr1}}(\mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* x, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nwords);}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 \textcolor{comment}{// Digit multiplication, digit * digit -\/> 2-\/digit result}}
\DoxyCodeLine{100 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a3da4a7c5fab5cdf5f87a96861bf227d4}{digit\_x\_digit}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{101 }
\DoxyCodeLine{102 \textcolor{comment}{// Multiprecision comba multiply, c = a*b, where lng(a) = lng(b) = nwords.}}
\DoxyCodeLine{103 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a975d9b2adad9084bcb435e636fc780bd}{mp\_mul}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nwords);}
\DoxyCodeLine{104 }
\DoxyCodeLine{105 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_adeaf521a9c7cbb5f8df5247526d726de}{multiply}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nwords);}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{comment}{// Montgomery multiplication modulo the group order, mc = ma*mb*r' mod order, where ma,mb,mc in [0, order-\/1]}}
\DoxyCodeLine{108 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a852d692285c428ad1fa0eebfe8c6aa25}{Montgomery\_multiply\_mod\_order}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* ma, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* mb, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* mc, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* order, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{_p503__r1_8c_a5980237f9ef13f496aa34368825e7c72}{Montgomery\_rprime}});}
\DoxyCodeLine{109 }
\DoxyCodeLine{110 \textcolor{comment}{// (Non-\/constant time) Montgomery inversion modulo the curve order using a\string^(-\/1) = a\string^(order-\/2) mod order}}
\DoxyCodeLine{111 \textcolor{comment}{//void Montgomery\_inversion\_mod\_order(const digit\_t* ma, digit\_t* mc, const digit\_t* order, const digit\_t* Montgomery\_rprime);}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aaa9325b64e7943b3f909afd4f5812815}{Montgomery\_inversion\_mod\_order\_bingcd}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* order, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{_p503__r1_8c_a5980237f9ef13f496aa34368825e7c72}{Montgomery\_rprime}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{sike__r1__namespace_8h_a98c1ac9106e531c9540fe313150cc220}{Montgomery\_R2}});}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 \textcolor{comment}{// Conversion of elements in Z\_r to Montgomery representation, where the order r is up to 384 bits.}}
\DoxyCodeLine{116 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_adfb23aa2cbd95f0ddc56531f92b78ac9}{to\_Montgomery\_mod\_order}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* mc, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* order, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{_p503__r1_8c_a5980237f9ef13f496aa34368825e7c72}{Montgomery\_rprime}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{_p503__r1_8c_a3385a669ea849b1b862ee3825eac9d26}{Montgomery\_Rprime}});}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \textcolor{comment}{// Conversion of elements in Z\_r from Montgomery to standard representation, where the order is up to 384 bits.}}
\DoxyCodeLine{119 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_ae738c91d034a37f5c2581b5ba86e5631}{from\_Montgomery\_mod\_order}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* ma, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* order, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{_p503__r1_8c_a5980237f9ef13f496aa34368825e7c72}{Montgomery\_rprime}});}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 \textcolor{comment}{// Inversion modulo Alice's order 2\string^372.}}
\DoxyCodeLine{122 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aa91f1149e35a023220d4c9f8d48f7a61}{inv\_mod\_orderA}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 \textcolor{comment}{/************ Field arithmetic functions *************/}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126 \textcolor{comment}{// Copy of a field element, c = a}}
\DoxyCodeLine{127 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a51bc0d916f83e53ce7563e7ba1f111f4}{fpcopy503}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} c);}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{comment}{// Zeroing a field element, a = 0}}
\DoxyCodeLine{130 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_abd2c53ef088d9f5b6bd7f527e2595df6}{fpzero503}}(\mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{131 }
\DoxyCodeLine{132 \textcolor{comment}{// Non constant-\/time comparison of two field elements. If a = b return TRUE, otherwise, return FALSE}}
\DoxyCodeLine{133 \textcolor{keywordtype}{bool} \mbox{\hyperlink{_p503__internal__r1_8h_a61df6b77fb6bc8eb9f6a3eec8b390a80}{fpequal503\_non\_constant\_time}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}});}
\DoxyCodeLine{134 }
\DoxyCodeLine{135 \textcolor{comment}{// Modular addition, c = a+b mod p503}}
\DoxyCodeLine{136 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a13e38c3060b42b7bc404e2d8c8c2473e}{fpadd503}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{137 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a85f8ff21ff1a43f92856f4d51fc4b896}{fpadd503\_asm}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 \textcolor{comment}{// Modular subtraction, c = a-\/b mod p503}}
\DoxyCodeLine{140 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_af6bf093c85a9c80028624ad93dd9a53c}{fpsub503}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{141 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_ab3a1ea37cdd45051bae5589bbd322f93}{fpsub503\_asm}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 \textcolor{comment}{// Modular negation, a = -\/a mod p503}}
\DoxyCodeLine{144 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a533f319d4f8b1405e8367e7845d2707b}{fpneg503}}(\mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{comment}{// Modular division by two, c = a/2 mod p503.}}
\DoxyCodeLine{147 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_ae02a5c41bd943884b90c2a8f905a19e2}{fpdiv2\_503}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{148 }
\DoxyCodeLine{149 \textcolor{comment}{// Modular correction to reduce field element a in [0, 2*p503-\/1] to [0, p503-\/1].}}
\DoxyCodeLine{150 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aea3150cdb07c45379b6ede01803c4ecc}{fpcorrection503}}(\mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{151 }
\DoxyCodeLine{152 \textcolor{comment}{// 503-\/bit Montgomery reduction, c = a mod p}}
\DoxyCodeLine{153 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a5da290326f267b4beb7dd3324d628797}{rdc\_mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* c);}
\DoxyCodeLine{154 }
\DoxyCodeLine{155 \textcolor{comment}{// Field multiplication using Montgomery arithmetic, c = a*b*R\string^-\/1 mod p503, where R=2\string^768}}
\DoxyCodeLine{156 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_ad6f6758902bf6b43ff93a18d6b2067b0}{fpmul503\_mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} c);}
\DoxyCodeLine{157 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a5ab004c3c5df66927a20a09a90d5a2bc}{mul503\_asm}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{_p503__internal__r1_8h_a0a9b40e430ec0717b4266fbe825ef6f6}{dfelm\_t}} c);}
\DoxyCodeLine{158 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a7491ff2a04f38edfe8393fbe8b38ab09}{rdc503\_asm}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a0a9b40e430ec0717b4266fbe825ef6f6}{dfelm\_t}} ma, \mbox{\hyperlink{_p503__internal__r1_8h_a0a9b40e430ec0717b4266fbe825ef6f6}{dfelm\_t}} mc);}
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{comment}{// Field squaring using Montgomery arithmetic, c = a*b*R\string^-\/1 mod p503, where R=2\string^768}}
\DoxyCodeLine{161 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aecbd113beae48a2650c8beae35dcf905}{fpsqr503\_mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} ma, \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} mc);}
\DoxyCodeLine{162 }
\DoxyCodeLine{163 \textcolor{comment}{// Conversion to Montgomery representation}}
\DoxyCodeLine{164 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aa53f4e32ce8581a7f14cb3f166316911}{to\_mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} mc);}
\DoxyCodeLine{165 }
\DoxyCodeLine{166 \textcolor{comment}{// Conversion from Montgomery representation to standard representation}}
\DoxyCodeLine{167 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a81e8080913da672eab3c93bed8507424}{from\_mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} ma, \mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} c);}
\DoxyCodeLine{168 }
\DoxyCodeLine{169 \textcolor{comment}{// Field inversion, a = a\string^-\/1 in GF(p503)}}
\DoxyCodeLine{170 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a21632c381abc146e48792623129615c9}{fpinv503\_mont}}(\mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{comment}{// Field inversion, a = a\string^-\/1 in GF(p503) using the binary GCD}}
\DoxyCodeLine{173 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a0e5b574174ca0930e0a1166198bee3ee}{fpinv503\_mont\_bingcd}}(\mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{174 }
\DoxyCodeLine{175 \textcolor{comment}{// Chain to compute (p503-\/3)/4 using Montgomery arithmetic}}
\DoxyCodeLine{176 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a701c0ff7ac61dd57cffe393733fac8f1}{fpinv503\_chain\_mont}}(\mbox{\hyperlink{_p503__internal__r1_8h_a458650e4389c82f54a11cb9f0b75afd2}{felm\_t}} \mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \textcolor{comment}{/************ GF(p\string^2) arithmetic functions *************/}}
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \textcolor{comment}{// Copy of a GF(p503\string^2) element, c = a}}
\DoxyCodeLine{181 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a1d416712f5599321972beef59c2fb8cf}{fp2copy503}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *c);}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{comment}{// GF(p503\string^2) negation, a = -\/a in GF(p503\string^2)}}
\DoxyCodeLine{184 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a9dcf160d428898bbc478cc8402dc3926}{fp2neg503}}(\mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{185 }
\DoxyCodeLine{186 \textcolor{comment}{// GF(p503\string^2) addition, c = a+b in GF(p503\string^2)}}
\DoxyCodeLine{187 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a1d3fba7c81613ca457a8df7b54889777}{fp2add503}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *c);}
\DoxyCodeLine{188 }
\DoxyCodeLine{189 \textcolor{comment}{// GF(p503\string^2) subtraction, c = a-\/b in GF(p503\string^2)}}
\DoxyCodeLine{190 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a6df43956ffbf986b3eb5353807d87551}{fp2sub503}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *c);}
\DoxyCodeLine{191 }
\DoxyCodeLine{192 \textcolor{comment}{// GF(p503\string^2) division by two, c = a/2  in GF(p503\string^2)}}
\DoxyCodeLine{193 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_abbdabed74de57a4225a263ed163665df}{fp2div2\_503}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *c);}
\DoxyCodeLine{194 }
\DoxyCodeLine{195 \textcolor{comment}{// Modular correction, a = a in GF(p503\string^2)}}
\DoxyCodeLine{196 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_ac17c95603ab6692f843f8b1ca0a48200}{fp2correction503}}(\mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{197 }
\DoxyCodeLine{198 \textcolor{comment}{// GF(p503\string^2) squaring using Montgomery arithmetic, c = a\string^2 in GF(p503\string^2)}}
\DoxyCodeLine{199 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_ae9b57a85117e5dc71b37d1566debaa3d}{fp2sqr503\_mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *c);}
\DoxyCodeLine{200 }
\DoxyCodeLine{201 \textcolor{comment}{// GF(p503\string^2) multiplication using Montgomery arithmetic, c = a*b in GF(p503\string^2)}}
\DoxyCodeLine{202 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a28ae0cedd0ae2db825cea18f6fef3d6a}{fp2mul503\_mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *c);}
\DoxyCodeLine{203 }
\DoxyCodeLine{204 \textcolor{comment}{// Conversion of a GF(p503\string^2) element to Montgomery representation}}
\DoxyCodeLine{205 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aec71937808787b7d4dfc8dbdaaf9c2ee}{to\_fp2mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *mc);}
\DoxyCodeLine{206 }
\DoxyCodeLine{207 \textcolor{comment}{// Conversion of a GF(p503\string^2) element from Montgomery representation to standard representation}}
\DoxyCodeLine{208 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_acff480537063a5f8d0860c385f058240}{from\_fp2mont}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *ma, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *c);}
\DoxyCodeLine{209 }
\DoxyCodeLine{210 \textcolor{comment}{// GF(p503\string^2) inversion using Montgomery arithmetic, a = (a0-\/i*a1)/(a0\string^2+a1\string^2)}}
\DoxyCodeLine{211 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a91fab7889ff61df79eabb2ada98d8323}{fp2inv503\_mont}}(\mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{212 }
\DoxyCodeLine{213 \textcolor{comment}{// GF(p503\string^2) inversion, a = (a0-\/i*a1)/(a0\string^2+a1\string^2), GF(p503) inversion done using the binary GCD}}
\DoxyCodeLine{214 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a2f2939a27711c98c9a47d13bf1fb2b53}{fp2inv503\_mont\_bingcd}}(\mbox{\hyperlink{structfelm__s}{f2elm\_t}} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}});}
\DoxyCodeLine{215 }
\DoxyCodeLine{216 \textcolor{comment}{// n-\/way Montgomery inversion}}
\DoxyCodeLine{217 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a64444c2475a98576916a09b2432ae92c}{mont\_n\_way\_inv}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}}* vec, \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}}, \mbox{\hyperlink{structfelm__s}{f2elm\_t}}* out);}
\DoxyCodeLine{218 }
\DoxyCodeLine{219 \textcolor{comment}{/************ Elliptic curve and isogeny functions *************/}}
\DoxyCodeLine{220 }
\DoxyCodeLine{221 \textcolor{comment}{// Computes the j-\/invariant of a Montgomery curve with projective constant.}}
\DoxyCodeLine{222 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a99b8bedd0700ebd264b945c6f2742b89}{j\_inv}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *C, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *jinv);}
\DoxyCodeLine{223 }
\DoxyCodeLine{224 \textcolor{comment}{// Simultaneous doubling and differential addition.}}
\DoxyCodeLine{225 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a5d41ec76b1fd032e9e72c9457fb5fd93}{xDBLADD}}(\mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} Q, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *xPQ, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24);}
\DoxyCodeLine{226 }
\DoxyCodeLine{227 \textcolor{comment}{// Doubling of a Montgomery point in projective coordinates (X:Z).}}
\DoxyCodeLine{228 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a2e8a14a276756f945b9430545c4ccdd5}{xDBL}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} Q, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24plus, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *C24);}
\DoxyCodeLine{229 }
\DoxyCodeLine{230 \textcolor{comment}{// Computes [2\string^e](X:Z) on Montgomery curve with projective constant via e repeated doublings.}}
\DoxyCodeLine{231 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a0af163b2f032552adab968c0a2e8d980}{xDBLe}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} Q, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24plus, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *C24, \textcolor{keyword}{const} \textcolor{keywordtype}{int} e);}
\DoxyCodeLine{232 }
\DoxyCodeLine{233 \textcolor{comment}{// Differential addition.}}
\DoxyCodeLine{234 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a6512872ba143d3ed79ecb5b97932f69f}{xADD}}(\mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} Q, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *xPQ);}
\DoxyCodeLine{235 }
\DoxyCodeLine{236 \textcolor{comment}{// Computes the corresponding 4-\/isogeny of a projective Montgomery point (X4:Z4) of order 4.}}
\DoxyCodeLine{237 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a6ea6c3008ce3a2b53964e1d35a2f998e}{get\_4\_isog}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24plus, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *C24, \mbox{\hyperlink{structfelm__s}{f2elm\_t}}* coeff);}
\DoxyCodeLine{238 }
\DoxyCodeLine{239 \textcolor{comment}{// Evaluates the isogeny at the point (X:Z) in the domain of the isogeny.}}
\DoxyCodeLine{240 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_ae522f86af71923008924225cbaf8045e}{eval\_4\_isog}}(\mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \mbox{\hyperlink{structfelm__s}{f2elm\_t}}* coeff);}
\DoxyCodeLine{241 }
\DoxyCodeLine{242 \textcolor{comment}{// Tripling of a Montgomery point in projective coordinates (X:Z).}}
\DoxyCodeLine{243 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aaf5528f07c3ed0afb9397455a162f231}{xTPL}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} Q, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24minus, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24plus);}
\DoxyCodeLine{244 }
\DoxyCodeLine{245 \textcolor{comment}{// Computes [3\string^e](X:Z) on Montgomery curve with projective constant via e repeated triplings.}}
\DoxyCodeLine{246 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a0a25bfa808c905790bf92edeff08a9e7}{xTPLe}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} Q, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24minus, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24plus, \textcolor{keyword}{const} \textcolor{keywordtype}{int} e);}
\DoxyCodeLine{247 }
\DoxyCodeLine{248 \textcolor{comment}{// Computes the corresponding 3-\/isogeny of a projective Montgomery point (X3:Z3) of order 3.}}
\DoxyCodeLine{249 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aa553a59f8cf6bf24efb9b5225b704444}{get\_3\_isog}}(\textcolor{keyword}{const} \mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} P, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24minus, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A24plus, \mbox{\hyperlink{structfelm__s}{f2elm\_t}}* coeff);}
\DoxyCodeLine{250 }
\DoxyCodeLine{251 \textcolor{comment}{// Computes the 3-\/isogeny R=phi(X:Z), given projective point (X3:Z3) of order 3 on a Montgomery curve and a point P with coefficients given in coeff.}}
\DoxyCodeLine{252 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a722978951f269ca7d8fac5e04caf18df}{eval\_3\_isog}}(\mbox{\hyperlink{_p503__internal__r1_8h_a260151e10dd99dcc81d250fdd43b7a94}{point\_proj\_t}} Q, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}}* coeff);}
\DoxyCodeLine{253 }
\DoxyCodeLine{254 \textcolor{comment}{// 3-\/way simultaneous inversion}}
\DoxyCodeLine{255 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_aae7e38501ea90f1b994f37c048ac5320}{inv\_3\_way}}(\mbox{\hyperlink{structfelm__s}{f2elm\_t}} *z1, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *z2, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *z3);}
\DoxyCodeLine{256 }
\DoxyCodeLine{257 \textcolor{comment}{// Given the x-\/coordinates of P, Q, and R, returns the value A corresponding to the Montgomery curve E\_A: y\string^2=x\string^3+A*x\string^2+x such that R=Q-\/P on E\_A.}}
\DoxyCodeLine{258 \textcolor{keywordtype}{void} \mbox{\hyperlink{_p503__internal__r1_8h_a651332713aab84fd057c0b6eb10cebc5}{get\_A}}(\textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *xP, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *xQ, \textcolor{keyword}{const} \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *xR, \mbox{\hyperlink{structfelm__s}{f2elm\_t}} *A);}
\DoxyCodeLine{259 }
\DoxyCodeLine{260 }
\DoxyCodeLine{261 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
