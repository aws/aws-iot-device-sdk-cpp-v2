\hypertarget{crypto_2s2n__hash_8h_source}{}\doxysection{s2n\+\_\+hash.\+h}
\label{crypto_2s2n__hash_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_hash.h@{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_hash.h}}
\mbox{\hyperlink{crypto_2s2n__hash_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdbool_8h}{stdbool.h}}>}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{md5_8h}{openssl/md5.h}}>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{tests_2cbmc_2include_2openssl_2sha_8h}{openssl/sha.h}}>}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__evp_8h}{crypto/s2n\_evp.h}}"{}}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#define S2N\_MAX\_DIGEST\_LEN SHA512\_DIGEST\_LENGTH}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{29     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ae1681634687001760426e23ebad89e4e}{S2N\_HASH\_NONE}}=0,}
\DoxyCodeLine{30     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ade536a917150a394c402086ce5ceb853}{S2N\_HASH\_MD5}},}
\DoxyCodeLine{31     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627}{S2N\_HASH\_SHA1}},}
\DoxyCodeLine{32     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5a10e13733c5e845adaf60a6dae7487353}{S2N\_HASH\_SHA224}},}
\DoxyCodeLine{33     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5a80895804a25873b25a474b3440ba55c9}{S2N\_HASH\_SHA256}},}
\DoxyCodeLine{34     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5a89bbfcefd1e166b1e852d6ba96a9878d}{S2N\_HASH\_SHA384}},}
\DoxyCodeLine{35     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ab876b407741ca33d845c733c84355993}{S2N\_HASH\_SHA512}},}
\DoxyCodeLine{36     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419}{S2N\_HASH\_MD5\_SHA1}},}
\DoxyCodeLine{37     \textcolor{comment}{/* Don't add any hash algorithms below S2N\_HASH\_SENTINEL */}}
\DoxyCodeLine{38     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5a53e508de713c3175e3a46fd5af0bfc2a}{S2N\_HASH\_SENTINEL}}}
\DoxyCodeLine{39 \} \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}};}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{comment}{/* The low\_level\_digest stores all OpenSSL structs that are alg-\/specific to be used with OpenSSL's low-\/level hash API's. */}}
\DoxyCodeLine{42 \textcolor{keyword}{union }\mbox{\hyperlink{unions2n__hash__low__level__digest}{s2n\_hash\_low\_level\_digest}} \{}
\DoxyCodeLine{43     \mbox{\hyperlink{struct_m_d5state__st}{MD5\_CTX}} \mbox{\hyperlink{unions2n__hash__low__level__digest_a7758d0d24b94bd0aff58d803bca7f131}{md5}};}
\DoxyCodeLine{44     \mbox{\hyperlink{struct_s_h_astate__st}{SHA\_CTX}} \mbox{\hyperlink{unions2n__hash__low__level__digest_ad3f17fb47d484de27479aa1ab691bb6c}{sha1}};}
\DoxyCodeLine{45     \mbox{\hyperlink{struct_s_h_a256state__st}{SHA256\_CTX}} \mbox{\hyperlink{unions2n__hash__low__level__digest_a8a580f4ee04acbf0d8314ce8cc11e855}{sha224}};}
\DoxyCodeLine{46     \mbox{\hyperlink{struct_s_h_a256state__st}{SHA256\_CTX}} \mbox{\hyperlink{unions2n__hash__low__level__digest_a41276a190656a986e4142fe9a840ca31}{sha256}};}
\DoxyCodeLine{47     \mbox{\hyperlink{struct_s_h_a512state__st}{SHA512\_CTX}} \mbox{\hyperlink{unions2n__hash__low__level__digest_a906ff0dd42ea5f337b07ac63bc439951}{sha384}};}
\DoxyCodeLine{48     \mbox{\hyperlink{struct_s_h_a512state__st}{SHA512\_CTX}} \mbox{\hyperlink{unions2n__hash__low__level__digest_ac6802b3150389c3bbb60357e32196037}{sha512}};}
\DoxyCodeLine{49     \textcolor{keyword}{struct }\{}
\DoxyCodeLine{50         \mbox{\hyperlink{struct_m_d5state__st}{MD5\_CTX}} \mbox{\hyperlink{unions2n__hash__low__level__digest_a7758d0d24b94bd0aff58d803bca7f131}{md5}};}
\DoxyCodeLine{51         \mbox{\hyperlink{struct_s_h_astate__st}{SHA\_CTX}} \mbox{\hyperlink{unions2n__hash__low__level__digest_ad3f17fb47d484de27479aa1ab691bb6c}{sha1}};}
\DoxyCodeLine{52     \} \mbox{\hyperlink{unions2n__hash__low__level__digest_acee133dcdc1f246668238b1b5feec046}{md5\_sha1}};}
\DoxyCodeLine{53 \};}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{comment}{/* The evp\_digest stores all OpenSSL structs to be used with OpenSSL's EVP hash API's. */}}
\DoxyCodeLine{56 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \{}
\DoxyCodeLine{57     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__evp__digest}{s2n\_evp\_digest}} \mbox{\hyperlink{structs2n__hash__evp__digest_aa892adcd2883e76174d6ad5feec9d34b}{evp}};}
\DoxyCodeLine{58     \textcolor{comment}{/* Always store a secondary evp\_digest to allow resetting a hash\_state to MD5\_SHA1 from another alg. */}}
\DoxyCodeLine{59     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__evp__digest}{s2n\_evp\_digest}} \mbox{\hyperlink{structs2n__hash__evp__digest_aa180898b3c9097e922824cd8fabd7084}{evp\_md5\_secondary}};}
\DoxyCodeLine{60 \};}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{comment}{/* s2n\_hash\_state stores the s2n\_hash implementation being used (low-\/level or EVP),}}
\DoxyCodeLine{63 \textcolor{comment}{ * the hash algorithm being used at the time, and either low\_level or high\_level (EVP) OpenSSL digest structs.}}
\DoxyCodeLine{64 \textcolor{comment}{ */}}
\DoxyCodeLine{65 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} \{}
\DoxyCodeLine{66     \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash}{s2n\_hash}} *\mbox{\hyperlink{structs2n__hash__state_a7565dc5833388e93631822516a8d0758}{hash\_impl}};}
\DoxyCodeLine{67     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} \mbox{\hyperlink{structs2n__hash__state_ae0b6c694b58615e3b449cea37998d3ec}{alg}};}
\DoxyCodeLine{68     uint8\_t \mbox{\hyperlink{structs2n__hash__state_a97088ea25c2aa3d8ca8b606c9c033e7a}{is\_ready\_for\_input}};}
\DoxyCodeLine{69     uint64\_t \mbox{\hyperlink{structs2n__hash__state_afe71bf53e68f3bae1b272965fbcba5a6}{currently\_in\_hash}};}
\DoxyCodeLine{70     \textcolor{keyword}{union }\{}
\DoxyCodeLine{71         \textcolor{keyword}{union }\mbox{\hyperlink{unions2n__hash__low__level__digest}{s2n\_hash\_low\_level\_digest}} \mbox{\hyperlink{structs2n__hash__state_a84569a6ca65e77a2ecc9eb603987818c}{low\_level}};}
\DoxyCodeLine{72         \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__hash__state_a5511002881fb260b09a951a5ec6b5bd6}{high\_level}};}
\DoxyCodeLine{73     \} \mbox{\hyperlink{structs2n__hash__state_ac7baf712897bf5b0d3f83bf038b1e234}{digest}};}
\DoxyCodeLine{74 \};}
\DoxyCodeLine{75 }
\DoxyCodeLine{76 \textcolor{comment}{/* The s2n hash implementation is abstracted to allow for separate implementations, using}}
\DoxyCodeLine{77 \textcolor{comment}{ * either OpenSSL's low-\/level algorithm-\/specific API's or OpenSSL's EVP API's.}}
\DoxyCodeLine{78 \textcolor{comment}{ */}}
\DoxyCodeLine{79 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash}{s2n\_hash}} \{}
\DoxyCodeLine{80     int (*\mbox{\hyperlink{structs2n__hash_a2c6a410142af4c5c28de1879b1df0bee}{alloc}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{81     int (*\mbox{\hyperlink{structs2n__hash_af6fa89105e2f7e0b67c424509733711a}{allow\_md5\_for\_fips}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{82     int (*\mbox{\hyperlink{structs2n__hash_a5a993b0f9d836311a02f72e16e436d98}{init}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}}, \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} \mbox{\hyperlink{structs2n__hash__state_ae0b6c694b58615e3b449cea37998d3ec}{alg}});}
\DoxyCodeLine{83     int (*\mbox{\hyperlink{structs2n__hash_a30d5ef1abaf9620379bd597ca8aad92e}{update}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}}, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, uint32\_t size);}
\DoxyCodeLine{84     int (*\mbox{\hyperlink{structs2n__hash_afaea755b79175a9cd8fd85d83b402a95}{digest}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}}, \textcolor{keywordtype}{void} *out, uint32\_t size);}
\DoxyCodeLine{85     int (*\mbox{\hyperlink{structs2n__hash_a9158c69980de0ebc6a43feed87e38c2b}{copy}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *to, \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *from);}
\DoxyCodeLine{86     int (*\mbox{\hyperlink{structs2n__hash_a704cb28ef84fb1eb59bb880320cf2fc6}{reset}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{87     int (*\mbox{\hyperlink{structs2n__hash_a3e967365f4c8eadf2dad0eb92c606523}{free}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{88 \};}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a2d7609aba112f1336497f9b6a3ba19e2}{s2n\_hash\_digest\_size}}(\mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} \mbox{\hyperlink{structs2n__hash__state_ae0b6c694b58615e3b449cea37998d3ec}{alg}}, uint8\_t *out);}
\DoxyCodeLine{91 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_ae18512b5dc100cfcc9b444d27ae177df}{s2n\_hash\_block\_size}}(\mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} \mbox{\hyperlink{structs2n__hash__state_ae0b6c694b58615e3b449cea37998d3ec}{alg}}, uint64\_t *block\_size);}
\DoxyCodeLine{92 \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} \mbox{\hyperlink{crypto_2s2n__hash_8h_a20b65f576c515821589f8aef16a7fa2f}{s2n\_hash\_is\_available}}(\mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} \mbox{\hyperlink{structs2n__hash__state_ae0b6c694b58615e3b449cea37998d3ec}{alg}});}
\DoxyCodeLine{93 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a0aa5401d87d0b5d6855f4852d39be2ba}{s2n\_hash\_is\_ready\_for\_input}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{94 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a6e1456ecefa61835c01b7180134e04b8}{s2n\_hash\_new}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{95 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a45f9f0874d8278c80594f7ab31bc2fb9}{s2n\_hash\_allow\_md5\_for\_fips}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{96 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a684a3779eebad8329d41443454dd6fa2}{s2n\_hash\_init}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}}, \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} \mbox{\hyperlink{structs2n__hash__state_ae0b6c694b58615e3b449cea37998d3ec}{alg}});}
\DoxyCodeLine{97 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a0f3c4efbf552f607071e552dc0548ee6}{s2n\_hash\_update}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}}, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, uint32\_t size);}
\DoxyCodeLine{98 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_ac0a5e6f9f981a0e473bfb9dba9c3d7c9}{s2n\_hash\_digest}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}}, \textcolor{keywordtype}{void} *out, uint32\_t size);}
\DoxyCodeLine{99 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a8b39db9e0a5456a10a5d790474f09818}{s2n\_hash\_copy}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *to, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *from);}
\DoxyCodeLine{100 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a3ad42d683b1126e7d8eb329b68382bc8}{s2n\_hash\_reset}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{101 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a9d55a86256e1fd602ab3d00d5d7d506b}{s2n\_hash\_free}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{102 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_a4b0b459365b97d081895a9ca757475a4}{s2n\_hash\_get\_currently\_in\_hash\_total}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}}, uint64\_t *out);}
\DoxyCodeLine{103 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{crypto_2s2n__hash_8h_af8c9404b5c122e58b223b372d09ca48f}{s2n\_hash\_const\_time\_get\_currently\_in\_hash\_block}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *\mbox{\hyperlink{structstate}{state}}, uint64\_t *out);}

\end{DoxyCode}
