\hypertarget{s2n__x509__validator_8h}{}\doxysection{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\+\_\+x509\+\_\+validator.h File Reference}
\label{s2n__x509__validator_8h}\index{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_x509\_validator.h@{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_x509\_validator.h}}
{\ttfamily \#include \char`\"{}api/s2n.\+h\char`\"{}}\newline
{\ttfamily \#include $<$openssl/x509v3.\+h$>$}\newline
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}}
\item 
struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{s2n__x509__validator_8h_a2d09f7be1a48211c8d8171ff84738495}{S2\+N\+\_\+\+OCSP\+\_\+\+STAPLING\+\_\+\+SUPPORTED}}~1
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef uint8\+\_\+t($\ast$ \mbox{\hyperlink{s2n__x509__validator_8h_a4eb3b37fe7d3b4453099c6bcbe26a4f1}{verify\+\_\+host}}) (const char $\ast$host\+\_\+name, size\+\_\+t host\+\_\+name\+\_\+len, void $\ast$data)
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} \{ \newline
\mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a96368d4297458ff45a814fbeedb250a9}{S2\+N\+\_\+\+CERT\+\_\+\+OK}} = 0
, \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a855bad2ae3cba2f58e8b70ef6e873ef2}{S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+UNTRUSTED}} = -\/1
, \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a19875caf9e0371b09cb92142af674469}{S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+REVOKED}} = -\/2
, \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145ac414415b4bceffa00d029438f59151f7}{S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+EXPIRED}} = -\/3
, \newline
\mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a98a18f7128be78eacf73cbba4edd1bf9}{S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+TYPE\+\_\+\+UNSUPPORTED}} = -\/4
, \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a02b26952eb2af43ed4ce18a61da99d6b}{S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+INVALID}} = -\/5
, \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a8006f43f1bb8fa4c4b6eca68da718150}{S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+MAX\+\_\+\+CHAIN\+\_\+\+DEPTH\+\_\+\+EXCEEDED}} = -\/6
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \mbox{\hyperlink{s2n__x509__validator_8h_a288e4c79746a86e09ee8a398bb14c512}{s2n\+\_\+x509\+\_\+ocsp\+\_\+stapling\+\_\+supported}} (void)
\item 
void \mbox{\hyperlink{s2n__x509__validator_8h_a9420691912d2b27885e752cf5e3a255d}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+init\+\_\+empty}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store)
\item 
uint8\+\_\+t \mbox{\hyperlink{s2n__x509__validator_8h_ab79d51c6a30bb86a6ff1ac773d0e38ea}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+has\+\_\+certs}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8h_ab1f058ecf0f93d94b6eecb634050be58}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+from\+\_\+system\+\_\+defaults}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8h_a9d1721ad7ba85938d51914e70ab93d64}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+add\+\_\+pem}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store, const char $\ast$pem)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8h_a02f94f7855f8de1ba96cf0358ec9d69d}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+from\+\_\+ca\+\_\+file}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store, const char $\ast$ca\+\_\+pem\+\_\+filename, const char $\ast$ca\+\_\+dir)
\item 
void \mbox{\hyperlink{s2n__x509__validator_8h_ad80262ea13eecda7dbec5812576dc732}{s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+wipe}} (struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$store)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8h_a3c01448c0eba6f3da070efca52a9beb1}{s2n\+\_\+x509\+\_\+validator\+\_\+init\+\_\+no\+\_\+x509\+\_\+validation}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8h_a14de21f9d6b7b411e1eee66a98d64feb}{s2n\+\_\+x509\+\_\+validator\+\_\+init}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$trust\+\_\+store, uint8\+\_\+t check\+\_\+ocsp)
\item 
int \mbox{\hyperlink{s2n__x509__validator_8h_ae4f3e82ce716b7f639c01dfa333c5b10}{s2n\+\_\+x509\+\_\+validator\+\_\+set\+\_\+max\+\_\+chain\+\_\+depth}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, uint16\+\_\+t max\+\_\+depth)
\item 
void \mbox{\hyperlink{s2n__x509__validator_8h_a7a9cb1ed3f0786296ad988185adce278}{s2n\+\_\+x509\+\_\+validator\+\_\+wipe}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator)
\item 
\mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} \mbox{\hyperlink{s2n__x509__validator_8h_a3f135290f89f1c43d55f9b7667543aca}{s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+chain}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, uint8\+\_\+t $\ast$cert\+\_\+chain\+\_\+in, uint32\+\_\+t cert\+\_\+chain\+\_\+len, \mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\+\_\+pkey\+\_\+type}} $\ast$pkey\+\_\+type, struct \mbox{\hyperlink{structs2n__pkey}{s2n\+\_\+pkey}} $\ast$public\+\_\+key\+\_\+out)
\item 
\mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} \mbox{\hyperlink{s2n__x509__validator_8h_aac701ea2519babd138e34ee9089f8a6f}{s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+stapled\+\_\+ocsp\+\_\+response}} (struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$validator, struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn, const uint8\+\_\+t $\ast$ocsp\+\_\+response, uint32\+\_\+t size)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{s2n__x509__validator_8h_a2d09f7be1a48211c8d8171ff84738495}\label{s2n__x509__validator_8h_a2d09f7be1a48211c8d8171ff84738495}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!S2N\_OCSP\_STAPLING\_SUPPORTED@{S2N\_OCSP\_STAPLING\_SUPPORTED}}
\index{S2N\_OCSP\_STAPLING\_SUPPORTED@{S2N\_OCSP\_STAPLING\_SUPPORTED}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{S2N\_OCSP\_STAPLING\_SUPPORTED}{S2N\_OCSP\_STAPLING\_SUPPORTED}}
{\footnotesize\ttfamily \#define S2\+N\+\_\+\+OCSP\+\_\+\+STAPLING\+\_\+\+SUPPORTED~1}



\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{s2n__x509__validator_8h_a4eb3b37fe7d3b4453099c6bcbe26a4f1}\label{s2n__x509__validator_8h_a4eb3b37fe7d3b4453099c6bcbe26a4f1}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!verify\_host@{verify\_host}}
\index{verify\_host@{verify\_host}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{verify\_host}{verify\_host}}
{\footnotesize\ttfamily typedef uint8\+\_\+t($\ast$ verify\+\_\+host) (const char $\ast$host\+\_\+name, size\+\_\+t host\+\_\+name\+\_\+len, void $\ast$data)}

Return TRUE for trusted, FALSE for untrusted 

\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}\label{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_cert\_validation\_code@{s2n\_cert\_validation\_code}}
\index{s2n\_cert\_validation\_code@{s2n\_cert\_validation\_code}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_cert\_validation\_code}{s2n\_cert\_validation\_code}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{S2N\_CERT\_OK@{S2N\_CERT\_OK}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!S2N\_CERT\_OK@{S2N\_CERT\_OK}}}\mbox{\Hypertarget{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a96368d4297458ff45a814fbeedb250a9}\label{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a96368d4297458ff45a814fbeedb250a9}} 
S2\+N\+\_\+\+CERT\+\_\+\+OK&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{S2N\_CERT\_ERR\_UNTRUSTED@{S2N\_CERT\_ERR\_UNTRUSTED}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!S2N\_CERT\_ERR\_UNTRUSTED@{S2N\_CERT\_ERR\_UNTRUSTED}}}\mbox{\Hypertarget{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a855bad2ae3cba2f58e8b70ef6e873ef2}\label{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a855bad2ae3cba2f58e8b70ef6e873ef2}} 
S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+UNTRUSTED&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{S2N\_CERT\_ERR\_REVOKED@{S2N\_CERT\_ERR\_REVOKED}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!S2N\_CERT\_ERR\_REVOKED@{S2N\_CERT\_ERR\_REVOKED}}}\mbox{\Hypertarget{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a19875caf9e0371b09cb92142af674469}\label{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a19875caf9e0371b09cb92142af674469}} 
S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+REVOKED&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{S2N\_CERT\_ERR\_EXPIRED@{S2N\_CERT\_ERR\_EXPIRED}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!S2N\_CERT\_ERR\_EXPIRED@{S2N\_CERT\_ERR\_EXPIRED}}}\mbox{\Hypertarget{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145ac414415b4bceffa00d029438f59151f7}\label{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145ac414415b4bceffa00d029438f59151f7}} 
S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+EXPIRED&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{S2N\_CERT\_ERR\_TYPE\_UNSUPPORTED@{S2N\_CERT\_ERR\_TYPE\_UNSUPPORTED}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!S2N\_CERT\_ERR\_TYPE\_UNSUPPORTED@{S2N\_CERT\_ERR\_TYPE\_UNSUPPORTED}}}\mbox{\Hypertarget{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a98a18f7128be78eacf73cbba4edd1bf9}\label{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a98a18f7128be78eacf73cbba4edd1bf9}} 
S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+TYPE\+\_\+\+UNSUPPORTED&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{S2N\_CERT\_ERR\_INVALID@{S2N\_CERT\_ERR\_INVALID}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!S2N\_CERT\_ERR\_INVALID@{S2N\_CERT\_ERR\_INVALID}}}\mbox{\Hypertarget{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a02b26952eb2af43ed4ce18a61da99d6b}\label{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a02b26952eb2af43ed4ce18a61da99d6b}} 
S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+INVALID&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{S2N\_CERT\_ERR\_MAX\_CHAIN\_DEPTH\_EXCEEDED@{S2N\_CERT\_ERR\_MAX\_CHAIN\_DEPTH\_EXCEEDED}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!S2N\_CERT\_ERR\_MAX\_CHAIN\_DEPTH\_EXCEEDED@{S2N\_CERT\_ERR\_MAX\_CHAIN\_DEPTH\_EXCEEDED}}}\mbox{\Hypertarget{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a8006f43f1bb8fa4c4b6eca68da718150}\label{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145a8006f43f1bb8fa4c4b6eca68da718150}} 
S2\+N\+\_\+\+CERT\+\_\+\+ERR\+\_\+\+MAX\+\_\+\+CHAIN\+\_\+\+DEPTH\+\_\+\+EXCEEDED&\\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{s2n__x509__validator_8h_a288e4c79746a86e09ee8a398bb14c512}\label{s2n__x509__validator_8h_a288e4c79746a86e09ee8a398bb14c512}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_ocsp\_stapling\_supported@{s2n\_x509\_ocsp\_stapling\_supported}}
\index{s2n\_x509\_ocsp\_stapling\_supported@{s2n\_x509\_ocsp\_stapling\_supported}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_ocsp\_stapling\_supported()}{s2n\_x509\_ocsp\_stapling\_supported()}}
{\footnotesize\ttfamily uint8\+\_\+t s2n\+\_\+x509\+\_\+ocsp\+\_\+stapling\+\_\+supported (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Some libcrypto implementations do not support OCSP validation. Returns 1 if supported, 0 otherwise. \mbox{\Hypertarget{s2n__x509__validator_8h_a9d1721ad7ba85938d51914e70ab93d64}\label{s2n__x509__validator_8h_a9d1721ad7ba85938d51914e70ab93d64}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_trust\_store\_add\_pem@{s2n\_x509\_trust\_store\_add\_pem}}
\index{s2n\_x509\_trust\_store\_add\_pem@{s2n\_x509\_trust\_store\_add\_pem}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_add\_pem()}{s2n\_x509\_trust\_store\_add\_pem()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+add\+\_\+pem (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store,  }\item[{const char $\ast$}]{pem }\end{DoxyParamCaption})}

Initialize trust store from a PEM. This will allocate memory, and load PEM into the Trust Store \mbox{\Hypertarget{s2n__x509__validator_8h_a02f94f7855f8de1ba96cf0358ec9d69d}\label{s2n__x509__validator_8h_a02f94f7855f8de1ba96cf0358ec9d69d}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_trust\_store\_from\_ca\_file@{s2n\_x509\_trust\_store\_from\_ca\_file}}
\index{s2n\_x509\_trust\_store\_from\_ca\_file@{s2n\_x509\_trust\_store\_from\_ca\_file}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_from\_ca\_file()}{s2n\_x509\_trust\_store\_from\_ca\_file()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+from\+\_\+ca\+\_\+file (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store,  }\item[{const char $\ast$}]{ca\+\_\+pem\+\_\+filename,  }\item[{const char $\ast$}]{ca\+\_\+dir }\end{DoxyParamCaption})}

Initialize trust store from a CA file. This will allocate memory, and load each cert in the file into the trust store Returns 0 on success, or S2N error codes on failure. \mbox{\Hypertarget{s2n__x509__validator_8h_ab1f058ecf0f93d94b6eecb634050be58}\label{s2n__x509__validator_8h_ab1f058ecf0f93d94b6eecb634050be58}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_trust\_store\_from\_system\_defaults@{s2n\_x509\_trust\_store\_from\_system\_defaults}}
\index{s2n\_x509\_trust\_store\_from\_system\_defaults@{s2n\_x509\_trust\_store\_from\_system\_defaults}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_from\_system\_defaults()}{s2n\_x509\_trust\_store\_from\_system\_defaults()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+from\+\_\+system\+\_\+defaults (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store }\end{DoxyParamCaption})}

Initializes the trust store to default system paths \mbox{\Hypertarget{s2n__x509__validator_8h_ab79d51c6a30bb86a6ff1ac773d0e38ea}\label{s2n__x509__validator_8h_ab79d51c6a30bb86a6ff1ac773d0e38ea}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_trust\_store\_has\_certs@{s2n\_x509\_trust\_store\_has\_certs}}
\index{s2n\_x509\_trust\_store\_has\_certs@{s2n\_x509\_trust\_store\_has\_certs}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_has\_certs()}{s2n\_x509\_trust\_store\_has\_certs()}}
{\footnotesize\ttfamily uint8\+\_\+t s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+has\+\_\+certs (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store }\end{DoxyParamCaption})}

Returns TRUE if the trust store has certificates installed, FALSE otherwise \mbox{\Hypertarget{s2n__x509__validator_8h_a9420691912d2b27885e752cf5e3a255d}\label{s2n__x509__validator_8h_a9420691912d2b27885e752cf5e3a255d}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_trust\_store\_init\_empty@{s2n\_x509\_trust\_store\_init\_empty}}
\index{s2n\_x509\_trust\_store\_init\_empty@{s2n\_x509\_trust\_store\_init\_empty}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_init\_empty()}{s2n\_x509\_trust\_store\_init\_empty()}}
{\footnotesize\ttfamily void s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+init\+\_\+empty (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store }\end{DoxyParamCaption})}

Initialize the trust store to empty defaults (no allocations happen here) \mbox{\Hypertarget{s2n__x509__validator_8h_ad80262ea13eecda7dbec5812576dc732}\label{s2n__x509__validator_8h_ad80262ea13eecda7dbec5812576dc732}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_trust\_store\_wipe@{s2n\_x509\_trust\_store\_wipe}}
\index{s2n\_x509\_trust\_store\_wipe@{s2n\_x509\_trust\_store\_wipe}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_trust\_store\_wipe()}{s2n\_x509\_trust\_store\_wipe()}}
{\footnotesize\ttfamily void s2n\+\_\+x509\+\_\+trust\+\_\+store\+\_\+wipe (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{store }\end{DoxyParamCaption})}

Cleans up, and frees any underlying memory in the trust store. \mbox{\Hypertarget{s2n__x509__validator_8h_a14de21f9d6b7b411e1eee66a98d64feb}\label{s2n__x509__validator_8h_a14de21f9d6b7b411e1eee66a98d64feb}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_validator\_init@{s2n\_x509\_validator\_init}}
\index{s2n\_x509\_validator\_init@{s2n\_x509\_validator\_init}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_init()}{s2n\_x509\_validator\_init()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+validator\+\_\+init (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{struct \mbox{\hyperlink{structs2n__x509__trust__store}{s2n\+\_\+x509\+\_\+trust\+\_\+store}} $\ast$}]{trust\+\_\+store,  }\item[{uint8\+\_\+t}]{check\+\_\+ocsp }\end{DoxyParamCaption})}

Initialize the validator in safe mode. Will use trust store to validate x.\+509 cerficiates, ocsp responses, and will call the verify host callback to determine if a subject name or alternative name from the cert should be trusted. Returns 0 on success, and an S2\+N\+\_\+\+ERR\+\_\+$\ast$ on failure. \mbox{\Hypertarget{s2n__x509__validator_8h_a3c01448c0eba6f3da070efca52a9beb1}\label{s2n__x509__validator_8h_a3c01448c0eba6f3da070efca52a9beb1}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_validator\_init\_no\_x509\_validation@{s2n\_x509\_validator\_init\_no\_x509\_validation}}
\index{s2n\_x509\_validator\_init\_no\_x509\_validation@{s2n\_x509\_validator\_init\_no\_x509\_validation}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_init\_no\_x509\_validation()}{s2n\_x509\_validator\_init\_no\_x509\_validation()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+validator\+\_\+init\+\_\+no\+\_\+x509\+\_\+validation (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator }\end{DoxyParamCaption})}

Initialize the validator in unsafe mode. No validity checks for OCSP, host checks, or X.\+509 will be performed. \mbox{\Hypertarget{s2n__x509__validator_8h_ae4f3e82ce716b7f639c01dfa333c5b10}\label{s2n__x509__validator_8h_ae4f3e82ce716b7f639c01dfa333c5b10}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_validator\_set\_max\_chain\_depth@{s2n\_x509\_validator\_set\_max\_chain\_depth}}
\index{s2n\_x509\_validator\_set\_max\_chain\_depth@{s2n\_x509\_validator\_set\_max\_chain\_depth}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_set\_max\_chain\_depth()}{s2n\_x509\_validator\_set\_max\_chain\_depth()}}
{\footnotesize\ttfamily int s2n\+\_\+x509\+\_\+validator\+\_\+set\+\_\+max\+\_\+chain\+\_\+depth (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{uint16\+\_\+t}]{max\+\_\+depth }\end{DoxyParamCaption})}

Sets the maximum depth for a cert chain that can be used at validation. \mbox{\Hypertarget{s2n__x509__validator_8h_a3f135290f89f1c43d55f9b7667543aca}\label{s2n__x509__validator_8h_a3f135290f89f1c43d55f9b7667543aca}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_validator\_validate\_cert\_chain@{s2n\_x509\_validator\_validate\_cert\_chain}}
\index{s2n\_x509\_validator\_validate\_cert\_chain@{s2n\_x509\_validator\_validate\_cert\_chain}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_validate\_cert\_chain()}{s2n\_x509\_validator\_validate\_cert\_chain()}}
{\footnotesize\ttfamily \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+chain (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{uint8\+\_\+t $\ast$}]{cert\+\_\+chain\+\_\+in,  }\item[{uint32\+\_\+t}]{cert\+\_\+chain\+\_\+len,  }\item[{\mbox{\hyperlink{s2n__pkey_8h_a9f8ffb59dc71a9fab8e636972279d441}{s2n\+\_\+pkey\+\_\+type}} $\ast$}]{pkey\+\_\+type,  }\item[{struct \mbox{\hyperlink{structs2n__pkey}{s2n\+\_\+pkey}} $\ast$}]{public\+\_\+key\+\_\+out }\end{DoxyParamCaption})}

Validates a certificate chain against the configured trust store in safe mode. In unsafe mode, it will find the public key and return it but not validate the certificates. Alternative Names and Subject Name will be passed to the host verification callback. The verification callback will be possibly called multiple times depending on how many names are found. If any of those calls return TRUE, that stage of the validation will continue, otherwise once all names are tried and none matched as trusted, the chain will be considered UNTRUSTED.

This function can only be called once per instance of an \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}}. If must be called prior to calling \mbox{\hyperlink{s2n__x509__validator_8h_aac701ea2519babd138e34ee9089f8a6f}{s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+stapled\+\_\+ocsp\+\_\+response()}}. \mbox{\Hypertarget{s2n__x509__validator_8h_aac701ea2519babd138e34ee9089f8a6f}\label{s2n__x509__validator_8h_aac701ea2519babd138e34ee9089f8a6f}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response@{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response}}
\index{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response@{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response()}{s2n\_x509\_validator\_validate\_cert\_stapled\_ocsp\_response()}}
{\footnotesize\ttfamily \mbox{\hyperlink{s2n__x509__validator_8h_a9a57c107b797f4467cbc9f5d359e4145}{s2n\+\_\+cert\+\_\+validation\+\_\+code}} s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+stapled\+\_\+ocsp\+\_\+response (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator,  }\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn,  }\item[{const uint8\+\_\+t $\ast$}]{ocsp\+\_\+response,  }\item[{uint32\+\_\+t}]{size }\end{DoxyParamCaption})}

Validates an ocsp response against the most recent certificate chain. Also verifies the timestamps on the response. This function can only be called once per instance of an \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} and only after a successful call to \mbox{\hyperlink{s2n__x509__validator_8h_a3f135290f89f1c43d55f9b7667543aca}{s2n\+\_\+x509\+\_\+validator\+\_\+validate\+\_\+cert\+\_\+chain()}}. \mbox{\Hypertarget{s2n__x509__validator_8h_a7a9cb1ed3f0786296ad988185adce278}\label{s2n__x509__validator_8h_a7a9cb1ed3f0786296ad988185adce278}} 
\index{s2n\_x509\_validator.h@{s2n\_x509\_validator.h}!s2n\_x509\_validator\_wipe@{s2n\_x509\_validator\_wipe}}
\index{s2n\_x509\_validator\_wipe@{s2n\_x509\_validator\_wipe}!s2n\_x509\_validator.h@{s2n\_x509\_validator.h}}
\doxysubsubsection{\texorpdfstring{s2n\_x509\_validator\_wipe()}{s2n\_x509\_validator\_wipe()}}
{\footnotesize\ttfamily void s2n\+\_\+x509\+\_\+validator\+\_\+wipe (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__x509__validator}{s2n\+\_\+x509\+\_\+validator}} $\ast$}]{validator }\end{DoxyParamCaption})}

Cleans up underlying memory and data members. Struct can be reused afterwards. 