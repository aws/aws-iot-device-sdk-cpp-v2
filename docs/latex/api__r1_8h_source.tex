\hypertarget{api__r1_8h_source}{}\doxysection{api\+\_\+r1.\+h}
\label{api__r1_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/pq-\/crypto/sike\_r1/api\_r1.h@{crt/aws-\/crt-\/cpp/crt/s2n/pq-\/crypto/sike\_r1/api\_r1.h}}
\mbox{\hyperlink{api__r1_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/********************************************************************************************}}
\DoxyCodeLine{2 \textcolor{comment}{* Supersingular Isogeny Key Encapsulation Library}}
\DoxyCodeLine{3 \textcolor{comment}{*}}
\DoxyCodeLine{4 \textcolor{comment}{* Abstract: API header file for P503}}
\DoxyCodeLine{5 \textcolor{comment}{*********************************************************************************************/}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#ifndef \_\_P503\_API\_H\_\_}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#define \_\_P503\_API\_H\_\_}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{sike__r1__namespace_8h}{sike\_r1\_namespace.h}}"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{config__r1_8h}{config\_r1.h}}"{}}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{comment}{// Encoding of keys for KEM-\/based isogeny system "{}SIKEp503"{} (wire format):}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 \textcolor{comment}{// Elements over GF(p503) are encoded in 63 octets in little endian format (i.e., the least significant octet is located in the lowest memory address).}}
\DoxyCodeLine{16 \textcolor{comment}{// Elements (a+b*i) over GF(p503\string^2), where a and b are defined over GF(p503), are encoded as \{a, b\}, with a in the lowest memory portion.}}
\DoxyCodeLine{17 \textcolor{comment}{//}}
\DoxyCodeLine{18 \textcolor{comment}{// Private keys sk consist of the concatenation of a 24-\/byte random value, a value in the range [0, 2\string^252-\/1] and the public key pk. In the SIKE API,}}
\DoxyCodeLine{19 \textcolor{comment}{// private keys are encoded in 434 octets in little endian format.}}
\DoxyCodeLine{20 \textcolor{comment}{// Public keys pk consist of 3 elements in GF(p503\string^2). In the SIKE API, pk is encoded in 378 octets.}}
\DoxyCodeLine{21 \textcolor{comment}{// Ciphertexts ct consist of the concatenation of a public key value and a 24-\/byte value. In the SIKE API, ct is encoded in 378 + 24 = 402 octets.}}
\DoxyCodeLine{22 \textcolor{comment}{// Shared keys ss consist of a value of 16 octets.}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{comment}{/*********************** Ephemeral key exchange API ***********************/}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define SIDH\_SECRETKEYBYTES      32}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#define SIDH\_PUBLICKEYBYTES     378}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#define SIDH\_BYTES              126}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{comment}{// SECURITY NOTE: SIDH supports ephemeral Diffie-\/Hellman key exchange. It is NOT secure to use it with static keys.}}
\DoxyCodeLine{32 \textcolor{comment}{// See "{}On the Security of Supersingular Isogeny Cryptosystems"{}, S.D. Galbraith, C. Petit, B. Shani and Y.B. Ti, in ASIACRYPT 2016, 2016.}}
\DoxyCodeLine{33 \textcolor{comment}{// Extended version available at: http://eprint.iacr.org/2016/859}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{comment}{// Generation of Bob's secret key}}
\DoxyCodeLine{36 \textcolor{comment}{// Outputs random value in [0, 2\string^Floor(Log(2,3\string^159)) -\/ 1] to be used as Bob's private key}}
\DoxyCodeLine{37 \textcolor{keywordtype}{int} \mbox{\hyperlink{api__r1_8h_a6d130c218c0cc330111ad949b3710735}{random\_mod\_order\_B}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* random\_digits);}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{comment}{// Alice's ephemeral public key generation}}
\DoxyCodeLine{40 \textcolor{comment}{// Input:  a private key PrivateKeyA in the range [0, 2\string^250 -\/ 1], stored in 32 bytes.}}
\DoxyCodeLine{41 \textcolor{comment}{// Output: the public key PublicKeyA consisting of 3 GF(p503\string^2) elements encoded in 378 bytes.}}
\DoxyCodeLine{42 \textcolor{keywordtype}{int} \mbox{\hyperlink{api__r1_8h_a3116fc645132415cfe81c2bcd38b2022}{EphemeralKeyGeneration\_A}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* PrivateKeyA, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* PublicKeyA);}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{// Bob's ephemeral key-\/pair generation}}
\DoxyCodeLine{45 \textcolor{comment}{// It produces a private key PrivateKeyB and computes the public key PublicKeyB.}}
\DoxyCodeLine{46 \textcolor{comment}{// The private key is an integer in the range [0, 2\string^Floor(Log(2,3\string^159)) -\/ 1], stored in 32 bytes.}}
\DoxyCodeLine{47 \textcolor{comment}{// The public key consists of 3 GF(p503\string^2) elements encoded in 378 bytes.}}
\DoxyCodeLine{48 \textcolor{keywordtype}{int} \mbox{\hyperlink{api__r1_8h_a56bfc70562751b787eee2a36fee42427}{EphemeralKeyGeneration\_B}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* PrivateKeyB, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* PublicKeyB);}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{comment}{// Alice's ephemeral shared secret computation}}
\DoxyCodeLine{51 \textcolor{comment}{// It produces a shared secret key SharedSecretA using her secret key PrivateKeyA and Bob's public key PublicKeyB}}
\DoxyCodeLine{52 \textcolor{comment}{// Inputs: Alice's PrivateKeyA is an integer in the range [0, 2\string^250 -\/ 1], stored in 32 bytes.}}
\DoxyCodeLine{53 \textcolor{comment}{//         Bob's PublicKeyB consists of 3 GF(p503\string^2) elements encoded in 378 bytes.}}
\DoxyCodeLine{54 \textcolor{comment}{// Output: a shared secret SharedSecretA that consists of one element in GF(p503\string^2) encoded in 126 bytes.}}
\DoxyCodeLine{55 \textcolor{keywordtype}{int} \mbox{\hyperlink{api__r1_8h_a838610fc3cb816d5b3ab69b1bb39711b}{EphemeralSecretAgreement\_A}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* PrivateKeyA, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* PublicKeyB, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* SharedSecretA);}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{comment}{// Bob's ephemeral shared secret computation}}
\DoxyCodeLine{58 \textcolor{comment}{// It produces a shared secret key SharedSecretB using his secret key PrivateKeyB and Alice's public key PublicKeyA}}
\DoxyCodeLine{59 \textcolor{comment}{// Inputs: Bob's PrivateKeyB is an integer in the range [0, 2\string^Floor(Log(2,3\string^159)) -\/ 1], stored in 32 bytes.}}
\DoxyCodeLine{60 \textcolor{comment}{//         Alice's PublicKeyA consists of 3 GF(p503\string^2) elements encoded in 378 bytes.}}
\DoxyCodeLine{61 \textcolor{comment}{// Output: a shared secret SharedSecretB that consists of one element in GF(p503\string^2) encoded in 126 bytes.}}
\DoxyCodeLine{62 \textcolor{keywordtype}{int} \mbox{\hyperlink{api__r1_8h_a3ae5f211fd3ab91ac2fcef8c17cc9baa}{EphemeralSecretAgreement\_B}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}}* PrivateKeyB, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* PublicKeyA, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* SharedSecretB);}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{comment}{// Encoding of keys for KEX-\/based isogeny system "{}SIDHp503"{} (wire format):}}
\DoxyCodeLine{66 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{67 \textcolor{comment}{// Elements over GF(p503) are encoded in 63 octets in little endian format (i.e., the least significant octet is located in the lowest memory address).}}
\DoxyCodeLine{68 \textcolor{comment}{// Elements (a+b*i) over GF(p503\string^2), where a and b are defined over GF(p503), are encoded as \{a, b\}, with a in the lowest memory portion.}}
\DoxyCodeLine{69 \textcolor{comment}{//}}
\DoxyCodeLine{70 \textcolor{comment}{// Private keys PrivateKeyA and PrivateKeyB can have values in the range [0, 2\string^250-\/1] and [0, 2\string^252-\/1], resp. In the SIDH API, private keys are encoded}}
\DoxyCodeLine{71 \textcolor{comment}{// in 32 octets in little endian format.}}
\DoxyCodeLine{72 \textcolor{comment}{// Public keys PublicKeyA and PublicKeyB consist of 3 elements in GF(p503\string^2). In the SIDH API, they are encoded in 378 octets.}}
\DoxyCodeLine{73 \textcolor{comment}{// Shared keys SharedSecretA and SharedSecretB consist of one element in GF(p503\string^2). In the SIDH API, they are encoded in 126 octets.}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 }
\DoxyCodeLine{76 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
