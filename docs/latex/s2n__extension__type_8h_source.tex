\hypertarget{s2n__extension__type_8h_source}{}\doxysection{s2n\+\_\+extension\+\_\+type.\+h}
\label{s2n__extension__type_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/tls/extensions/s2n\_extension\_type.h@{crt/aws-\/crt-\/cpp/crt/s2n/tls/extensions/s2n\_extension\_type.h}}
\mbox{\hyperlink{s2n__extension__type_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdbool_8h}{stdbool.h}}>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__stuffer_8h}{stuffer/s2n\_stuffer.h}}"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__tls__parameters_8h}{tls/s2n\_tls\_parameters.h}}"{}}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#define S2N\_EXTENSION\_TYPE\_FIELD\_LENGTH     2}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define S2N\_EXTENSION\_LENGTH\_FIELD\_LENGTH   2}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{comment}{/* The number of extensions supported by S2N */}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define S2N\_SUPPORTED\_EXTENSIONS\_COUNT          (sizeof(s2n\_supported\_extensions) / sizeof(s2n\_supported\_extensions[0]))}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{comment}{/* The number of bytes needed to assign 1 bit to every supported extension.}}
\DoxyCodeLine{30 \textcolor{comment}{ * The +1 is necessary to handle any remainder left over when dividing. */}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#define S2N\_SUPPORTED\_EXTENSIONS\_BITFIELD\_LEN   ((S2N\_SUPPORTED\_EXTENSIONS\_COUNT / sizeof(char)) + 1)}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}};}
\DoxyCodeLine{34 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{}
\DoxyCodeLine{35     uint16\_t \mbox{\hyperlink{structs2n__extension__type_abf389e74bb47da699439a53ff7643995}{iana\_value}};}
\DoxyCodeLine{36     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__extension__type_a6f306aeaa498b537fd9c72e9c4b1a387}{is\_response}}:1;}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     int (*\mbox{\hyperlink{structs2n__connection_ad4cff12cbb0eedb0768b794c525b2a90}{send}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__connection_ab7d690d1a02fbd7f5aad682df58a1901}{out}});}
\DoxyCodeLine{39     int (*\mbox{\hyperlink{structs2n__connection_ad6b754dd178b26844526d97017c25e20}{recv}}) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__connection_addca8933098512273dca87e5d8b319dd}{in}});}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{comment}{/* Returns true or false to indicate whether the extension should be sent */}}
\DoxyCodeLine{42     bool (*should\_send) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{comment}{/* Handler called if an extension is not received */}}
\DoxyCodeLine{45     int (*if\_missing) (\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{46 \} \mbox{\hyperlink{structs2n__extension__type}{s2n\_extension\_type}};}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{keyword}{static} \textcolor{keyword}{const} uint16\_t \mbox{\hyperlink{s2n__extension__type_8h_a2adca0d87dd7a86dedd8c675981d4038}{s2n\_supported\_extensions}}[] = \{}
\DoxyCodeLine{49     \mbox{\hyperlink{s2n__tls__parameters_8h_a588964defd85ac156ea0941a1cc74279}{TLS\_EXTENSION\_RENEGOTIATION\_INFO}},}
\DoxyCodeLine{50     \mbox{\hyperlink{s2n__tls__parameters_8h_a320de901630947a76bec6e42d04e52b6}{TLS\_EXTENSION\_PQ\_KEM\_PARAMETERS}},}
\DoxyCodeLine{51     \mbox{\hyperlink{s2n__tls__parameters_8h_ac5af336fe762b24789dde11d13a74035}{TLS\_EXTENSION\_SERVER\_NAME}},}
\DoxyCodeLine{52     \mbox{\hyperlink{s2n__tls__parameters_8h_a5734cc9f726c14fe5f1aada2451587d9}{TLS\_EXTENSION\_MAX\_FRAG\_LEN}},}
\DoxyCodeLine{53     \mbox{\hyperlink{s2n__tls__parameters_8h_acf3d575671ffd01a1400417f16520421}{TLS\_EXTENSION\_STATUS\_REQUEST}},}
\DoxyCodeLine{54     \mbox{\hyperlink{s2n__tls__parameters_8h_a527d0afd38a85ee97f62862f74b15f45}{TLS\_EXTENSION\_SUPPORTED\_GROUPS}},}
\DoxyCodeLine{55     \mbox{\hyperlink{s2n__tls__parameters_8h_a350023b90c4e7b5de523b149308440d7}{TLS\_EXTENSION\_EC\_POINT\_FORMATS}},}
\DoxyCodeLine{56     \mbox{\hyperlink{s2n__tls__parameters_8h_a2df8cf476badc3a52f44d65caad71734}{TLS\_EXTENSION\_SIGNATURE\_ALGORITHMS}},}
\DoxyCodeLine{57     \mbox{\hyperlink{s2n__tls__parameters_8h_a753973f1e9b19bde89de02430b355128}{TLS\_EXTENSION\_ALPN}},}
\DoxyCodeLine{58     \mbox{\hyperlink{s2n__tls__parameters_8h_a56dec77da468aeb7c9afb7dac759e8b6}{TLS\_EXTENSION\_SCT\_LIST}},}
\DoxyCodeLine{59     \mbox{\hyperlink{s2n__tls__parameters_8h_a7d5aa837e504555c4ecc30c7da35ff5c}{TLS\_EXTENSION\_SESSION\_TICKET}},}
\DoxyCodeLine{60     \mbox{\hyperlink{s2n__tls__parameters_8h_a9f4caf58afa362bc813c4b74e3acbaa3}{TLS\_EXTENSION\_SUPPORTED\_VERSIONS}},}
\DoxyCodeLine{61     \mbox{\hyperlink{s2n__tls__parameters_8h_aaeff18b70e2e221fcfca58f4aecc8b83}{TLS\_EXTENSION\_KEY\_SHARE}},}
\DoxyCodeLine{62     \mbox{\hyperlink{s2n__tls__parameters_8h_a6ab465f9efcb616787fb81efdff19efc}{TLS\_EXTENSION\_COOKIE}},}
\DoxyCodeLine{63     \mbox{\hyperlink{s2n__tls__parameters_8h_a74c69c5e50ac70ba0dac8c8116e72eb7}{TLS\_QUIC\_TRANSPORT\_PARAMETERS}},}
\DoxyCodeLine{64 \};}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{keyword}{typedef} \textcolor{keywordtype}{char} \mbox{\hyperlink{s2n__extension__type_8h_aab5f1a69ceb34fcf4464514cbbb0b738}{s2n\_extension\_bitfield}}[\mbox{\hyperlink{s2n__extension__type_8h_a6eac28fc4047cb6232d79df975e38c89}{S2N\_SUPPORTED\_EXTENSIONS\_BITFIELD\_LEN}}];}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \textcolor{keyword}{typedef} uint8\_t \mbox{\hyperlink{s2n__extension__type_8h_a72bbdceddee9aabe564e48bd689a1931}{s2n\_extension\_type\_id}};}
\DoxyCodeLine{69 \textcolor{keyword}{extern} \textcolor{keyword}{const} \mbox{\hyperlink{s2n__extension__type_8h_a72bbdceddee9aabe564e48bd689a1931}{s2n\_extension\_type\_id}} \mbox{\hyperlink{s2n__extension__type_8h_acfa15c8de77f0679a8241f67c474843d}{s2n\_unsupported\_extension}};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_ac1ea3522d81b464a3844c4ad697d6328}{s2n\_extension\_send}}(\textcolor{keyword}{const} \mbox{\hyperlink{structs2n__extension__type}{s2n\_extension\_type}} *extension\_type, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__connection_ab7d690d1a02fbd7f5aad682df58a1901}{out}});}
\DoxyCodeLine{72 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_a2bda131bf9a767544d0392ce32a70263}{s2n\_extension\_recv}}(\textcolor{keyword}{const} \mbox{\hyperlink{structs2n__extension__type}{s2n\_extension\_type}} *extension\_type, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__connection_addca8933098512273dca87e5d8b319dd}{in}});}
\DoxyCodeLine{73 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_a7d088eba7640412cdcb0b14aa96fc0ef}{s2n\_extension\_is\_missing}}(\textcolor{keyword}{const} \mbox{\hyperlink{structs2n__extension__type}{s2n\_extension\_type}} *extension\_type, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 \textcolor{comment}{/* Map from TLS IANA value to internal s2n id.}}
\DoxyCodeLine{76 \textcolor{comment}{ * All possible IANA values is a large space, so using an internal id gives us more}}
\DoxyCodeLine{77 \textcolor{comment}{ * flexibility when using arrays / bitfields / etc. */}}
\DoxyCodeLine{78 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_af556a916764135d42cfda074e26d6b26}{s2n\_extension\_supported\_iana\_value\_to\_id}}(\textcolor{keyword}{const} uint16\_t iana\_value, \mbox{\hyperlink{s2n__extension__type_8h_a72bbdceddee9aabe564e48bd689a1931}{s2n\_extension\_type\_id}} *internal\_id);}
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{comment}{/* Initializer */}}
\DoxyCodeLine{81 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_ad2e9f0a332ce062e85ffcc4b5ffa30b9}{s2n\_extension\_type\_init}}();}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{comment}{/* Common implementations for send */}}
\DoxyCodeLine{84 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_af93a5c22f4a78048950121cc53bbb3f3}{s2n\_extension\_send\_unimplemented}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__connection_ab7d690d1a02fbd7f5aad682df58a1901}{out}});}
\DoxyCodeLine{85 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_ae5021cc50c548140b3244ac3898cc466}{s2n\_extension\_send\_noop}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__connection_ab7d690d1a02fbd7f5aad682df58a1901}{out}});}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 \textcolor{comment}{/* Common implementations for recv */}}
\DoxyCodeLine{88 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_a62209926dd424606c37d4839921767ce}{s2n\_extension\_recv\_unimplemented}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__connection_addca8933098512273dca87e5d8b319dd}{in}});}
\DoxyCodeLine{89 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_a0342644dbb881da159cbd800ee7ad037}{s2n\_extension\_recv\_noop}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__connection_ab7d690d1a02fbd7f5aad682df58a1901}{out}});}
\DoxyCodeLine{90 }
\DoxyCodeLine{91 \textcolor{comment}{/* Common implementations for should\_send */}}
\DoxyCodeLine{92 \textcolor{keywordtype}{bool} \mbox{\hyperlink{s2n__extension__type_8h_a444191e72de6721da34d66ef5ce48ff4}{s2n\_extension\_always\_send}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{93 \textcolor{keywordtype}{bool} \mbox{\hyperlink{s2n__extension__type_8h_a98514bf5f94e97ef5393778af4bdd9fe}{s2n\_extension\_never\_send}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{94 \textcolor{keywordtype}{bool} \mbox{\hyperlink{s2n__extension__type_8h_aabd95606ea44116bc4a067af049ecbaf}{s2n\_extension\_send\_if\_tls13\_connection}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{comment}{/* Common implementations for if\_missing */}}
\DoxyCodeLine{97 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_a9bdc5b94af7bbb2280eb5fe6ca4920ff}{s2n\_extension\_error\_if\_missing}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{98 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__extension__type_8h_a732ba945ae582c3a38a17901c599298a}{s2n\_extension\_noop\_if\_missing}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}

\end{DoxyCode}
