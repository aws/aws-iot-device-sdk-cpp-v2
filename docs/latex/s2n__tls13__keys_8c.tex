\hypertarget{s2n__tls13__keys_8c}{}\doxysection{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\+\_\+tls13\+\_\+keys.c File Reference}
\label{s2n__tls13__keys_8c}\index{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_tls13\_keys.c@{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_tls13\_keys.c}}
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include \char`\"{}error/s2n\+\_\+errno.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+hmac.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+hkdf.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+tls13\+\_\+keys.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+blob.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+safety.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+mem.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \mbox{\hyperlink{s2n__tls13__keys_8c_a237a59e61af9d37cda2a24c0902468ca}{s2n\+\_\+tls13\+\_\+transcript\+\_\+message\+\_\+hash}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys, const struct s2n\+\_\+blob $\ast$message, struct s2n\+\_\+blob $\ast$message\+\_\+digest)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_a73d4a15ec702547b792cf0a92a9e49cf}{s2n\+\_\+tls13\+\_\+keys\+\_\+init}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys, \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\+\_\+hmac\+\_\+algorithm}} alg)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_ae2a8fcc16131859c1f3e4d47b7f3e2c4}{s2n\+\_\+tls13\+\_\+keys\+\_\+free}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_afe535caf91a8f06e231fbae0e9341725}{s2n\+\_\+tls13\+\_\+derive\+\_\+early\+\_\+secrets}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_a3a897329e08bb1385cbd29463a63a2a8}{s2n\+\_\+tls13\+\_\+derive\+\_\+handshake\+\_\+secrets}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys, const struct s2n\+\_\+blob $\ast$ecdhe, struct \mbox{\hyperlink{structs2n__hash__state}{s2n\+\_\+hash\+\_\+state}} $\ast$client\+\_\+server\+\_\+hello\+\_\+hash, struct s2n\+\_\+blob $\ast$client\+\_\+secret, struct s2n\+\_\+blob $\ast$server\+\_\+secret)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_a748b9565f5a5cf563e0256aa8125afc9}{s2n\+\_\+tls13\+\_\+extract\+\_\+master\+\_\+secret}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_a57d058c30b2ec66821d8d007db8a4e40}{s2n\+\_\+tls13\+\_\+derive\+\_\+application\+\_\+secret}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys, struct \mbox{\hyperlink{structs2n__hash__state}{s2n\+\_\+hash\+\_\+state}} $\ast$hashes, struct s2n\+\_\+blob $\ast$secret\+\_\+blob, \mbox{\hyperlink{s2n_8h_a77a64e3b657f90d221c5faf99c643cdb}{s2n\+\_\+mode}} mode)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_a2f192c5fd6dc632ebbb8a6ba802b90c6}{s2n\+\_\+tls13\+\_\+derive\+\_\+traffic\+\_\+keys}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys, struct s2n\+\_\+blob $\ast$secret, struct s2n\+\_\+blob $\ast$key, struct s2n\+\_\+blob $\ast$iv)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_ada106d0afa5592820ce27b0caf335059}{s2n\+\_\+tls13\+\_\+derive\+\_\+finished\+\_\+key}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys, struct s2n\+\_\+blob $\ast$secret\+\_\+key, struct s2n\+\_\+blob $\ast$output\+\_\+finish\+\_\+key)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_aad7b579363359af2c7d5ea8aaeb1c6fb}{s2n\+\_\+tls13\+\_\+calculate\+\_\+finished\+\_\+mac}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys, struct s2n\+\_\+blob $\ast$finished\+\_\+key, struct \mbox{\hyperlink{structs2n__hash__state}{s2n\+\_\+hash\+\_\+state}} $\ast$hash\+\_\+state, struct s2n\+\_\+blob $\ast$finished\+\_\+verify)
\item 
int \mbox{\hyperlink{s2n__tls13__keys_8c_a2531ae718b45e6a8126deaa95a145bf1}{s2n\+\_\+tls13\+\_\+update\+\_\+application\+\_\+traffic\+\_\+secret}} (struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$keys, struct s2n\+\_\+blob $\ast$old\+\_\+secret, struct s2n\+\_\+blob $\ast$new\+\_\+secret)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const struct s2n\+\_\+blob \mbox{\hyperlink{s2n__tls13__keys_8c_ac08bb2a15c3efd550b55a070f994637a}{zero\+\_\+length\+\_\+blob}} = \{ .data = NULL, .size = 0 \}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{s2n__tls13__keys_8c_aad7b579363359af2c7d5ea8aaeb1c6fb}\label{s2n__tls13__keys_8c_aad7b579363359af2c7d5ea8aaeb1c6fb}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_calculate\_finished\_mac@{s2n\_tls13\_calculate\_finished\_mac}}
\index{s2n\_tls13\_calculate\_finished\_mac@{s2n\_tls13\_calculate\_finished\_mac}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_calculate\_finished\_mac()}{s2n\_tls13\_calculate\_finished\_mac()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+calculate\+\_\+finished\+\_\+mac (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys,  }\item[{struct s2n\+\_\+blob $\ast$}]{finished\+\_\+key,  }\item[{struct \mbox{\hyperlink{structs2n__hash__state}{s2n\+\_\+hash\+\_\+state}} $\ast$}]{hash\+\_\+state,  }\item[{struct s2n\+\_\+blob $\ast$}]{finished\+\_\+verify }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_a57d058c30b2ec66821d8d007db8a4e40}\label{s2n__tls13__keys_8c_a57d058c30b2ec66821d8d007db8a4e40}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_derive\_application\_secret@{s2n\_tls13\_derive\_application\_secret}}
\index{s2n\_tls13\_derive\_application\_secret@{s2n\_tls13\_derive\_application\_secret}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_derive\_application\_secret()}{s2n\_tls13\_derive\_application\_secret()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+derive\+\_\+application\+\_\+secret (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys,  }\item[{struct \mbox{\hyperlink{structs2n__hash__state}{s2n\+\_\+hash\+\_\+state}} $\ast$}]{hashes,  }\item[{struct s2n\+\_\+blob $\ast$}]{secret\+\_\+blob,  }\item[{\mbox{\hyperlink{s2n_8h_a77a64e3b657f90d221c5faf99c643cdb}{s2n\+\_\+mode}}}]{mode }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_afe535caf91a8f06e231fbae0e9341725}\label{s2n__tls13__keys_8c_afe535caf91a8f06e231fbae0e9341725}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_derive\_early\_secrets@{s2n\_tls13\_derive\_early\_secrets}}
\index{s2n\_tls13\_derive\_early\_secrets@{s2n\_tls13\_derive\_early\_secrets}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_derive\_early\_secrets()}{s2n\_tls13\_derive\_early\_secrets()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+derive\+\_\+early\+\_\+secrets (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_ada106d0afa5592820ce27b0caf335059}\label{s2n__tls13__keys_8c_ada106d0afa5592820ce27b0caf335059}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_derive\_finished\_key@{s2n\_tls13\_derive\_finished\_key}}
\index{s2n\_tls13\_derive\_finished\_key@{s2n\_tls13\_derive\_finished\_key}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_derive\_finished\_key()}{s2n\_tls13\_derive\_finished\_key()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+derive\+\_\+finished\+\_\+key (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys,  }\item[{struct s2n\+\_\+blob $\ast$}]{secret\+\_\+key,  }\item[{struct s2n\+\_\+blob $\ast$}]{output\+\_\+finish\+\_\+key }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_a3a897329e08bb1385cbd29463a63a2a8}\label{s2n__tls13__keys_8c_a3a897329e08bb1385cbd29463a63a2a8}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_derive\_handshake\_secrets@{s2n\_tls13\_derive\_handshake\_secrets}}
\index{s2n\_tls13\_derive\_handshake\_secrets@{s2n\_tls13\_derive\_handshake\_secrets}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_derive\_handshake\_secrets()}{s2n\_tls13\_derive\_handshake\_secrets()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+derive\+\_\+handshake\+\_\+secrets (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys,  }\item[{const struct s2n\+\_\+blob $\ast$}]{ecdhe,  }\item[{struct \mbox{\hyperlink{structs2n__hash__state}{s2n\+\_\+hash\+\_\+state}} $\ast$}]{client\+\_\+server\+\_\+hello\+\_\+hash,  }\item[{struct s2n\+\_\+blob $\ast$}]{client\+\_\+secret,  }\item[{struct s2n\+\_\+blob $\ast$}]{server\+\_\+secret }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_a2f192c5fd6dc632ebbb8a6ba802b90c6}\label{s2n__tls13__keys_8c_a2f192c5fd6dc632ebbb8a6ba802b90c6}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_derive\_traffic\_keys@{s2n\_tls13\_derive\_traffic\_keys}}
\index{s2n\_tls13\_derive\_traffic\_keys@{s2n\_tls13\_derive\_traffic\_keys}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_derive\_traffic\_keys()}{s2n\_tls13\_derive\_traffic\_keys()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+derive\+\_\+traffic\+\_\+keys (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys,  }\item[{struct s2n\+\_\+blob $\ast$}]{secret,  }\item[{struct s2n\+\_\+blob $\ast$}]{key,  }\item[{struct s2n\+\_\+blob $\ast$}]{iv }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_a748b9565f5a5cf563e0256aa8125afc9}\label{s2n__tls13__keys_8c_a748b9565f5a5cf563e0256aa8125afc9}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_extract\_master\_secret@{s2n\_tls13\_extract\_master\_secret}}
\index{s2n\_tls13\_extract\_master\_secret@{s2n\_tls13\_extract\_master\_secret}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_extract\_master\_secret()}{s2n\_tls13\_extract\_master\_secret()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+extract\+\_\+master\+\_\+secret (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_ae2a8fcc16131859c1f3e4d47b7f3e2c4}\label{s2n__tls13__keys_8c_ae2a8fcc16131859c1f3e4d47b7f3e2c4}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_keys\_free@{s2n\_tls13\_keys\_free}}
\index{s2n\_tls13\_keys\_free@{s2n\_tls13\_keys\_free}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_keys\_free()}{s2n\_tls13\_keys\_free()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+keys\+\_\+free (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_a73d4a15ec702547b792cf0a92a9e49cf}\label{s2n__tls13__keys_8c_a73d4a15ec702547b792cf0a92a9e49cf}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_keys\_init@{s2n\_tls13\_keys\_init}}
\index{s2n\_tls13\_keys\_init@{s2n\_tls13\_keys\_init}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_keys\_init()}{s2n\_tls13\_keys\_init()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+keys\+\_\+init (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys,  }\item[{\mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\+\_\+hmac\+\_\+algorithm}}}]{alg }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__tls13__keys_8c_a237a59e61af9d37cda2a24c0902468ca}\label{s2n__tls13__keys_8c_a237a59e61af9d37cda2a24c0902468ca}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_transcript\_message\_hash@{s2n\_tls13\_transcript\_message\_hash}}
\index{s2n\_tls13\_transcript\_message\_hash@{s2n\_tls13\_transcript\_message\_hash}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_transcript\_message\_hash()}{s2n\_tls13\_transcript\_message\_hash()}}
{\footnotesize\ttfamily static int s2n\+\_\+tls13\+\_\+transcript\+\_\+message\+\_\+hash (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys,  }\item[{const struct s2n\+\_\+blob $\ast$}]{message,  }\item[{struct s2n\+\_\+blob $\ast$}]{message\+\_\+digest }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__tls13__keys_8c_a2531ae718b45e6a8126deaa95a145bf1}\label{s2n__tls13__keys_8c_a2531ae718b45e6a8126deaa95a145bf1}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!s2n\_tls13\_update\_application\_traffic\_secret@{s2n\_tls13\_update\_application\_traffic\_secret}}
\index{s2n\_tls13\_update\_application\_traffic\_secret@{s2n\_tls13\_update\_application\_traffic\_secret}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{s2n\_tls13\_update\_application\_traffic\_secret()}{s2n\_tls13\_update\_application\_traffic\_secret()}}
{\footnotesize\ttfamily int s2n\+\_\+tls13\+\_\+update\+\_\+application\+\_\+traffic\+\_\+secret (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__tls13__keys}{s2n\+\_\+tls13\+\_\+keys}} $\ast$}]{keys,  }\item[{struct s2n\+\_\+blob $\ast$}]{old\+\_\+secret,  }\item[{struct s2n\+\_\+blob $\ast$}]{new\+\_\+secret }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{s2n__tls13__keys_8c_ac08bb2a15c3efd550b55a070f994637a}\label{s2n__tls13__keys_8c_ac08bb2a15c3efd550b55a070f994637a}} 
\index{s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}!zero\_length\_blob@{zero\_length\_blob}}
\index{zero\_length\_blob@{zero\_length\_blob}!s2n\_tls13\_keys.c@{s2n\_tls13\_keys.c}}
\doxysubsubsection{\texorpdfstring{zero\_length\_blob}{zero\_length\_blob}}
{\footnotesize\ttfamily const struct s2n\+\_\+blob zero\+\_\+length\+\_\+blob = \{ .data = NULL, .size = 0 \}\hspace{0.3cm}{\ttfamily [static]}}

