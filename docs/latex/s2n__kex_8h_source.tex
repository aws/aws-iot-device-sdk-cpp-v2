\hypertarget{s2n__kex_8h_source}{}\doxysection{s2n\+\_\+kex.\+h}
\label{s2n__kex_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_kex.h@{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_kex.h}}
\mbox{\hyperlink{s2n__kex_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__connection_8h}{tls/s2n\_connection.h}}"{}}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__kex__data_8h}{tls/s2n\_kex\_data.h}}"{}}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex}{s2n\_kex}} \{}
\DoxyCodeLine{23     uint8\_t \mbox{\hyperlink{structs2n__kex_a00ac54cb55ea6bea796f686ac2bcb8bd}{is\_ephemeral}};}
\DoxyCodeLine{24     \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *\mbox{\hyperlink{structs2n__kex_a88e6e908472b6bbe925e07d06edd294a}{hybrid}}[2];}
\DoxyCodeLine{25 }
\DoxyCodeLine{26     int (*\mbox{\hyperlink{structs2n__kex_ad8d0aede9492b699837428c533eb66f2}{connection\_supported}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher__suite}{s2n\_cipher\_suite}} *cipher\_suite, \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{27     int (*\mbox{\hyperlink{structs2n__kex_a70ccab4b96314b67b62c9f4212ccae36}{configure\_connection}})(\textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__cipher__suite}{s2n\_cipher\_suite}} *cipher\_suite, \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{28     int (*\mbox{\hyperlink{structs2n__kex_ac2024ca6aaa5be41e438ce079483be36}{server\_key\_recv\_read\_data}})(\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct }s2n\_blob *data\_to\_verify, \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex__raw__server__data}{s2n\_kex\_raw\_server\_data}} *kex\_data);}
\DoxyCodeLine{29     int (*\mbox{\hyperlink{structs2n__kex_a8f7d14a21b09fcc9c4f434bc7027a36b}{server\_key\_recv\_parse\_data}})(\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex__raw__server__data}{s2n\_kex\_raw\_server\_data}} *kex\_data);}
\DoxyCodeLine{30     int (*\mbox{\hyperlink{structs2n__kex_af3977217cad0066bff4d7abefc0bc9e1}{server\_key\_send}})(\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct }s2n\_blob *data\_to\_sign);}
\DoxyCodeLine{31     int (*\mbox{\hyperlink{structs2n__kex_a9d0bad6138a816049c39af8b32fcbf93}{client\_key\_recv}})(\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct }s2n\_blob *shared\_key);}
\DoxyCodeLine{32     int (*\mbox{\hyperlink{structs2n__kex_aa68a36c995d0de8064d6f3562be08894}{client\_key\_send}})(\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct }s2n\_blob *shared\_key);}
\DoxyCodeLine{33     int (*\mbox{\hyperlink{structs2n__kex_a78e4781ec4e8177a4ed716105db0bbcc}{prf}})(\textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct }s2n\_blob *premaster\_secret);}
\DoxyCodeLine{34 \};}
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex}{s2n\_kex}} \mbox{\hyperlink{structs2n__kem}{s2n\_kem}};}
\DoxyCodeLine{37 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex}{s2n\_kex}} \mbox{\hyperlink{s2n__kex_8h_a551ef04c3e467905fdbd6c573fedf81d}{s2n\_rsa}};}
\DoxyCodeLine{38 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex}{s2n\_kex}} \mbox{\hyperlink{s2n__kex_8h_a9067d2980a0907a5d08aa93955944a2c}{s2n\_dhe}};}
\DoxyCodeLine{39 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex}{s2n\_kex}} \mbox{\hyperlink{s2n__kex_8h_a39e8e425555549bb718fd771747399a9}{s2n\_ecdhe}};}
\DoxyCodeLine{40 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__kex}{s2n\_kex}} \mbox{\hyperlink{s2n__kex_8h_a96c557561657d2b0668dd93d7a718c1b}{s2n\_hybrid\_ecdhe\_kem}};}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_acdf73ee06e884d09501b743f447dd80d}{s2n\_kex\_supported}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cipher__suite}{s2n\_cipher\_suite}} *cipher\_suite, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{43 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_a5d64bfe869978910419c2a9d6fb4f9b6}{s2n\_configure\_kex}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cipher__suite}{s2n\_cipher\_suite}} *cipher\_suite, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{44 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_a4844fa0417149b17f63f918a3cdbb326}{s2n\_kex\_is\_ephemeral}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *kex);}
\DoxyCodeLine{45 }
\DoxyCodeLine{46 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_aaf2fc7bf4cadea885c0e5e0af5587890}{s2n\_kex\_server\_key\_recv\_read\_data}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *kex, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} s2n\_blob *data\_to\_verify,}
\DoxyCodeLine{47         \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex__raw__server__data}{s2n\_kex\_raw\_server\_data}} *raw\_server\_data);}
\DoxyCodeLine{48 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_a441b017d7fcec56003c216db0b471b2b}{s2n\_kex\_server\_key\_recv\_parse\_data}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *kex, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex__raw__server__data}{s2n\_kex\_raw\_server\_data}} *raw\_server\_data);}
\DoxyCodeLine{49 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_ab7fcde82cb92a8ed5c83d8cb270a1fe6}{s2n\_kex\_server\_key\_send}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *kex, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} s2n\_blob *data\_to\_sign);}
\DoxyCodeLine{50 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_a8aee31da3879a3949635b26fea27c6a9}{s2n\_kex\_client\_key\_recv}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *kex, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} s2n\_blob *shared\_key);}
\DoxyCodeLine{51 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_a1fdde1ff8ebd70db29bde876ad97f725}{s2n\_kex\_client\_key\_send}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *kex, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} s2n\_blob *shared\_key);}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__kex_8h_a43cb690639ca2281aef238ecbcb816fb}{s2n\_kex\_tls\_prf}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *kex, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} s2n\_blob *premaster\_secret);}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} \mbox{\hyperlink{s2n__kex_8h_a904282bec21c3f5467f77710fc02a02c}{s2n\_kex\_includes}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *kex, \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kex}{s2n\_kex}} *query);}

\end{DoxyCode}
