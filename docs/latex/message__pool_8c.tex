\hypertarget{message__pool_8c}{}\doxysection{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/io/source/message\+\_\+pool.c File Reference}
\label{message__pool_8c}\index{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/io/source/message\_pool.c@{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/io/source/message\_pool.c}}
{\ttfamily \#include $<$aws/io/message\+\_\+pool.\+h$>$}\newline
{\ttfamily \#include $<$aws/common/thread.\+h$>$}\newline
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structmessage__pool__allocator}{message\+\_\+pool\+\_\+allocator}}
\item 
struct \mbox{\hyperlink{structmessage__wrapper}{message\+\_\+wrapper}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{message__pool_8c_a2e2ea25375c676a8f9fbcf4b8ec66e67}{aws\+\_\+memory\+\_\+pool\+\_\+init}} (struct \mbox{\hyperlink{structaws__memory__pool}{aws\+\_\+memory\+\_\+pool}} $\ast$mempool, struct \mbox{\hyperlink{structaws__allocator}{aws\+\_\+allocator}} $\ast$alloc, uint16\+\_\+t ideal\+\_\+segment\+\_\+count, size\+\_\+t segment\+\_\+size)
\item 
void \mbox{\hyperlink{message__pool_8c_a99b84c135da4cce8b082ac82087254a5}{aws\+\_\+memory\+\_\+pool\+\_\+clean\+\_\+up}} (struct \mbox{\hyperlink{structaws__memory__pool}{aws\+\_\+memory\+\_\+pool}} $\ast$mempool)
\item 
void $\ast$ \mbox{\hyperlink{message__pool_8c_ab8f3e45299e094911028a9ad634f91ab}{aws\+\_\+memory\+\_\+pool\+\_\+acquire}} (struct \mbox{\hyperlink{structaws__memory__pool}{aws\+\_\+memory\+\_\+pool}} $\ast$mempool)
\item 
void \mbox{\hyperlink{message__pool_8c_af343eeb0e401d7a5d5f5ed2f18a97cbb}{aws\+\_\+memory\+\_\+pool\+\_\+release}} (struct \mbox{\hyperlink{structaws__memory__pool}{aws\+\_\+memory\+\_\+pool}} $\ast$mempool, void $\ast$to\+\_\+release)
\item 
void $\ast$ \mbox{\hyperlink{message__pool_8c_a6caee8a0e254255aa7b76f8fc9f85829}{s\+\_\+message\+\_\+pool\+\_\+mem\+\_\+acquire}} (struct \mbox{\hyperlink{structaws__allocator}{aws\+\_\+allocator}} $\ast$\mbox{\hyperlink{socket__test_8c_a130cc941753892421e3f70bdee1049d1}{allocator}}, size\+\_\+t size)
\item 
void \mbox{\hyperlink{message__pool_8c_ab92020faf1ea2d1f70932ceee62e43d7}{s\+\_\+message\+\_\+pool\+\_\+mem\+\_\+release}} (struct \mbox{\hyperlink{structaws__allocator}{aws\+\_\+allocator}} $\ast$\mbox{\hyperlink{socket__test_8c_a130cc941753892421e3f70bdee1049d1}{allocator}}, void $\ast$ptr)
\item 
int \mbox{\hyperlink{message__pool_8c_ae1e329e24764d797323664ae60193147}{aws\+\_\+message\+\_\+pool\+\_\+init}} (struct \mbox{\hyperlink{structaws__message__pool}{aws\+\_\+message\+\_\+pool}} $\ast$msg\+\_\+pool, struct \mbox{\hyperlink{structaws__allocator}{aws\+\_\+allocator}} $\ast$alloc, struct \mbox{\hyperlink{structaws__message__pool__creation__args}{aws\+\_\+message\+\_\+pool\+\_\+creation\+\_\+args}} $\ast$args)
\item 
void \mbox{\hyperlink{message__pool_8c_a93bbfa976bfc3c99526d4c4853d4eda8}{aws\+\_\+message\+\_\+pool\+\_\+clean\+\_\+up}} (struct \mbox{\hyperlink{structaws__message__pool}{aws\+\_\+message\+\_\+pool}} $\ast$msg\+\_\+pool)
\item 
struct \mbox{\hyperlink{structaws__io__message}{aws\+\_\+io\+\_\+message}} $\ast$ \mbox{\hyperlink{message__pool_8c_af010476ef0b16c387a7d531cfebae859}{aws\+\_\+message\+\_\+pool\+\_\+acquire}} (struct \mbox{\hyperlink{structaws__message__pool}{aws\+\_\+message\+\_\+pool}} $\ast$msg\+\_\+pool, enum \mbox{\hyperlink{io_8h_a0613a6ef5306823c98d09f67957af701}{aws\+\_\+io\+\_\+message\+\_\+type}} \mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_ad0d320d82426002775afef62bff133a7}{message\+\_\+type}}, size\+\_\+t size\+\_\+hint)
\item 
void \mbox{\hyperlink{message__pool_8c_ad61616e3c9df6e78238897494d48b777}{aws\+\_\+message\+\_\+pool\+\_\+release}} (struct \mbox{\hyperlink{structaws__message__pool}{aws\+\_\+message\+\_\+pool}} $\ast$msg\+\_\+pool, struct \mbox{\hyperlink{structaws__io__message}{aws\+\_\+io\+\_\+message}} $\ast$\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_a6095cc5ed7333d602d0c342e436eb2c5}{message}})
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static size\+\_\+t \mbox{\hyperlink{message__pool_8c_a20a3d3da22aa59e60298d6d4749931c3}{MSG\+\_\+\+OVERHEAD}} = sizeof(struct \mbox{\hyperlink{structaws__io__message}{aws\+\_\+io\+\_\+message}}) + sizeof(struct \mbox{\hyperlink{structmessage__pool__allocator}{message\+\_\+pool\+\_\+allocator}})
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{message__pool_8c_ab8f3e45299e094911028a9ad634f91ab}\label{message__pool_8c_ab8f3e45299e094911028a9ad634f91ab}} 
\index{message\_pool.c@{message\_pool.c}!aws\_memory\_pool\_acquire@{aws\_memory\_pool\_acquire}}
\index{aws\_memory\_pool\_acquire@{aws\_memory\_pool\_acquire}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{aws\_memory\_pool\_acquire()}{aws\_memory\_pool\_acquire()}}
{\footnotesize\ttfamily void$\ast$ aws\+\_\+memory\+\_\+pool\+\_\+acquire (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__memory__pool}{aws\+\_\+memory\+\_\+pool}} $\ast$}]{mempool }\end{DoxyParamCaption})}

Acquires memory from the pool if available, otherwise, it attempts to allocate and returns the result. \mbox{\Hypertarget{message__pool_8c_a99b84c135da4cce8b082ac82087254a5}\label{message__pool_8c_a99b84c135da4cce8b082ac82087254a5}} 
\index{message\_pool.c@{message\_pool.c}!aws\_memory\_pool\_clean\_up@{aws\_memory\_pool\_clean\_up}}
\index{aws\_memory\_pool\_clean\_up@{aws\_memory\_pool\_clean\_up}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{aws\_memory\_pool\_clean\_up()}{aws\_memory\_pool\_clean\_up()}}
{\footnotesize\ttfamily void aws\+\_\+memory\+\_\+pool\+\_\+clean\+\_\+up (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__memory__pool}{aws\+\_\+memory\+\_\+pool}} $\ast$}]{mempool }\end{DoxyParamCaption})}

\mbox{\Hypertarget{message__pool_8c_a2e2ea25375c676a8f9fbcf4b8ec66e67}\label{message__pool_8c_a2e2ea25375c676a8f9fbcf4b8ec66e67}} 
\index{message\_pool.c@{message\_pool.c}!aws\_memory\_pool\_init@{aws\_memory\_pool\_init}}
\index{aws\_memory\_pool\_init@{aws\_memory\_pool\_init}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{aws\_memory\_pool\_init()}{aws\_memory\_pool\_init()}}
{\footnotesize\ttfamily int aws\+\_\+memory\+\_\+pool\+\_\+init (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__memory__pool}{aws\+\_\+memory\+\_\+pool}} $\ast$}]{mempool,  }\item[{struct \mbox{\hyperlink{structaws__allocator}{aws\+\_\+allocator}} $\ast$}]{alloc,  }\item[{uint16\+\_\+t}]{ideal\+\_\+segment\+\_\+count,  }\item[{size\+\_\+t}]{segment\+\_\+size }\end{DoxyParamCaption})}

Copyright Amazon.\+com, Inc. or its affiliates. All Rights Reserved. SPDX-\/\+License-\/\+Identifier\+: Apache-\/2.\+0. \mbox{\Hypertarget{message__pool_8c_af343eeb0e401d7a5d5f5ed2f18a97cbb}\label{message__pool_8c_af343eeb0e401d7a5d5f5ed2f18a97cbb}} 
\index{message\_pool.c@{message\_pool.c}!aws\_memory\_pool\_release@{aws\_memory\_pool\_release}}
\index{aws\_memory\_pool\_release@{aws\_memory\_pool\_release}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{aws\_memory\_pool\_release()}{aws\_memory\_pool\_release()}}
{\footnotesize\ttfamily void aws\+\_\+memory\+\_\+pool\+\_\+release (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__memory__pool}{aws\+\_\+memory\+\_\+pool}} $\ast$}]{mempool,  }\item[{void $\ast$}]{to\+\_\+release }\end{DoxyParamCaption})}

Releases memory to the pool if space is available, otherwise frees {\ttfamily to\+\_\+release} \mbox{\Hypertarget{message__pool_8c_af010476ef0b16c387a7d531cfebae859}\label{message__pool_8c_af010476ef0b16c387a7d531cfebae859}} 
\index{message\_pool.c@{message\_pool.c}!aws\_message\_pool\_acquire@{aws\_message\_pool\_acquire}}
\index{aws\_message\_pool\_acquire@{aws\_message\_pool\_acquire}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{aws\_message\_pool\_acquire()}{aws\_message\_pool\_acquire()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structaws__io__message}{aws\+\_\+io\+\_\+message}}$\ast$ aws\+\_\+message\+\_\+pool\+\_\+acquire (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__message__pool}{aws\+\_\+message\+\_\+pool}} $\ast$}]{msg\+\_\+pool,  }\item[{enum \mbox{\hyperlink{io_8h_a0613a6ef5306823c98d09f67957af701}{aws\+\_\+io\+\_\+message\+\_\+type}}}]{message\+\_\+type,  }\item[{size\+\_\+t}]{size\+\_\+hint }\end{DoxyParamCaption})}

Acquires a message from the pool if available, otherwise, it attempts to allocate. If a message is acquired, note that size\+\_\+hint is just a hint. the return value\textquotesingle{}s capacity will be set to the actual buffer size. \mbox{\Hypertarget{message__pool_8c_a93bbfa976bfc3c99526d4c4853d4eda8}\label{message__pool_8c_a93bbfa976bfc3c99526d4c4853d4eda8}} 
\index{message\_pool.c@{message\_pool.c}!aws\_message\_pool\_clean\_up@{aws\_message\_pool\_clean\_up}}
\index{aws\_message\_pool\_clean\_up@{aws\_message\_pool\_clean\_up}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{aws\_message\_pool\_clean\_up()}{aws\_message\_pool\_clean\_up()}}
{\footnotesize\ttfamily void aws\+\_\+message\+\_\+pool\+\_\+clean\+\_\+up (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__message__pool}{aws\+\_\+message\+\_\+pool}} $\ast$}]{msg\+\_\+pool }\end{DoxyParamCaption})}

\mbox{\Hypertarget{message__pool_8c_ae1e329e24764d797323664ae60193147}\label{message__pool_8c_ae1e329e24764d797323664ae60193147}} 
\index{message\_pool.c@{message\_pool.c}!aws\_message\_pool\_init@{aws\_message\_pool\_init}}
\index{aws\_message\_pool\_init@{aws\_message\_pool\_init}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{aws\_message\_pool\_init()}{aws\_message\_pool\_init()}}
{\footnotesize\ttfamily int aws\+\_\+message\+\_\+pool\+\_\+init (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__message__pool}{aws\+\_\+message\+\_\+pool}} $\ast$}]{msg\+\_\+pool,  }\item[{struct \mbox{\hyperlink{structaws__allocator}{aws\+\_\+allocator}} $\ast$}]{alloc,  }\item[{struct \mbox{\hyperlink{structaws__message__pool__creation__args}{aws\+\_\+message\+\_\+pool\+\_\+creation\+\_\+args}} $\ast$}]{args }\end{DoxyParamCaption})}

Initializes message pool using \textquotesingle{}msg\+\_\+pool\textquotesingle{} as the backing pool, \textquotesingle{}args\textquotesingle{} is copied. \mbox{\Hypertarget{message__pool_8c_ad61616e3c9df6e78238897494d48b777}\label{message__pool_8c_ad61616e3c9df6e78238897494d48b777}} 
\index{message\_pool.c@{message\_pool.c}!aws\_message\_pool\_release@{aws\_message\_pool\_release}}
\index{aws\_message\_pool\_release@{aws\_message\_pool\_release}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{aws\_message\_pool\_release()}{aws\_message\_pool\_release()}}
{\footnotesize\ttfamily void aws\+\_\+message\+\_\+pool\+\_\+release (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__message__pool}{aws\+\_\+message\+\_\+pool}} $\ast$}]{msg\+\_\+pool,  }\item[{struct \mbox{\hyperlink{structaws__io__message}{aws\+\_\+io\+\_\+message}} $\ast$}]{message }\end{DoxyParamCaption})}

Releases message to the pool if space is available, otherwise frees {\ttfamily message} 
\begin{DoxyParams}{Parameters}
{\em message} & \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{message__pool_8c_a6caee8a0e254255aa7b76f8fc9f85829}\label{message__pool_8c_a6caee8a0e254255aa7b76f8fc9f85829}} 
\index{message\_pool.c@{message\_pool.c}!s\_message\_pool\_mem\_acquire@{s\_message\_pool\_mem\_acquire}}
\index{s\_message\_pool\_mem\_acquire@{s\_message\_pool\_mem\_acquire}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{s\_message\_pool\_mem\_acquire()}{s\_message\_pool\_mem\_acquire()}}
{\footnotesize\ttfamily void$\ast$ s\+\_\+message\+\_\+pool\+\_\+mem\+\_\+acquire (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__allocator}{aws\+\_\+allocator}} $\ast$}]{allocator,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}

\mbox{\Hypertarget{message__pool_8c_ab92020faf1ea2d1f70932ceee62e43d7}\label{message__pool_8c_ab92020faf1ea2d1f70932ceee62e43d7}} 
\index{message\_pool.c@{message\_pool.c}!s\_message\_pool\_mem\_release@{s\_message\_pool\_mem\_release}}
\index{s\_message\_pool\_mem\_release@{s\_message\_pool\_mem\_release}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{s\_message\_pool\_mem\_release()}{s\_message\_pool\_mem\_release()}}
{\footnotesize\ttfamily void s\+\_\+message\+\_\+pool\+\_\+mem\+\_\+release (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__allocator}{aws\+\_\+allocator}} $\ast$}]{allocator,  }\item[{void $\ast$}]{ptr }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{message__pool_8c_a20a3d3da22aa59e60298d6d4749931c3}\label{message__pool_8c_a20a3d3da22aa59e60298d6d4749931c3}} 
\index{message\_pool.c@{message\_pool.c}!MSG\_OVERHEAD@{MSG\_OVERHEAD}}
\index{MSG\_OVERHEAD@{MSG\_OVERHEAD}!message\_pool.c@{message\_pool.c}}
\doxysubsubsection{\texorpdfstring{MSG\_OVERHEAD}{MSG\_OVERHEAD}}
{\footnotesize\ttfamily size\+\_\+t MSG\+\_\+\+OVERHEAD = sizeof(struct \mbox{\hyperlink{structaws__io__message}{aws\+\_\+io\+\_\+message}}) + sizeof(struct \mbox{\hyperlink{structmessage__pool__allocator}{message\+\_\+pool\+\_\+allocator}})\hspace{0.3cm}{\ttfamily [static]}}

