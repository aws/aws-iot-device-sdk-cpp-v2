\hypertarget{s2n__malformed__handshake__test_8c}{}\doxysection{crt/aws-\/crt-\/cpp/crt/s2n/tests/unit/s2n\+\_\+malformed\+\_\+handshake\+\_\+test.c File Reference}
\label{s2n__malformed__handshake__test_8c}\index{crt/aws-\/crt-\/cpp/crt/s2n/tests/unit/s2n\_malformed\_handshake\_test.c@{crt/aws-\/crt-\/cpp/crt/s2n/tests/unit/s2n\_malformed\_handshake\_test.c}}
{\ttfamily \#include \char`\"{}s2n\+\_\+test.\+h\char`\"{}}\newline
{\ttfamily \#include $<$sys/wait.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$s2n.\+h$>$}\newline
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+connection.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+handshake.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{s2n__malformed__handshake__test_8c_afe02a145f0d3a71b14d61e2774987f9d}{TLS\+\_\+\+ALERT}}~21
\item 
\#define \mbox{\hyperlink{s2n__malformed__handshake__test_8c_a04fd920fd9f28238887e4c6417b4d4cc}{TLS\+\_\+\+HANDSHAKE}}~22
\item 
\#define \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ac73f405c69af9ff269769efd8eba125f}{TLS\+\_\+\+HEARTBEAT}}~24
\item 
\#define \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ac56686e866d4e21e0b112979b16cd453}{ZERO\+\_\+\+TO\+\_\+\+THIRTY\+\_\+\+ONE}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{s2n__handshake_8h_a78b97fef55da786a15a849fd9d7e557c}{message\+\_\+type\+\_\+t}} \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ad1a464c4f0d92cf0ac994ecd7693bd10}{s2n\+\_\+conn\+\_\+get\+\_\+current\+\_\+message\+\_\+type}} (struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$conn)
\item 
void \mbox{\hyperlink{s2n__malformed__handshake__test_8c_a0d67101bf4796caf937fb56fc0825414}{send\+\_\+messages}} (int write\+\_\+fd, uint8\+\_\+t $\ast$server\+\_\+hello, uint32\+\_\+t server\+\_\+hello\+\_\+len, uint8\+\_\+t $\ast$\mbox{\hyperlink{s2n__fragmentation__coalescing__test_8c_a6f8e086c4374b9500a7200a82eb494df}{server\+\_\+cert}}, uint32\+\_\+t server\+\_\+cert\+\_\+len)
\item 
int \mbox{\hyperlink{s2n__malformed__handshake__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}{main}} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static uint8\+\_\+t \mbox{\hyperlink{s2n__malformed__handshake__test_8c_a9d334a2514e7cddcfc0799e8f02fb102}{zero\+\_\+to\+\_\+thirty\+\_\+one}} \mbox{[}$\,$\mbox{]} = \{ \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ac56686e866d4e21e0b112979b16cd453}{ZERO\+\_\+\+TO\+\_\+\+THIRTY\+\_\+\+ONE}} \}
\item 
static uint8\+\_\+t \mbox{\hyperlink{s2n__malformed__handshake__test_8c_a08831b3611d4c85bc362ceb8ce6c48d7}{server\+\_\+hello\+\_\+message}} \mbox{[}$\,$\mbox{]}
\item 
static uint8\+\_\+t \mbox{\hyperlink{s2n__malformed__handshake__test_8c_a96e836e37510195e8e199b529713be56}{good\+\_\+certificate\+\_\+list}} \mbox{[}$\,$\mbox{]}
\item 
static uint8\+\_\+t \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ab452d32a74f1b0710d2330d283ea5bfc}{empty\+\_\+certificate\+\_\+list}} \mbox{[}$\,$\mbox{]}
\item 
static uint8\+\_\+t \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ad869a43a6cecb4de48ed9fe70846b1b3}{empty\+\_\+certificate}} \mbox{[}$\,$\mbox{]}
\item 
static uint8\+\_\+t \mbox{\hyperlink{s2n__malformed__handshake__test_8c_aa13033b49313fbd21f876828ce521a2a}{certificate\+\_\+list\+\_\+too\+\_\+large}} \mbox{[}$\,$\mbox{]}
\item 
static uint8\+\_\+t \mbox{\hyperlink{s2n__malformed__handshake__test_8c_a7fd3160bb3c1b41630db17467f14e124}{certificate\+\_\+too\+\_\+large}} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_afe02a145f0d3a71b14d61e2774987f9d}\label{s2n__malformed__handshake__test_8c_afe02a145f0d3a71b14d61e2774987f9d}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!TLS\_ALERT@{TLS\_ALERT}}
\index{TLS\_ALERT@{TLS\_ALERT}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{TLS\_ALERT}{TLS\_ALERT}}
{\footnotesize\ttfamily \#define TLS\+\_\+\+ALERT~21}

\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_a04fd920fd9f28238887e4c6417b4d4cc}\label{s2n__malformed__handshake__test_8c_a04fd920fd9f28238887e4c6417b4d4cc}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!TLS\_HANDSHAKE@{TLS\_HANDSHAKE}}
\index{TLS\_HANDSHAKE@{TLS\_HANDSHAKE}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{TLS\_HANDSHAKE}{TLS\_HANDSHAKE}}
{\footnotesize\ttfamily \#define TLS\+\_\+\+HANDSHAKE~22}

\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_ac73f405c69af9ff269769efd8eba125f}\label{s2n__malformed__handshake__test_8c_ac73f405c69af9ff269769efd8eba125f}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!TLS\_HEARTBEAT@{TLS\_HEARTBEAT}}
\index{TLS\_HEARTBEAT@{TLS\_HEARTBEAT}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{TLS\_HEARTBEAT}{TLS\_HEARTBEAT}}
{\footnotesize\ttfamily \#define TLS\+\_\+\+HEARTBEAT~24}

\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_ac56686e866d4e21e0b112979b16cd453}\label{s2n__malformed__handshake__test_8c_ac56686e866d4e21e0b112979b16cd453}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!ZERO\_TO\_THIRTY\_ONE@{ZERO\_TO\_THIRTY\_ONE}}
\index{ZERO\_TO\_THIRTY\_ONE@{ZERO\_TO\_THIRTY\_ONE}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{ZERO\_TO\_THIRTY\_ONE}{ZERO\_TO\_THIRTY\_ONE}}
{\footnotesize\ttfamily \#define ZERO\+\_\+\+TO\+\_\+\+THIRTY\+\_\+\+ONE}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{                            0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, \(\backslash\)}
\DoxyCodeLine{                            0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F}

\end{DoxyCode}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}\label{s2n__malformed__handshake__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!main@{main}}
\index{main@{main}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$$\ast$}]{argv }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_ad1a464c4f0d92cf0ac994ecd7693bd10}\label{s2n__malformed__handshake__test_8c_ad1a464c4f0d92cf0ac994ecd7693bd10}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!s2n\_conn\_get\_current\_message\_type@{s2n\_conn\_get\_current\_message\_type}}
\index{s2n\_conn\_get\_current\_message\_type@{s2n\_conn\_get\_current\_message\_type}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{s2n\_conn\_get\_current\_message\_type()}{s2n\_conn\_get\_current\_message\_type()}}
{\footnotesize\ttfamily \mbox{\hyperlink{s2n__handshake_8h_a78b97fef55da786a15a849fd9d7e557c}{message\+\_\+type\+\_\+t}} s2n\+\_\+conn\+\_\+get\+\_\+current\+\_\+message\+\_\+type (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structs2n__connection}{s2n\+\_\+connection}} $\ast$}]{conn }\end{DoxyParamCaption})}

\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_a0d67101bf4796caf937fb56fc0825414}\label{s2n__malformed__handshake__test_8c_a0d67101bf4796caf937fb56fc0825414}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!send\_messages@{send\_messages}}
\index{send\_messages@{send\_messages}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{send\_messages()}{send\_messages()}}
{\footnotesize\ttfamily void send\+\_\+messages (\begin{DoxyParamCaption}\item[{int}]{write\+\_\+fd,  }\item[{uint8\+\_\+t $\ast$}]{server\+\_\+hello,  }\item[{uint32\+\_\+t}]{server\+\_\+hello\+\_\+len,  }\item[{uint8\+\_\+t $\ast$}]{server\+\_\+cert,  }\item[{uint32\+\_\+t}]{server\+\_\+cert\+\_\+len }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_aa13033b49313fbd21f876828ce521a2a}\label{s2n__malformed__handshake__test_8c_aa13033b49313fbd21f876828ce521a2a}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!certificate\_list\_too\_large@{certificate\_list\_too\_large}}
\index{certificate\_list\_too\_large@{certificate\_list\_too\_large}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{certificate\_list\_too\_large}{certificate\_list\_too\_large}}
{\footnotesize\ttfamily uint8\+\_\+t certificate\+\_\+list\+\_\+too\+\_\+large\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{     }
\DoxyCodeLine{    0x0B,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x06,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x10,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x00}
\DoxyCodeLine{\}}

\end{DoxyCode}
\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_a7fd3160bb3c1b41630db17467f14e124}\label{s2n__malformed__handshake__test_8c_a7fd3160bb3c1b41630db17467f14e124}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!certificate\_too\_large@{certificate\_too\_large}}
\index{certificate\_too\_large@{certificate\_too\_large}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{certificate\_too\_large}{certificate\_too\_large}}
{\footnotesize\ttfamily uint8\+\_\+t certificate\+\_\+too\+\_\+large\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{     }
\DoxyCodeLine{    0x0B,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x06,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x03,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x10}
\DoxyCodeLine{\}}

\end{DoxyCode}
\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_ad869a43a6cecb4de48ed9fe70846b1b3}\label{s2n__malformed__handshake__test_8c_ad869a43a6cecb4de48ed9fe70846b1b3}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!empty\_certificate@{empty\_certificate}}
\index{empty\_certificate@{empty\_certificate}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{empty\_certificate}{empty\_certificate}}
{\footnotesize\ttfamily uint8\+\_\+t empty\+\_\+certificate\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{     }
\DoxyCodeLine{    0x0B,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x06,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x03,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x00}
\DoxyCodeLine{\}}

\end{DoxyCode}
\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_ab452d32a74f1b0710d2330d283ea5bfc}\label{s2n__malformed__handshake__test_8c_ab452d32a74f1b0710d2330d283ea5bfc}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!empty\_certificate\_list@{empty\_certificate\_list}}
\index{empty\_certificate\_list@{empty\_certificate\_list}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{empty\_certificate\_list}{empty\_certificate\_list}}
{\footnotesize\ttfamily uint8\+\_\+t empty\+\_\+certificate\+\_\+list\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{     }
\DoxyCodeLine{    0x0B,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x03, 0x03,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x03, 0x00}
\DoxyCodeLine{\}}

\end{DoxyCode}
\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_a96e836e37510195e8e199b529713be56}\label{s2n__malformed__handshake__test_8c_a96e836e37510195e8e199b529713be56}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!good\_certificate\_list@{good\_certificate\_list}}
\index{good\_certificate\_list@{good\_certificate\_list}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{good\_certificate\_list}{good\_certificate\_list}}
{\footnotesize\ttfamily uint8\+\_\+t good\+\_\+certificate\+\_\+list\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_a08831b3611d4c85bc362ceb8ce6c48d7}\label{s2n__malformed__handshake__test_8c_a08831b3611d4c85bc362ceb8ce6c48d7}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!server\_hello\_message@{server\_hello\_message}}
\index{server\_hello\_message@{server\_hello\_message}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{server\_hello\_message}{server\_hello\_message}}
{\footnotesize\ttfamily uint8\+\_\+t server\+\_\+hello\+\_\+message\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x02,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x00, 0x46,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x03, 0x03,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ac56686e866d4e21e0b112979b16cd453}{ZERO\_TO\_THIRTY\_ONE}},}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x20,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ac56686e866d4e21e0b112979b16cd453}{ZERO\_TO\_THIRTY\_ONE}},}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00, 0x3D,}
\DoxyCodeLine{}
\DoxyCodeLine{    }
\DoxyCodeLine{    0x00}
\DoxyCodeLine{\}}

\end{DoxyCode}
\mbox{\Hypertarget{s2n__malformed__handshake__test_8c_a9d334a2514e7cddcfc0799e8f02fb102}\label{s2n__malformed__handshake__test_8c_a9d334a2514e7cddcfc0799e8f02fb102}} 
\index{s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}!zero\_to\_thirty\_one@{zero\_to\_thirty\_one}}
\index{zero\_to\_thirty\_one@{zero\_to\_thirty\_one}!s2n\_malformed\_handshake\_test.c@{s2n\_malformed\_handshake\_test.c}}
\doxysubsubsection{\texorpdfstring{zero\_to\_thirty\_one}{zero\_to\_thirty\_one}}
{\footnotesize\ttfamily uint8\+\_\+t zero\+\_\+to\+\_\+thirty\+\_\+one\mbox{[}$\,$\mbox{]} = \{ \mbox{\hyperlink{s2n__malformed__handshake__test_8c_ac56686e866d4e21e0b112979b16cd453}{ZERO\+\_\+\+TO\+\_\+\+THIRTY\+\_\+\+ONE}} \}\hspace{0.3cm}{\ttfamily [static]}}

