\hypertarget{s2n__stuffer_8h_source}{}\doxysection{s2n\+\_\+stuffer.\+h}
\label{s2n__stuffer_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/stuffer/s2n\_stuffer.h@{crt/aws-\/crt-\/cpp/crt/s2n/stuffer/s2n\_stuffer.h}}
\mbox{\hyperlink{s2n__stuffer_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <limits.h>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <sys/uio.h>}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}utils/s2n\_blob.h"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#define S2N\_MIN\_STUFFER\_GROWTH\_IN\_BYTES 1024}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{comment}{/* Using a non-\/zero value}}
\DoxyCodeLine{28 \textcolor{comment}{ * (a) makes wiped data easy to see in the debugger}}
\DoxyCodeLine{29 \textcolor{comment}{ * (b) makes use of wiped data obvious since this is unlikely to be a valid bit pattern}}
\DoxyCodeLine{30 \textcolor{comment}{ */}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#define S2N\_WIPE\_PATTERN 'w'}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{preprocessor}{\#define SIZEOF\_IN\_BITS( t ) (sizeof(t) * CHAR\_BIT)}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{preprocessor}{\#define SIZEOF\_UINT24 3}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \{}
\DoxyCodeLine{38     \textcolor{comment}{/* The data for the s2n\_stuffer */}}
\DoxyCodeLine{39     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__stuffer_ae2b2cf5412753a87948fc76397194787}{blob}};}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{comment}{/* Cursors to the current read/write position in the s2n\_stuffer */}}
\DoxyCodeLine{42     uint32\_t \mbox{\hyperlink{structs2n__stuffer_a6e567dc7b55d140923805f6210906f17}{read\_cursor}};}
\DoxyCodeLine{43     uint32\_t \mbox{\hyperlink{structs2n__stuffer_ac06359a7a34ae1554bda854aa1e08af0}{write\_cursor}};}
\DoxyCodeLine{44     uint32\_t \mbox{\hyperlink{structs2n__stuffer_af0f78b632774617fa97da605694b8b4d}{high\_water\_mark}};}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{comment}{/* Was this stuffer alloc()'d ? */}}
\DoxyCodeLine{47     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{structs2n__stuffer_a528ccd95b845fc70116e252fd14f562e}{alloced}}:1;}
\DoxyCodeLine{48 }
\DoxyCodeLine{49     \textcolor{comment}{/* Is this stuffer growable? */}}
\DoxyCodeLine{50     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{structs2n__stuffer_ad6728e0bf1d7f9cfd9653e044a577410}{growable}}:1;}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{comment}{/* Can this stuffer be safely resized?}}
\DoxyCodeLine{53 \textcolor{comment}{     * A growable stuffer can be temporarily tainted by a raw read/write,}}
\DoxyCodeLine{54 \textcolor{comment}{     * preventing it from resizing. */}}
\DoxyCodeLine{55     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{structs2n__stuffer_aa207531cbc6925d8c655527667eb5ba9}{tainted}}:1;}
\DoxyCodeLine{56 \};}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{preprocessor}{\#define s2n\_stuffer\_data\_available( s )   ((s)-\/>write\_cursor -\/ (s)-\/>read\_cursor)}}
\DoxyCodeLine{59 \textcolor{preprocessor}{\#define s2n\_stuffer\_space\_remaining( s )  ((s)-\/>blob.size -\/ (s)-\/>write\_cursor)}}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#define s2n\_stuffer\_is\_wiped( s )         ((s)-\/>high\_water\_mark == 0)}}
\DoxyCodeLine{61 \textcolor{comment}{/* Check basic validity constraints on the stuffer: e.g. that cursors point within the blob */}}
\DoxyCodeLine{62 \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} \mbox{\hyperlink{s2n__stuffer_8h_affe0866d605f82d09ab527a90294ea5b}{s2n\_stuffer\_is\_valid}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}}* stuffer);}
\DoxyCodeLine{63 }
\DoxyCodeLine{64 \textcolor{comment}{/* Initialize and destroying stuffers */}}
\DoxyCodeLine{65 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} s2n\_blob *in);}
\DoxyCodeLine{66 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a32c836a77ead9490bde10e13dcbed39c}{s2n\_stuffer\_alloc}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t size);}
\DoxyCodeLine{67 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_aba979c37cd169d15368bcdf473360073}{s2n\_stuffer\_growable\_alloc}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t size);}
\DoxyCodeLine{68 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a008ec0ad933873877ad7e471b3443278}{s2n\_stuffer\_free}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer);}
\DoxyCodeLine{69 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_af41b58c58039466284fb917802c9452b}{s2n\_stuffer\_resize}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t size);}
\DoxyCodeLine{70 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a6a67660ccbd5c32bd4013a32c94ea5eb}{s2n\_stuffer\_resize\_if\_empty}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t size);}
\DoxyCodeLine{71 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_af5d05cd68a844e0831954a712f35d761}{s2n\_stuffer\_rewind\_read}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t size);}
\DoxyCodeLine{72 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a5d6db4ed8311ba66aec1227fceca24a9}{s2n\_stuffer\_reread}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer);}
\DoxyCodeLine{73 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ae1b97eb16ae517a82ec90a0e2b8c48e7}{s2n\_stuffer\_rewrite}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer);}
\DoxyCodeLine{74 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a2b6b54f7856d92f06f823bc26d10f4ba}{s2n\_stuffer\_wipe}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer);}
\DoxyCodeLine{75 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a5db4885b533f28f111a04221c040a407}{s2n\_stuffer\_wipe\_n}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}});}
\DoxyCodeLine{76 \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} \mbox{\hyperlink{s2n__stuffer_8h_ab7101e6845348537f5d2fcc792f44cde}{s2n\_stuffer\_is\_consumed}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer);}
\DoxyCodeLine{77 }
\DoxyCodeLine{78 \textcolor{comment}{/* Basic read and write */}}
\DoxyCodeLine{79 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a49bb9749c055c6fb6f713cebeaa14cb5}{s2n\_stuffer\_read}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} s2n\_blob *out);}
\DoxyCodeLine{80 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ad777d2e6c472d661b98a768debc24135}{s2n\_stuffer\_erase\_and\_read}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} s2n\_blob *out);}
\DoxyCodeLine{81 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ad77ea23089bbeb19b897a73bf6ca3fde}{s2n\_stuffer\_write}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keyword}{struct} s2n\_blob *in);}
\DoxyCodeLine{82 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ac2d7f094941af03fe0954382da2c016d}{s2n\_stuffer\_read\_bytes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint8\_t * out, uint32\_t \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}});}
\DoxyCodeLine{83 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a0350d06d9d0328d6b0451db8c55f2658}{s2n\_stuffer\_erase\_and\_read\_bytes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint8\_t * data, uint32\_t size);}
\DoxyCodeLine{84 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ae2168599d65a7f29cc740f036b6e5006}{s2n\_stuffer\_write\_bytes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint8\_t * in, \textcolor{keyword}{const} uint32\_t \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}});}
\DoxyCodeLine{85 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a3f7051953902f82426e4dee1075e3153}{s2n\_stuffer\_writev\_bytes}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keyword}{struct} iovec* iov, \textcolor{keywordtype}{size\_t} iov\_count, uint32\_t offs, uint32\_t size);}
\DoxyCodeLine{86 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a0d643b31c896c7f6f2c058977cf46c3b}{s2n\_stuffer\_skip\_read}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint32\_t \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}});}
\DoxyCodeLine{87 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a7ef8f252a4b5b3d0bb793e1906d1b876}{s2n\_stuffer\_skip\_write}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}});}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{comment}{/* Tries to reserve enough space to write n additional bytes into the stuffer.*/}}
\DoxyCodeLine{90 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_aff927b856ba44d7f6bbf45703f510fec}{s2n\_stuffer\_reserve\_space}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint32\_t \mbox{\hyperlink{namespace_aws_a56a46d10ee9f89f5ff63ceb62ec27991}{n}});}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{comment}{/* Raw read/write move the cursor along and give you a pointer you can}}
\DoxyCodeLine{93 \textcolor{comment}{ * read/write data\_len bytes from/to in-\/place.}}
\DoxyCodeLine{94 \textcolor{comment}{ */}}
\DoxyCodeLine{95 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} *\mbox{\hyperlink{s2n__stuffer_8h_afdc941db81df32f38b7800210f3f2d11}{s2n\_stuffer\_raw\_write}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t data\_len);}
\DoxyCodeLine{96 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} *\mbox{\hyperlink{s2n__stuffer_8h_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint32\_t data\_len);}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \textcolor{comment}{/* Send/receive stuffer to/from a file descriptor */}}
\DoxyCodeLine{99 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a671afe9bfed1ade971914e9a830a32fd}{s2n\_stuffer\_recv\_from\_fd}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keywordtype}{int} rfd, \textcolor{keyword}{const} uint32\_t \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}, uint32\_t *bytes\_written);}
\DoxyCodeLine{100 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ab74baacfd925ec15794414fe7e8d355f}{s2n\_stuffer\_send\_to\_fd}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keywordtype}{int} wfd, \textcolor{keyword}{const} uint32\_t \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}}, uint32\_t *bytes\_sent);}
\DoxyCodeLine{101 }
\DoxyCodeLine{102 \textcolor{comment}{/* Read and write integers in network order */}}
\DoxyCodeLine{103 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint8\_t * u);}
\DoxyCodeLine{104 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint16\_t * u);}
\DoxyCodeLine{105 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a71787bb6eeba3413137cde42d32a0f6c}{s2n\_stuffer\_read\_uint24}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint32\_t * u);}
\DoxyCodeLine{106 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a7cf35b0d626c422e4fa414bda44f51bb}{s2n\_stuffer\_read\_uint32}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint32\_t * u);}
\DoxyCodeLine{107 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ae1122959189bd03c92af5fd134016977}{s2n\_stuffer\_read\_uint64}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint64\_t * u);}
\DoxyCodeLine{108 }
\DoxyCodeLine{109 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint8\_t u);}
\DoxyCodeLine{110 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint16\_t u);}
\DoxyCodeLine{111 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_aa78701a9bb01def1efcbfa30ba0bdfc9}{s2n\_stuffer\_write\_uint24}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t u);}
\DoxyCodeLine{112 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a958a82fb4dfe3517bcfd95f46807f715}{s2n\_stuffer\_write\_uint32}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint32\_t u);}
\DoxyCodeLine{113 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_af5be81568462bd6626c1d00a939ff30d}{s2n\_stuffer\_write\_uint64}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} uint64\_t u);}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 \textcolor{comment}{/* Allocate space now for network order integers that will be written later.}}
\DoxyCodeLine{116 \textcolor{comment}{ * These are primarily intended to handle the vector type defined in the RFC:}}
\DoxyCodeLine{117 \textcolor{comment}{ * https://tools.ietf.org/html/rfc8446\#section-\/3.4 */}}
\DoxyCodeLine{118 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer__reservation}{s2n\_stuffer\_reservation}} \{}
\DoxyCodeLine{119     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__stuffer__reservation_a8fa655a9ba707147f875746533195299}{stuffer}};}
\DoxyCodeLine{120     uint32\_t \mbox{\hyperlink{structs2n__stuffer__reservation_a8aa0f79218e7d7acf5d46b332a1b348c}{write\_cursor}};}
\DoxyCodeLine{121     uint8\_t \mbox{\hyperlink{structs2n__stuffer__reservation_a9451a04c0d3d5def6f48c8a7a1960e0b}{length}};}
\DoxyCodeLine{122 \};}
\DoxyCodeLine{123 \textcolor{comment}{/* Check basic validity constraints on the s2n\_stuffer\_reservation: e.g. stuffer validity. */}}
\DoxyCodeLine{124 \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} \mbox{\hyperlink{s2n__stuffer_8h_a0321c76c37c2550418d41e9933e3b2cd}{s2n\_stuffer\_reservation\_is\_valid}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer__reservation}{s2n\_stuffer\_reservation}}* reservation);}
\DoxyCodeLine{125 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a3fa3b7404670d70655f4f31397209aa2}{s2n\_stuffer\_reserve\_uint16}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer__reservation}{s2n\_stuffer\_reservation}} *reservation);}
\DoxyCodeLine{126 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ae42cbcaf87b99db74a86b7392daaba10}{s2n\_stuffer\_reserve\_uint24}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer__reservation}{s2n\_stuffer\_reservation}} *reservation);}
\DoxyCodeLine{127 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a4bc8dcd1acfe96afdef18b80c5ed9ddb}{s2n\_stuffer\_write\_vector\_size}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer__reservation}{s2n\_stuffer\_reservation}} *reservation);}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{comment}{/* Copy one stuffer to another */}}
\DoxyCodeLine{130 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a61a10061b07fbbd3f7a58ed061f4387b}{s2n\_stuffer\_copy}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *from, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *to, uint32\_t \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}});}
\DoxyCodeLine{131 }
\DoxyCodeLine{132 \textcolor{comment}{/* Read and write base64 */}}
\DoxyCodeLine{133 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a705de7fd84edef31f728b0c31e17f12a}{s2n\_stuffer\_read\_base64}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *out);}
\DoxyCodeLine{134 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_acdcd3666a23eb79c0ba2ef1ca7c0dd14}{s2n\_stuffer\_write\_base64}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *in);}
\DoxyCodeLine{135 }
\DoxyCodeLine{136 \textcolor{comment}{/* Useful for text manipulation ... */}}
\DoxyCodeLine{137 \textcolor{preprocessor}{\#define s2n\_stuffer\_write\_char( stuffer, c )  s2n\_stuffer\_write\_uint8( (stuffer), (uint8\_t) (c) )}}
\DoxyCodeLine{138 \textcolor{preprocessor}{\#define s2n\_stuffer\_read\_char( stuffer, c )  s2n\_stuffer\_read\_uint8( (stuffer), (uint8\_t *) (c) )}}
\DoxyCodeLine{139 \textcolor{preprocessor}{\#define s2n\_stuffer\_write\_str( stuffer, c )  s2n\_stuffer\_write\_bytes( (stuffer), (const uint8\_t *) (c), strlen((c)) )}}
\DoxyCodeLine{140 \textcolor{preprocessor}{\#define s2n\_stuffer\_write\_text( stuffer, c, n )  s2n\_stuffer\_write\_bytes( (stuffer), (const uint8\_t *) (c), (n) )}}
\DoxyCodeLine{141 \textcolor{preprocessor}{\#define s2n\_stuffer\_read\_text( stuffer, c, n )  s2n\_stuffer\_read\_bytes( (stuffer), (uint8\_t *) (c), (n) )}}
\DoxyCodeLine{142 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ac5804d7e0c506ac66d62bacd11cd99cc}{s2n\_stuffer\_read\_expected\_str}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* expected);}
\DoxyCodeLine{143 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_ab090e316ef5eca9ce16cca3520a94e7e}{s2n\_stuffer\_peek\_char}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keywordtype}{char} *c);}
\DoxyCodeLine{144 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a5ab3277576af346c7a22e5824fcb3027}{s2n\_stuffer\_read\_token}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_a3f037ea767197698bc0b4c14fa155431}{token}}, \textcolor{keywordtype}{char} delim);}
\DoxyCodeLine{145 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a268c4897aa5b39aa5906f45425a0345c}{s2n\_stuffer\_read\_line}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{event__stream__rpc__server__connection__test_8c_a3f037ea767197698bc0b4c14fa155431}{token}});}
\DoxyCodeLine{146 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a424d9e84250b9bbed97707f56ab3f0eb}{s2n\_stuffer\_peek\_check\_for\_str}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}}, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *expected);}
\DoxyCodeLine{147 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_adc5a8c80b55722713796d44c9b76d0d5}{s2n\_stuffer\_skip\_whitespace}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, uint32\_t *skipped);}
\DoxyCodeLine{148 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a0afbd658285ee08d4bd840d4f16aea9b}{s2n\_stuffer\_skip\_to\_char}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keywordtype}{char} target);}
\DoxyCodeLine{149 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a44a1ce0e7b89e8d2c0fe06598354bbd8}{s2n\_stuffer\_skip\_expected\_char}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keywordtype}{char} expected, \textcolor{keyword}{const} uint32\_t min, \textcolor{keyword}{const} uint32\_t max, uint32\_t *skipped);}
\DoxyCodeLine{150 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a00fef62652abeed9b2c84347ff16f319}{s2n\_stuffer\_skip\_read\_until}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* target);}
\DoxyCodeLine{151 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a60fa5894187dfe382077cce73964cd35}{s2n\_stuffer\_alloc\_ro\_from\_string}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *\mbox{\hyperlink{namespacecreate-projects_a6690bd467c6241951130aa0bf17e373d}{str}});}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 \textcolor{comment}{/* Read a private key from a PEM encoded stuffer to an ASN1/DER encoded one */}}
\DoxyCodeLine{154 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a4982ccf6e07a54d46a3da819d9e916e9}{s2n\_stuffer\_private\_key\_from\_pem}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *pem, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *asn1);}
\DoxyCodeLine{155 }
\DoxyCodeLine{156 \textcolor{comment}{/* Read a certificate  from a PEM encoded stuffer to an ASN1/DER encoded one */}}
\DoxyCodeLine{157 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_abdb8ea972bc65569944ce760b97283cf}{s2n\_stuffer\_certificate\_from\_pem}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *pem, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *asn1);}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 \textcolor{comment}{/* Read DH parameters om a PEM encoded stuffer to a PKCS3 encoded one */}}
\DoxyCodeLine{160 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_acc09d820f511dde4633ecad55f062a87}{s2n\_stuffer\_dhparams\_from\_pem}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *pem, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *pkcs3);}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} \mbox{\hyperlink{s2n__stuffer_8h_a0b7030e56b38db2f42b56061429243f8}{s2n\_is\_base64\_char}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} c);}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{comment}{/* Copies all valid data from "{}stuffer"{} into "{}out"{}.}}
\DoxyCodeLine{165 \textcolor{comment}{ * The old blob "{}out"{} pointed to is freed.}}
\DoxyCodeLine{166 \textcolor{comment}{ * It is the responsibility of the caller to free the free "{}out"{}.}}
\DoxyCodeLine{167 \textcolor{comment}{ */}}
\DoxyCodeLine{168 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__stuffer_8h_a525cdc554c91b64fd48ac2581572b185}{s2n\_stuffer\_extract\_blob}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} s2n\_blob *out);}

\end{DoxyCode}
