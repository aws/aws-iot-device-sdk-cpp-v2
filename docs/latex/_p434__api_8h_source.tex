\hypertarget{_p434__api_8h_source}{}\doxysection{P434\+\_\+api.\+h}
\label{_p434__api_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/pq-\/crypto/sike\_r2/P434\_api.h@{crt/aws-\/crt-\/cpp/crt/s2n/pq-\/crypto/sike\_r2/P434\_api.h}}
\mbox{\hyperlink{_p434__api_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/********************************************************************************************}}
\DoxyCodeLine{2 \textcolor{comment}{* SIDH: an efficient supersingular isogeny cryptography library}}
\DoxyCodeLine{3 \textcolor{comment}{*}}
\DoxyCodeLine{4 \textcolor{comment}{* Abstract: API header file for P434}}
\DoxyCodeLine{5 \textcolor{comment}{*********************************************************************************************/}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#ifndef P434\_API\_H}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#define P434\_API\_H}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_p434__internal_8h}{P434\_internal.h}}"{}}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{comment}{/*********************** Key encapsulation mechanism API ***********************/}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define CRYPTO\_SECRETKEYBYTES 374 }\textcolor{comment}{// MSG\_BYTES + SECRETKEY\_B\_BYTES + CRYPTO\_PUBLICKEYBYTES bytes}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define CRYPTO\_PUBLICKEYBYTES 330}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#define CRYPTO\_BYTES 16}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#define CRYPTO\_CIPHERTEXTBYTES 346 }\textcolor{comment}{// CRYPTO\_PUBLICKEYBYTES + MSG\_BYTES bytes}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{comment}{// Encoding of keys for KEM-\/based isogeny system "{}SIKEp434"{} (wire format):}}
\DoxyCodeLine{20 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{21 \textcolor{comment}{// Elements over GF(p434) are encoded in 55 octets in little endian format (i.e., the least significant octet is located in the lowest memory address).}}
\DoxyCodeLine{22 \textcolor{comment}{// Elements (a+b*i) over GF(p434\string^2), where a and b are defined over GF(p434), are encoded as \{a, b\}, with a in the lowest memory portion.}}
\DoxyCodeLine{23 \textcolor{comment}{//}}
\DoxyCodeLine{24 \textcolor{comment}{// Private keys sk consist of the concatenation of a 16-\/byte random value, a value in the range [0, 2\string^217-\/1] and the public key pk. In the SIKE API,}}
\DoxyCodeLine{25 \textcolor{comment}{// private keys are encoded in 374 octets in little endian format.}}
\DoxyCodeLine{26 \textcolor{comment}{// Public keys pk consist of 3 elements in GF(p434\string^2). In the SIKE API, pk is encoded in 330 octets.}}
\DoxyCodeLine{27 \textcolor{comment}{// Ciphertexts ct consist of the concatenation of a public key value and a 16-\/byte value. In the SIKE API, ct is encoded in 330 + 16 = 346 octets.}}
\DoxyCodeLine{28 \textcolor{comment}{// Shared keys ss consist of a value of 16 octets.}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{comment}{/*********************** Ephemeral key exchange API ***********************/}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{comment}{// SECURITY NOTE: SIDH supports ephemeral Diffie-\/Hellman key exchange. It is NOT secure to use it with static keys.}}
\DoxyCodeLine{33 \textcolor{comment}{// See "{}On the Security of Supersingular Isogeny Cryptosystems"{}, S.D. Galbraith, C. Petit, B. Shani and Y.B. Ti, in ASIACRYPT 2016, 2016.}}
\DoxyCodeLine{34 \textcolor{comment}{// Extended version available at: http://eprint.iacr.org/2016/859}}
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{comment}{// Generation of Alice's secret key}}
\DoxyCodeLine{37 \textcolor{comment}{// Outputs random value in [0, 2\string^216 -\/ 1] to be used as Alice's private key}}
\DoxyCodeLine{38 \textcolor{keywordtype}{int} \mbox{\hyperlink{_p434__api_8h_a31be6a07aec90ce170b67685fb5e892e}{oqs\_kem\_sidh\_p434\_random\_mod\_order\_A}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *random\_digits);}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{comment}{// Generation of Bob's secret key}}
\DoxyCodeLine{41 \textcolor{comment}{// Outputs random value in [0, 2\string^Floor(Log(2,3\string^137)) -\/ 1] to be used as Bob's private key}}
\DoxyCodeLine{42 \textcolor{keywordtype}{int} \mbox{\hyperlink{_p434__api_8h_a8565968278ad8139c90391bb23f78204}{oqs\_kem\_sidh\_p434\_random\_mod\_order\_B}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *random\_digits);}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{// Alice's ephemeral public key generation}}
\DoxyCodeLine{45 \textcolor{comment}{// Input:  a private key PrivateKeyA in the range [0, 2\string^216 -\/ 1], stored in 27 bytes.}}
\DoxyCodeLine{46 \textcolor{comment}{// Output: the public key PublicKeyA consisting of 3 GF(p434\string^2) elements encoded in 330 bytes.}}
\DoxyCodeLine{47 \textcolor{keywordtype}{int} \mbox{\hyperlink{_p434__api_8h_a74b27c479cbb987019fdd4ce55b6426f}{oqs\_kem\_sidh\_p434\_EphemeralKeyGeneration\_A}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} *PrivateKeyA, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *PublicKeyA);}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{comment}{// Bob's ephemeral key-\/pair generation}}
\DoxyCodeLine{50 \textcolor{comment}{// It produces a private key PrivateKeyB and computes the public key PublicKeyB.}}
\DoxyCodeLine{51 \textcolor{comment}{// The private key is an integer in the range [0, 2\string^Floor(Log(2,3\string^137)) -\/ 1], stored in 28 bytes.}}
\DoxyCodeLine{52 \textcolor{comment}{// The public key consists of 3 GF(p434\string^2) elements encoded in 330 bytes.}}
\DoxyCodeLine{53 \textcolor{keywordtype}{int} \mbox{\hyperlink{_p434__api_8h_a0c9daca871bc52c0f180ac3dc5a1a61e}{oqs\_kem\_sidh\_p434\_EphemeralKeyGeneration\_B}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} *PrivateKeyB, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *PublicKeyB);}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{comment}{// Alice's ephemeral shared secret computation}}
\DoxyCodeLine{56 \textcolor{comment}{// It produces a shared secret key SharedSecretA using her secret key PrivateKeyA and Bob's public key PublicKeyB}}
\DoxyCodeLine{57 \textcolor{comment}{// Inputs: Alice's PrivateKeyA is an integer in the range [0, 2\string^216 -\/ 1], stored in 27 bytes.}}
\DoxyCodeLine{58 \textcolor{comment}{//         Bob's PublicKeyB consists of 3 GF(p434\string^2) elements encoded in 330 bytes.}}
\DoxyCodeLine{59 \textcolor{comment}{// Output: a shared secret SharedSecretA that consists of one element in GF(p434\string^2) encoded in 110 bytes.}}
\DoxyCodeLine{60 \textcolor{keywordtype}{int} \mbox{\hyperlink{_p434__api_8h_aea7e12ff7f0058e0ed4f446a43a0e0f5}{oqs\_kem\_sidh\_p434\_EphemeralSecretAgreement\_A}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} *PrivateKeyA, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *PublicKeyB, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *SharedSecretA);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{comment}{// Bob's ephemeral shared secret computation}}
\DoxyCodeLine{63 \textcolor{comment}{// It produces a shared secret key SharedSecretB using his secret key PrivateKeyB and Alice's public key PublicKeyA}}
\DoxyCodeLine{64 \textcolor{comment}{// Inputs: Bob's PrivateKeyB is an integer in the range [0, 2\string^Floor(Log(2,3\string^137)) -\/ 1], stored in 28 bytes.}}
\DoxyCodeLine{65 \textcolor{comment}{//         Alice's PublicKeyA consists of 3 GF(p434\string^2) elements encoded in 330 bytes.}}
\DoxyCodeLine{66 \textcolor{comment}{// Output: a shared secret SharedSecretB that consists of one element in GF(p434\string^2) encoded in 110 bytes.}}
\DoxyCodeLine{67 \textcolor{keywordtype}{int} \mbox{\hyperlink{_p434__api_8h_aa136199c7c06ad66a3274e0a20912b9d}{oqs\_kem\_sidh\_p434\_EphemeralSecretAgreement\_B}}(\textcolor{keyword}{const} \mbox{\hyperlink{config__r1_8h_a06a90bea40a7022c26f3893bac12c47f}{digit\_t}} *PrivateKeyB, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *PublicKeyA, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *SharedSecretB);}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
