\hypertarget{proxy__impl_8h_source}{}\doxysection{proxy\+\_\+impl.\+h}
\label{proxy__impl_8h_source}\index{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/http/include/aws/http/private/proxy\_impl.h@{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/http/include/aws/http/private/proxy\_impl.h}}
\mbox{\hyperlink{proxy__impl_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef AWS\_HTTP\_PROXY\_IMPL\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define AWS\_HTTP\_PROXY\_IMPL\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{http_8h}{aws/http/http.h}}>}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{connection_8h}{aws/http/connection.h}}>}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__message}{aws\_http\_message}};}
\DoxyCodeLine{14 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__channel__slot}{aws\_channel\_slot}};}
\DoxyCodeLine{15 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__string}{aws\_string}};}
\DoxyCodeLine{16 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__tls__connection__options}{aws\_tls\_connection\_options}};}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{comment}{/*}}
\DoxyCodeLine{19 \textcolor{comment}{ * (Successful) State transitions for proxy connections}}
\DoxyCodeLine{20 \textcolor{comment}{ *}}
\DoxyCodeLine{21 \textcolor{comment}{ * Http : None -\/> Socket Connect -\/> Success}}
\DoxyCodeLine{22 \textcolor{comment}{ * Https: None -\/> Socket Connect -\/> Http Connect -\/> Tls Negotiation -\/> Success}}
\DoxyCodeLine{23 \textcolor{comment}{ */}}
\DoxyCodeLine{24 \textcolor{keyword}{enum} \mbox{\hyperlink{proxy__impl_8h_ad7345e1b05b25c2c7091cdbe71099309}{aws\_proxy\_bootstrap\_state}} \{}
\DoxyCodeLine{25     \mbox{\hyperlink{proxy__impl_8h_ad7345e1b05b25c2c7091cdbe71099309ae4aac8767017392d83c0f115e6098789}{AWS\_PBS\_NONE}} = 0,}
\DoxyCodeLine{26     \mbox{\hyperlink{proxy__impl_8h_ad7345e1b05b25c2c7091cdbe71099309accdd249a71f03065dab32b956116072b}{AWS\_PBS\_SOCKET\_CONNECT}},}
\DoxyCodeLine{27     \mbox{\hyperlink{proxy__impl_8h_ad7345e1b05b25c2c7091cdbe71099309ab018e35169719a44c39b11980c047154}{AWS\_PBS\_HTTP\_CONNECT}},}
\DoxyCodeLine{28     \mbox{\hyperlink{proxy__impl_8h_ad7345e1b05b25c2c7091cdbe71099309a02cd8de8bfc4f2fb7f4058adc5c7b833}{AWS\_PBS\_TLS\_NEGOTIATION}},}
\DoxyCodeLine{29     \mbox{\hyperlink{proxy__impl_8h_ad7345e1b05b25c2c7091cdbe71099309abe2329ddadc4c02ce75825cde49d00c4}{AWS\_PBS\_SUCCESS}},}
\DoxyCodeLine{30     \mbox{\hyperlink{proxy__impl_8h_ad7345e1b05b25c2c7091cdbe71099309a0a3c862684d7b232a03c017afdeac99b}{AWS\_PBS\_FAILURE}},}
\DoxyCodeLine{31 \};}
\DoxyCodeLine{32 }
\DoxyCodeLine{36 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__proxy__config}{aws\_http\_proxy\_config}} \{}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__allocator}{aws\_allocator}} *\mbox{\hyperlink{structaws__http__proxy__config_a22f2d275e97337ae3a2491c54ddfd3e1}{allocator}};}
\DoxyCodeLine{39 }
\DoxyCodeLine{40     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__byte__buf}{aws\_byte\_buf}} \mbox{\hyperlink{structaws__http__proxy__config_a4ce069cd69caf99c9c9b06d116430c63}{host}};}
\DoxyCodeLine{41 }
\DoxyCodeLine{42     uint16\_t \mbox{\hyperlink{structaws__http__proxy__config_a8fb9c4e8b8e2dd2368a111c3ed511c68}{port}};}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__tls__connection__options}{aws\_tls\_connection\_options}} *\mbox{\hyperlink{structaws__http__proxy__config_a522be997eed3e386de9d697fb5a79fb3}{tls\_options}};}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{keyword}{enum} \mbox{\hyperlink{connection_8h_a188e1e008227bac9ef95f9d351b2c50f}{aws\_http\_proxy\_authentication\_type}} \mbox{\hyperlink{structaws__http__proxy__config_ab73c9611e153a3b1a0efff9b83f2f5cd}{auth\_type}};}
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__byte__buf}{aws\_byte\_buf}} \mbox{\hyperlink{structaws__http__proxy__config_a8c99edec1d2b576f644018fe20251e9d}{auth\_username}};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__byte__buf}{aws\_byte\_buf}} \mbox{\hyperlink{structaws__http__proxy__config_aecae5132758a294332d3c4ed0b1eed70}{auth\_password}};}
\DoxyCodeLine{51 \};}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{comment}{/*}}
\DoxyCodeLine{54 \textcolor{comment}{ * When a proxy connection is made, we wrap the user-\/supplied user data with this}}
\DoxyCodeLine{55 \textcolor{comment}{ * proxy user data.  Callbacks are passed properly to the user.  By having this data}}
\DoxyCodeLine{56 \textcolor{comment}{ * available, the proxy request transform that was attached to the connection can extract}}
\DoxyCodeLine{57 \textcolor{comment}{ * the proxy settings it needs in order to properly transform the requests.}}
\DoxyCodeLine{58 \textcolor{comment}{ *}}
\DoxyCodeLine{59 \textcolor{comment}{ * Another possibility would be to fold this data into the connection itself.}}
\DoxyCodeLine{60 \textcolor{comment}{ */}}
\DoxyCodeLine{61 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__proxy__user__data}{aws\_http\_proxy\_user\_data}} \{}
\DoxyCodeLine{62     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__allocator}{aws\_allocator}} *\mbox{\hyperlink{structaws__http__proxy__user__data_a05c7a686e2cbe02f654d4982fbc920c5}{allocator}};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64     \textcolor{keyword}{enum} \mbox{\hyperlink{proxy__impl_8h_ad7345e1b05b25c2c7091cdbe71099309}{aws\_proxy\_bootstrap\_state}} \mbox{\hyperlink{structaws__http__proxy__user__data_a28e8e1c5744f97e120ce863389f5d34e}{state}};}
\DoxyCodeLine{65     \textcolor{keywordtype}{int} \mbox{\hyperlink{structaws__http__proxy__user__data_acb1ba9afa1767f4fee2cca901ffc5902}{error\_code}};}
\DoxyCodeLine{66     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__connection}{aws\_http\_connection}} *\mbox{\hyperlink{structaws__http__proxy__user__data_ae32c42a47478838d3bcaa8548e2a85d8}{connection}};}
\DoxyCodeLine{67     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__message}{aws\_http\_message}} *\mbox{\hyperlink{structaws__http__proxy__user__data_a878ba284569669668c0d607f1880bb42}{connect\_request}};}
\DoxyCodeLine{68     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__stream}{aws\_http\_stream}} *\mbox{\hyperlink{structaws__http__proxy__user__data_a34811e2e4f31f9426382f80852825761}{connect\_stream}};}
\DoxyCodeLine{69 }
\DoxyCodeLine{70     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__string}{aws\_string}} *\mbox{\hyperlink{structaws__http__proxy__user__data_abf5b546e783a989a5ff80048e558ad44}{original\_host}};}
\DoxyCodeLine{71     uint16\_t \mbox{\hyperlink{structaws__http__proxy__user__data_abffb4f5da3b418d18bf6a4cbae393741}{original\_port}};}
\DoxyCodeLine{72     \mbox{\hyperlink{connection_8h_afc803717ca6708a11d74a510288f7ff4}{aws\_http\_on\_client\_connection\_setup\_fn}} *\mbox{\hyperlink{structaws__http__proxy__user__data_a9a5ffd16a0f077021966ce106c3ab273}{original\_on\_setup}};}
\DoxyCodeLine{73     \mbox{\hyperlink{connection_8h_a4a810c4a3fb9abb4f364c1df0c79e169}{aws\_http\_on\_client\_connection\_shutdown\_fn}} *\mbox{\hyperlink{structaws__http__proxy__user__data_a348bfc0503802f05f4da7658f81f320f}{original\_on\_shutdown}};}
\DoxyCodeLine{74     \textcolor{keywordtype}{void} *\mbox{\hyperlink{structaws__http__proxy__user__data_ad02ca42ba0f65ad6ea1bb8210c36b3bb}{original\_user\_data}};}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__tls__connection__options}{aws\_tls\_connection\_options}} *\mbox{\hyperlink{structaws__http__proxy__user__data_a5c1a0cb6b7ea620fc6e15eac2a2883f0}{tls\_options}};}
\DoxyCodeLine{77 }
\DoxyCodeLine{78     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__proxy__config}{aws\_http\_proxy\_config}} *\mbox{\hyperlink{structaws__http__proxy__user__data_a92f9d2cc7b539dd033f0a33826acfaad}{proxy\_config}};}
\DoxyCodeLine{79 \};}
\DoxyCodeLine{80 }
\DoxyCodeLine{81 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__proxy__system__vtable}{aws\_http\_proxy\_system\_vtable}} \{}
\DoxyCodeLine{82     int (*\mbox{\hyperlink{structaws__http__proxy__system__vtable_a9b396d12f0696d44502d20b34052d4e1}{setup\_client\_tls}})(\textcolor{keyword}{struct }\mbox{\hyperlink{structaws__channel__slot}{aws\_channel\_slot}} *right\_of\_slot, \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__tls__connection__options}{aws\_tls\_connection\_options}} *tls\_options);}
\DoxyCodeLine{83 \};}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \mbox{\hyperlink{macros_8h_ab6f66af8231eba5da061b9ada0d29bad}{AWS\_EXTERN\_C\_BEGIN}}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 \mbox{\hyperlink{crt_2aws-crt-cpp_2crt_2aws-c-http_2include_2aws_2http_2_exports_8h_a8eba90dca01a9989cacc0060fa84122a}{AWS\_HTTP\_API}}}
\DoxyCodeLine{88 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__proxy__user__data}{aws\_http\_proxy\_user\_data}} *\mbox{\hyperlink{proxy__impl_8h_a13d0e8f2c98085a179103aec6e0e3785}{aws\_http\_proxy\_user\_data\_new}}(}
\DoxyCodeLine{89     \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__allocator}{aws\_allocator}} *\mbox{\hyperlink{structaws__http__proxy__user__data_a05c7a686e2cbe02f654d4982fbc920c5}{allocator}},}
\DoxyCodeLine{90     \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__client__connection__options}{aws\_http\_client\_connection\_options}} *options);}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \mbox{\hyperlink{crt_2aws-crt-cpp_2crt_2aws-c-http_2include_2aws_2http_2_exports_8h_a8eba90dca01a9989cacc0060fa84122a}{AWS\_HTTP\_API}}}
\DoxyCodeLine{93 \textcolor{keywordtype}{void} \mbox{\hyperlink{proxy__impl_8h_a5abc7472063fa494923c25318d3a4617}{aws\_http\_proxy\_user\_data\_destroy}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__proxy__user__data}{aws\_http\_proxy\_user\_data}} *user\_data);}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 \mbox{\hyperlink{crt_2aws-crt-cpp_2crt_2aws-c-http_2include_2aws_2http_2_exports_8h_a8eba90dca01a9989cacc0060fa84122a}{AWS\_HTTP\_API}}}
\DoxyCodeLine{96 \textcolor{keywordtype}{int} \mbox{\hyperlink{proxy__impl_8h_ad991029983b9bde0320363bd6bd49dc6}{aws\_http\_client\_connect\_via\_proxy}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__client__connection__options}{aws\_http\_client\_connection\_options}} *options);}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \mbox{\hyperlink{crt_2aws-crt-cpp_2crt_2aws-c-http_2include_2aws_2http_2_exports_8h_a8eba90dca01a9989cacc0060fa84122a}{AWS\_HTTP\_API}}}
\DoxyCodeLine{99 \textcolor{keywordtype}{int} \mbox{\hyperlink{proxy__impl_8h_a435bee7d8d2485ad9f1490ae487b0409}{aws\_http\_rewrite\_uri\_for\_proxy\_request}}(}
\DoxyCodeLine{100     \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__message}{aws\_http\_message}} *request,}
\DoxyCodeLine{101     \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__proxy__user__data}{aws\_http\_proxy\_user\_data}} *proxy\_user\_data);}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \mbox{\hyperlink{crt_2aws-crt-cpp_2crt_2aws-c-http_2include_2aws_2http_2_exports_8h_a8eba90dca01a9989cacc0060fa84122a}{AWS\_HTTP\_API}}}
\DoxyCodeLine{104 \textcolor{keywordtype}{void} \mbox{\hyperlink{proxy__impl_8h_af189fd7316dcd503fde0bd2edf4a3956}{aws\_http\_proxy\_system\_set\_vtable}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__proxy__system__vtable}{aws\_http\_proxy\_system\_vtable}} *\mbox{\hyperlink{opensslcrypto__ecc_8c_ae7fa5a3a68eec45ba0d07dc2bd471a7f}{vtable}});}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 \mbox{\hyperlink{crt_2aws-crt-cpp_2crt_2aws-c-http_2include_2aws_2http_2_exports_8h_a8eba90dca01a9989cacc0060fa84122a}{AWS\_HTTP\_API}}}
\DoxyCodeLine{107 \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__http__proxy__config}{aws\_http\_proxy\_config}} *\mbox{\hyperlink{proxy__impl_8h_ab5967342a8815654668ee25a46d81416}{aws\_http\_proxy\_config\_new}}(}
\DoxyCodeLine{108     \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__allocator}{aws\_allocator}} *\mbox{\hyperlink{structaws__http__proxy__config_a22f2d275e97337ae3a2491c54ddfd3e1}{allocator}},}
\DoxyCodeLine{109     \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__proxy__options}{aws\_http\_proxy\_options}} *options);}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 \mbox{\hyperlink{crt_2aws-crt-cpp_2crt_2aws-c-http_2include_2aws_2http_2_exports_8h_a8eba90dca01a9989cacc0060fa84122a}{AWS\_HTTP\_API}}}
\DoxyCodeLine{112 \textcolor{keywordtype}{void} \mbox{\hyperlink{proxy__impl_8h_a67a04f41578b49f2d37dcb904a236537}{aws\_http\_proxy\_config\_destroy}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__proxy__config}{aws\_http\_proxy\_config}} *\mbox{\hyperlink{namespacecreate__project_ab7f741ca784276a3f80325a8fb79fd95}{config}});}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 \mbox{\hyperlink{crt_2aws-crt-cpp_2crt_2aws-c-http_2include_2aws_2http_2_exports_8h_a8eba90dca01a9989cacc0060fa84122a}{AWS\_HTTP\_API}}}
\DoxyCodeLine{115 \textcolor{keywordtype}{void} \mbox{\hyperlink{proxy__impl_8h_abf86c3c5bef2c2c3e70b529881fb811e}{aws\_http\_proxy\_options\_init\_from\_config}}(}
\DoxyCodeLine{116     \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__proxy__options}{aws\_http\_proxy\_options}} *options,}
\DoxyCodeLine{117     \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structaws__http__proxy__config}{aws\_http\_proxy\_config}} *\mbox{\hyperlink{namespacecreate__project_ab7f741ca784276a3f80325a8fb79fd95}{config}});}
\DoxyCodeLine{118 }
\DoxyCodeLine{119 \mbox{\hyperlink{macros_8h_a24efb76a3b128abc9c35d83cac0030c5}{AWS\_EXTERN\_C\_END}}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* AWS\_HTTP\_PROXY\_IMPL\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
