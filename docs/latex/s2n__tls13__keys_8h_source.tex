\hypertarget{s2n__tls13__keys_8h_source}{}\doxysection{s2n\+\_\+tls13\+\_\+keys.\+h}
\label{s2n__tls13__keys_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_tls13\_keys.h@{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_tls13\_keys.h}}
\mbox{\hyperlink{s2n__tls13__keys_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__hmac_8h}{crypto/s2n\_hmac.h}}"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__hkdf_8h}{crypto/s2n\_hkdf.h}}"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__tls13__keys_8h}{crypto/s2n\_tls13\_keys.h}}"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__stuffer_8h}{stuffer/s2n\_stuffer.h}}"{}}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__tls__parameters_8h}{tls/s2n\_tls\_parameters.h}}"{}}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include "{}utils/s2n\_blob.h"{}}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}utils/s2n\_safety.h"{}}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include "{}utils/s2n\_mem.h"{}}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}utils/s2n\_safety.h"{}}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#define S2N\_TLS13\_SECRET\_MAX\_LEN SHA384\_DIGEST\_LENGTH}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} \{}
\DoxyCodeLine{33     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} \mbox{\hyperlink{structs2n__tls13__keys_a47c495bed0563e98a4814417393fd7b7}{hmac\_algorithm}};}
\DoxyCodeLine{34     \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} \mbox{\hyperlink{structs2n__tls13__keys_a2322120af7ab653ea7839c19f00c43f4}{hash\_algorithm}};}
\DoxyCodeLine{35 }
\DoxyCodeLine{36     uint8\_t \mbox{\hyperlink{structs2n__tls13__keys_acc5313454f7af9543a2024bebc240033}{size}};}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     \textcolor{comment}{/* we only need to keep these 2 rolling secrets at any point,}}
\DoxyCodeLine{39 \textcolor{comment}{     * since other secrets to be used can be generated from these}}
\DoxyCodeLine{40 \textcolor{comment}{     */}}
\DoxyCodeLine{41     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__tls13__keys_ad336c24439b02a8370ebebb7d28a7bdf}{extract\_secret}};}
\DoxyCodeLine{42     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__tls13__keys_acf20282eb29427ba6368367fd13bc3ce}{derive\_secret}};}
\DoxyCodeLine{43     uint8\_t \mbox{\hyperlink{structs2n__tls13__keys_aad29810fa86641480d3e6c0ab3e7fcc4}{extract\_secret\_bytes}}[\mbox{\hyperlink{s2n__tls13__keys_8h_af55ac96ffd1b79ee96166d0a4adc5fd3}{S2N\_TLS13\_SECRET\_MAX\_LEN}}];}
\DoxyCodeLine{44     uint8\_t \mbox{\hyperlink{structs2n__tls13__keys_acf1dd8bca658dac47b6c482ee2ee44c6}{derive\_secret\_bytes}}[\mbox{\hyperlink{s2n__tls13__keys_8h_af55ac96ffd1b79ee96166d0a4adc5fd3}{S2N\_TLS13\_SECRET\_MAX\_LEN}}];}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} \mbox{\hyperlink{structs2n__tls13__keys_af578d17b2cc9aa45935df0e05cee9400}{hmac}};}
\DoxyCodeLine{47 \};}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{comment}{/* Defines TLS 1.3 HKDF Labels */}}
\DoxyCodeLine{50 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_a3661bc04305809708dea1a2ed6f5c679}{s2n\_tls13\_label\_derived\_secret}};}
\DoxyCodeLine{51 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_a9dedeb714f9d4c413fb7165efd714247}{s2n\_tls13\_label\_external\_psk\_binder\_key}};}
\DoxyCodeLine{52 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_a94fa7cb0723f8540f59c118faed7809c}{s2n\_tls13\_label\_resumption\_psk\_binder\_key}};}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_a76043fceaf21298653021319484773b1}{s2n\_tls13\_label\_client\_early\_traffic\_secret}};}
\DoxyCodeLine{55 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_a3821adedbc4899bdf233e3acffa7fe8c}{s2n\_tls13\_label\_early\_exporter\_master\_secret}};}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_afb9a87723c7c0de603bad820b3495a0b}{s2n\_tls13\_label\_client\_handshake\_traffic\_secret}};}
\DoxyCodeLine{58 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_a33778db1da7e74077592c0024a72abf8}{s2n\_tls13\_label\_server\_handshake\_traffic\_secret}};}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_a5351a9304da95a1641f93d80dcc9727f}{s2n\_tls13\_label\_client\_application\_traffic\_secret}};}
\DoxyCodeLine{61 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_af482c2e869b131225574e89a2d8be27d}{s2n\_tls13\_label\_server\_application\_traffic\_secret}};}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_a7ac0d96a7823d58fff2c9cdd2762a65d}{s2n\_tls13\_label\_exporter\_master\_secret}};}
\DoxyCodeLine{64 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_aa58576c95f946de446ebf9757f3dba8a}{s2n\_tls13\_label\_resumption\_master\_secret}};}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{comment}{/* Traffic secret labels */}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_ab6aec43a067fba642cc6c2807e666ee3}{s2n\_tls13\_label\_traffic\_secret\_key}};}
\DoxyCodeLine{69 \textcolor{keyword}{extern} \textcolor{keyword}{const} \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{s2n__tls13__keys_8h_aa7ec2c6691309efb72755ce28b5c02e9}{s2n\_tls13\_label\_traffic\_secret\_iv}};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \textcolor{preprocessor}{\#define s2n\_tls13\_key\_blob(name, bytes) \(\backslash\)}}
\DoxyCodeLine{72 \textcolor{preprocessor}{    s2n\_stack\_blob(name, bytes, S2N\_TLS13\_SECRET\_MAX\_LEN)}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_a044a6fb6ab4888f3c3633085ab032bc9}{s2n\_tls13\_keys\_init}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *\mbox{\hyperlink{namespaces2n__handshake__test__gnutls-cli_a07c72dd55cb457eee3c72082e72148cf}{handshake}}, \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} alg);}
\DoxyCodeLine{75 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_ae2a8fcc16131859c1f3e4d47b7f3e2c4}{s2n\_tls13\_keys\_free}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *keys);}
\DoxyCodeLine{76 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_ac1bb8dbbb73bd3a565fe3114f5b41853}{s2n\_tls13\_derive\_early\_secrets}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *\mbox{\hyperlink{namespaces2n__handshake__test__gnutls-cli_a07c72dd55cb457eee3c72082e72148cf}{handshake}});}
\DoxyCodeLine{77 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_a630a29737861563bd5fd4b9efce70c39}{s2n\_tls13\_derive\_handshake\_secrets}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *\mbox{\hyperlink{namespaces2n__handshake__test__gnutls-cli_a07c72dd55cb457eee3c72082e72148cf}{handshake}},}
\DoxyCodeLine{78                                         \textcolor{keyword}{const} \textcolor{keyword}{struct} s2n\_blob *ecdhe,}
\DoxyCodeLine{79                                         \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *client\_server\_hello\_hash,}
\DoxyCodeLine{80                                         \textcolor{keyword}{struct} s2n\_blob *client\_secret,}
\DoxyCodeLine{81                                         \textcolor{keyword}{struct} s2n\_blob *server\_secret);}
\DoxyCodeLine{82 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_a92f27d33a6ce6311ccb60c47134a3e14}{s2n\_tls13\_extract\_master\_secret}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *\mbox{\hyperlink{namespaces2n__handshake__test__gnutls-cli_a07c72dd55cb457eee3c72082e72148cf}{handshake}});}
\DoxyCodeLine{83 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_a04d0bd584d4633a13bb4e7ce107e2af5}{s2n\_tls13\_derive\_application\_secret}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *\mbox{\hyperlink{namespaces2n__handshake__test__gnutls-cli_a07c72dd55cb457eee3c72082e72148cf}{handshake}}, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *hashes, \textcolor{keyword}{struct} s2n\_blob *secret\_blob, \mbox{\hyperlink{s2n_8h_a77a64e3b657f90d221c5faf99c643cdb}{s2n\_mode}} mode);}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_ab8b610e54165ccc5cecd8e768ec11936}{s2n\_tls13\_derive\_traffic\_keys}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *\mbox{\hyperlink{namespaces2n__handshake__test__gnutls-cli_a07c72dd55cb457eee3c72082e72148cf}{handshake}}, \textcolor{keyword}{struct} s2n\_blob *secret, \textcolor{keyword}{struct} s2n\_blob *key, \textcolor{keyword}{struct} s2n\_blob *iv);}
\DoxyCodeLine{86 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_ada106d0afa5592820ce27b0caf335059}{s2n\_tls13\_derive\_finished\_key}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *keys, \textcolor{keyword}{struct} s2n\_blob *secret\_key, \textcolor{keyword}{struct} s2n\_blob *output\_finish\_key);}
\DoxyCodeLine{87 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_aad7b579363359af2c7d5ea8aaeb1c6fb}{s2n\_tls13\_calculate\_finished\_mac}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *keys, \textcolor{keyword}{struct} s2n\_blob *finished\_key, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} *hash\_state, \textcolor{keyword}{struct} s2n\_blob *finished\_verify);}
\DoxyCodeLine{88 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__tls13__keys_8h_a2531ae718b45e6a8126deaa95a145bf1}{s2n\_tls13\_update\_application\_traffic\_secret}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__tls13__keys}{s2n\_tls13\_keys}} *keys, \textcolor{keyword}{struct} s2n\_blob *old\_secret, \textcolor{keyword}{struct} s2n\_blob *new\_secret);}

\end{DoxyCode}
