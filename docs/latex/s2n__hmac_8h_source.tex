\hypertarget{s2n__hmac_8h_source}{}\doxysection{s2n\+\_\+hmac.\+h}
\label{s2n__hmac_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_hmac.h@{crt/aws-\/crt-\/cpp/crt/s2n/crypto/s2n\_hmac.h}}
\mbox{\hyperlink{s2n__hmac_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{crypto_2s2n__hash_8h}{crypto/s2n\_hash.h}}"{}}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{23     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8a88ae1d7e02f618b9d81dee12d40882b4}{S2N\_HMAC\_NONE}},}
\DoxyCodeLine{24     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8aa277571ddfcb5f6f85fc8d3b5351cc99}{S2N\_HMAC\_MD5}},}
\DoxyCodeLine{25     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8a4c54826ffafbb42002b6097db113a742}{S2N\_HMAC\_SHA1}},}
\DoxyCodeLine{26     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8a29f17c6abdbfc81bd5c5664bf80798ca}{S2N\_HMAC\_SHA224}},}
\DoxyCodeLine{27     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8aed177ac5edd440b639f760c0603d1023}{S2N\_HMAC\_SHA256}},}
\DoxyCodeLine{28     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8a9b3fb8d722dc6bbe141962bc6423d530}{S2N\_HMAC\_SHA384}},}
\DoxyCodeLine{29     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8a6506b3245b732f687921d099266ff137}{S2N\_HMAC\_SHA512}},}
\DoxyCodeLine{30     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8a3252ba5a86126683ef0175684dc9e37a}{S2N\_HMAC\_SSLv3\_MD5}},}
\DoxyCodeLine{31     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8a57a856f76020577f38f8e99feb826991}{S2N\_HMAC\_SSLv3\_SHA1}}}
\DoxyCodeLine{32 \} \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}};}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} \{}
\DoxyCodeLine{35     \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} \mbox{\hyperlink{structs2n__hmac__state_a41e406aac7711705772e73fa4fdfdb7d}{alg}};}
\DoxyCodeLine{36 }
\DoxyCodeLine{37     uint16\_t \mbox{\hyperlink{structs2n__hmac__state_a1207d443b8db1a199a4efb0169387b52}{hash\_block\_size}};}
\DoxyCodeLine{38     uint32\_t \mbox{\hyperlink{structs2n__hmac__state_a83f6c60921b7f2823142fce4df225206}{currently\_in\_hash\_block}};}
\DoxyCodeLine{39     uint16\_t \mbox{\hyperlink{structs2n__hmac__state_ac70574a8ad05d1d869225751643c3470}{xor\_pad\_size}};}
\DoxyCodeLine{40     uint8\_t \mbox{\hyperlink{structs2n__hmac__state_a94f869e892018df7af7430b009bc3d4f}{digest\_size}};}
\DoxyCodeLine{41 }
\DoxyCodeLine{42     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} \mbox{\hyperlink{structs2n__hmac__state_a17a1a38413f31f05b8d9686ecdce40b5}{inner}};}
\DoxyCodeLine{43     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} \mbox{\hyperlink{structs2n__hmac__state_a11f5c7fe107b9e22d397556e9334f9e5}{inner\_just\_key}};}
\DoxyCodeLine{44     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} \mbox{\hyperlink{structs2n__hmac__state_a8cbfc1059bd26a93e8e8c5c5abf4c189}{outer}};}
\DoxyCodeLine{45     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__state}{s2n\_hash\_state}} \mbox{\hyperlink{structs2n__hmac__state_aed84aa60f1096b6057c315a179f3c7ec}{outer\_just\_key}};}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \textcolor{comment}{/* key needs to be as large as the biggest block size */}}
\DoxyCodeLine{49     uint8\_t \mbox{\hyperlink{structs2n__hmac__state_a1aeec7047f6d1e8ffdab75a48477c380}{xor\_pad}}[128];}
\DoxyCodeLine{50 }
\DoxyCodeLine{51     \textcolor{comment}{/* For storing the inner digest */}}
\DoxyCodeLine{52     uint8\_t \mbox{\hyperlink{structs2n__hmac__state_af4fb326afe82de66326965a5d2ecfe2e}{digest\_pad}}[\mbox{\hyperlink{tests_2cbmc_2include_2openssl_2sha_8h_a5a8416d0f8e1af6d7525114ef09be118}{SHA512\_DIGEST\_LENGTH}}];}
\DoxyCodeLine{53 \};}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}} \{}
\DoxyCodeLine{56     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__hmac__evp__backup_a423ff9bd12bb1301980e93c15d9e4504}{inner}};}
\DoxyCodeLine{57     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__hmac__evp__backup_adac630b321afb3720964c74f5e75aa5c}{inner\_just\_key}};}
\DoxyCodeLine{58     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__hmac__evp__backup_ae56ebd46bc7fa6127875348e1a080506}{outer}};}
\DoxyCodeLine{59     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__hmac__evp__backup_ab45f1bc744a8b116c5800df2974e1b3e}{outer\_just\_key}};}
\DoxyCodeLine{60 \};}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a80f87d0c7345bf1f7919eba5ee5002a5}{s2n\_hmac\_digest\_size}}(\mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} alg, uint8\_t *out);}
\DoxyCodeLine{63 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a15e6e1208d6496fe34493e3d24039574}{s2n\_hmac\_is\_available}}(\mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} alg);}
\DoxyCodeLine{64 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a101eb64f136195ba8e538822967eb47c}{s2n\_hmac\_hash\_alg}}(\mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} hmac\_alg, \mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} *out);}
\DoxyCodeLine{65 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a68e42d89c4d93d68b49657cf84b81a11}{s2n\_hash\_hmac\_alg}}(\mbox{\hyperlink{crypto_2s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5}{s2n\_hash\_algorithm}} hash\_alg, \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} *out);}
\DoxyCodeLine{66 }
\DoxyCodeLine{67 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_aa5699b99d7deb5fb806f95cbb183ae24}{s2n\_hmac\_new}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{68 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_ad5056a3fc151619a2935471a5861fc3d}{s2n\_hmac\_init}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *\mbox{\hyperlink{structstate}{state}}, \mbox{\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm}} alg, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *key, uint32\_t klen);}
\DoxyCodeLine{69 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a9dbba560a1ef91d4c2114c792f221333}{s2n\_hmac\_update}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *\mbox{\hyperlink{structstate}{state}}, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *in, uint32\_t size);}
\DoxyCodeLine{70 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a4501c4b9ea25f86e9c6c0e9d1bd9276b}{s2n\_hmac\_digest}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *\mbox{\hyperlink{structstate}{state}}, \textcolor{keywordtype}{void} *out, uint32\_t size);}
\DoxyCodeLine{71 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a2afcf63a3b7f8fc08957f53b820ad39f}{s2n\_hmac\_digest\_two\_compression\_rounds}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *\mbox{\hyperlink{structstate}{state}}, \textcolor{keywordtype}{void} *out, uint32\_t size);}
\DoxyCodeLine{72 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a7787cefe78aedac6b20db11cc451a433}{s2n\_hmac\_digest\_verify}}(\textcolor{keyword}{const} \textcolor{keywordtype}{void} *\mbox{\hyperlink{namespace_aws_a63d22a0af7bbcae8152004baa4756a4d}{a}}, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *\mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a1a175e87536301df98c805ac0636ad7c}{b}}, uint32\_t \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}});}
\DoxyCodeLine{73 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_ad0c9b2a3fad1f7c88550da48d854ac56}{s2n\_hmac\_free}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{74 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_ac4f30ec554d9a717c6269a5de8ae4acf}{s2n\_hmac\_reset}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *\mbox{\hyperlink{structstate}{state}});}
\DoxyCodeLine{75 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_a6007599a9ecbe64464dc464093931f6a}{s2n\_hmac\_copy}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *to, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}} *from);}
\DoxyCodeLine{76 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_ac45d0ab184572bea3bc7302be582152a}{s2n\_hmac\_save\_evp\_hash\_state}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}}* backup, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}}* hmac);}
\DoxyCodeLine{77 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__hmac_8h_af346d45a5b531628a60b33c099ad6e6e}{s2n\_hmac\_restore\_evp\_hash\_state}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}}* backup, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state}}* hmac);}
\DoxyCodeLine{78 }
\DoxyCodeLine{79 }

\end{DoxyCode}
