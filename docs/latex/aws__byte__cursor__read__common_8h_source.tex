\hypertarget{aws__byte__cursor__read__common_8h_source}{}\doxysection{aws\+\_\+byte\+\_\+cursor\+\_\+read\+\_\+common.\+h}
\label{aws__byte__cursor__read__common_8h_source}\index{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/common/verification/cbmc/include/proof\_helpers/aws\_byte\_cursor\_read\_common.h@{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/common/verification/cbmc/include/proof\_helpers/aws\_byte\_cursor\_read\_common.h}}
\mbox{\hyperlink{aws__byte__cursor__read__common_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{byte__buf_8h}{aws/common/byte\_buf.h}}>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{make__common__data__structures_8h}{proof\_helpers/make\_common\_data\_structures.h}}>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{proof__allocators_8h}{proof\_helpers/proof\_allocators.h}}>}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keywordtype}{void} \mbox{\hyperlink{aws__byte__cursor__read__common_8h_a7198243cc2137dd241c4df21a19a87e3}{aws\_byte\_cursor\_read\_common\_harness}}() \{}
\DoxyCodeLine{11     \textcolor{comment}{/* parameters */}}
\DoxyCodeLine{12     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__byte__cursor}{aws\_byte\_cursor}} cur;}
\DoxyCodeLine{13     \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a0665e41ec72efcba7c916c14e7f8e4c6}{DEST\_TYPE}} *\mbox{\hyperlink{namespacecreate-projects_a30fed16487e895222a4b2a8e95fe2e2f}{dest}} = \mbox{\hyperlink{proof__allocators_8h_aaa127ec3bf84bdf0e9274082aa3c7354}{can\_fail\_malloc}}(\textcolor{keyword}{sizeof}(*\mbox{\hyperlink{namespacecreate-projects_a30fed16487e895222a4b2a8e95fe2e2f}{dest}}));}
\DoxyCodeLine{14 }
\DoxyCodeLine{15     \textcolor{comment}{/* assumptions */}}
\DoxyCodeLine{16     \mbox{\hyperlink{make__common__data__structures_8h_a505d14abe6c1f43f7195d1959b7c9490}{ensure\_byte\_cursor\_has\_allocated\_buffer\_member}}(\&cur);}
\DoxyCodeLine{17     \_\_CPROVER\_assume(\mbox{\hyperlink{byte__buf_8h_a68c5002c108659bd9396fd47c6f3d228}{aws\_byte\_cursor\_is\_valid}}(\&cur));}
\DoxyCodeLine{18     \_\_CPROVER\_assume(cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}} >= \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a1129a31dbaa411488742b5e4cacbef81}{BYTE\_WIDTH}});}
\DoxyCodeLine{19     \_\_CPROVER\_assume(\mbox{\hyperlink{assert_8h_a3440ddda4219e3f0e908828e2a28cfd9}{AWS\_MEM\_IS\_READABLE}}(cur.\mbox{\hyperlink{structaws__byte__cursor_a824ebfad81da6928a703a04fe80f7bb7}{ptr}}, \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a1129a31dbaa411488742b5e4cacbef81}{BYTE\_WIDTH}}));}
\DoxyCodeLine{20     \_\_CPROVER\_assume(\mbox{\hyperlink{namespacecreate-projects_a30fed16487e895222a4b2a8e95fe2e2f}{dest}} != \mbox{\hyperlink{namespace_aws_a41b67e809416e9bd96026fa1f414925d}{NULL}});}
\DoxyCodeLine{21 }
\DoxyCodeLine{22     \textcolor{comment}{/* save current state of the data structure */}}
\DoxyCodeLine{23     \textcolor{keyword}{struct }\mbox{\hyperlink{structaws__byte__cursor}{aws\_byte\_cursor}} old\_cur = cur;}
\DoxyCodeLine{24     \textcolor{keyword}{struct }store\_byte\_from\_buffer old\_byte\_from\_cur;}
\DoxyCodeLine{25     save\_byte\_from\_array(cur.\mbox{\hyperlink{structaws__byte__cursor_a824ebfad81da6928a703a04fe80f7bb7}{ptr}}, cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}}, \&old\_byte\_from\_cur);}
\DoxyCodeLine{26     \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a0665e41ec72efcba7c916c14e7f8e4c6}{DEST\_TYPE}} dest\_copy;}
\DoxyCodeLine{27     \mbox{\hyperlink{memcpy__override_8c_a18d9a75dd16f2db6609538cb4ddedaf1}{memcpy}}(\&dest\_copy, old\_cur.\mbox{\hyperlink{structaws__byte__cursor_a824ebfad81da6928a703a04fe80f7bb7}{ptr}}, \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a1129a31dbaa411488742b5e4cacbef81}{BYTE\_WIDTH}});}
\DoxyCodeLine{28     dest\_copy = \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a478f80e67645e169f65f74a4fa633df7}{AWS\_NTOH}}(dest\_copy);}
\DoxyCodeLine{29 }
\DoxyCodeLine{30     \textcolor{comment}{/* operation under verification */}}
\DoxyCodeLine{31     \textcolor{keywordflow}{if} (\mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a21bcfe3e426d526b7c2a657d766a69f0}{BYTE\_CURSOR\_READ}}(\&cur, \mbox{\hyperlink{namespacecreate-projects_a30fed16487e895222a4b2a8e95fe2e2f}{dest}})) \{}
\DoxyCodeLine{32         assert\_bytes\_match((uint8\_t *)\&dest\_copy, (uint8\_t *)\mbox{\hyperlink{namespacecreate-projects_a30fed16487e895222a4b2a8e95fe2e2f}{dest}}, \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a1129a31dbaa411488742b5e4cacbef81}{BYTE\_WIDTH}});}
\DoxyCodeLine{33         \textcolor{comment}{/* the following assertions are included, because aws\_byte\_cursor\_read internally uses}}
\DoxyCodeLine{34 \textcolor{comment}{         * aws\_byte\_cursor\_advance\_nospec and it copies the bytes from the advanced cursor to *dest}}
\DoxyCodeLine{35 \textcolor{comment}{         */}}
\DoxyCodeLine{36         assert(\mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a1129a31dbaa411488742b5e4cacbef81}{BYTE\_WIDTH}} <= old\_cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}} \&\& old\_cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}} <= (SIZE\_MAX >> 1));}
\DoxyCodeLine{37         assert(cur.\mbox{\hyperlink{structaws__byte__cursor_a824ebfad81da6928a703a04fe80f7bb7}{ptr}} == old\_cur.\mbox{\hyperlink{structaws__byte__cursor_a824ebfad81da6928a703a04fe80f7bb7}{ptr}} + \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a1129a31dbaa411488742b5e4cacbef81}{BYTE\_WIDTH}});}
\DoxyCodeLine{38         assert(cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}} == old\_cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}} -\/ \mbox{\hyperlink{aws__byte__cursor__read__be16__harness_8c_a1129a31dbaa411488742b5e4cacbef81}{BYTE\_WIDTH}});}
\DoxyCodeLine{39     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{40         assert(cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}} == old\_cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}});}
\DoxyCodeLine{41         \textcolor{keywordflow}{if} (cur.\mbox{\hyperlink{structaws__byte__cursor_aa7f3033ab49f70797d55e1de6afe2965}{len}} != 0) \{}
\DoxyCodeLine{42             assert\_byte\_from\_buffer\_matches(cur.\mbox{\hyperlink{structaws__byte__cursor_a824ebfad81da6928a703a04fe80f7bb7}{ptr}}, \&old\_byte\_from\_cur);}
\DoxyCodeLine{43         \}}
\DoxyCodeLine{44     \}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{comment}{/* assertions */}}
\DoxyCodeLine{47     assert(\mbox{\hyperlink{byte__buf_8h_a68c5002c108659bd9396fd47c6f3d228}{aws\_byte\_cursor\_is\_valid}}(\&cur));}
\DoxyCodeLine{48 \}}

\end{DoxyCode}
