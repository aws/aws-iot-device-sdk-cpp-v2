\hypertarget{s2n__connection_8h_source}{}\doxysection{s2n\+\_\+connection.\+h}
\label{s2n__connection_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_connection.h@{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_connection.h}}
\mbox{\hyperlink{s2n__connection_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <errno.h>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{s2n_8h}{s2n.h}}>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <signal.h>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{stdint_8h}{stdint.h}}>}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__stuffer_8h}{stuffer/s2n\_stuffer.h}}"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__client__hello_8h}{tls/s2n\_client\_hello.h}}"{}}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__config_8h}{tls/s2n\_config.h}}"{}}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{tls_2s2n__crypto_8h}{tls/s2n\_crypto.h}}"{}}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__handshake_8h}{tls/s2n\_handshake.h}}"{}}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__prf_8h}{tls/s2n\_prf.h}}"{}}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__tls__parameters_8h}{tls/s2n\_tls\_parameters.h}}"{}}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__x509__validator_8h}{tls/s2n\_x509\_validator.h}}"{}}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__key__update_8h}{tls/s2n\_key\_update.h}}"{}}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__kem__preferences_8h}{tls/s2n\_kem\_preferences.h}}"{}}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__ecc__preferences_8h}{tls/s2n\_ecc\_preferences.h}}"{}}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__security__policies_8h}{tls/s2n\_security\_policies.h}}"{}}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__hash_8h}{crypto/s2n\_hash.h}}"{}}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__hmac_8h}{crypto/s2n\_hmac.h}}"{}}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{preprocessor}{\#include "{}utils/s2n\_mem.h"{}}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#include "{}utils/s2n\_timer.h"{}}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{preprocessor}{\#define S2N\_TLS\_PROTOCOL\_VERSION\_LEN    2}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46 \textcolor{preprocessor}{\#define is\_handshake\_complete(conn) (APPLICATION\_DATA == s2n\_conn\_get\_current\_message\_type(conn))}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{49     \mbox{\hyperlink{s2n__connection_8h_aa54bc347d58b0a9763319705d699ae02a5a13c1901d6faf81361dbb706276a35e}{S2N\_NO\_TICKET}} = 0,}
\DoxyCodeLine{50     \mbox{\hyperlink{s2n__connection_8h_aa54bc347d58b0a9763319705d699ae02a7147445f8494c7bbe7c71188cc0852a4}{S2N\_DECRYPT\_TICKET}},}
\DoxyCodeLine{51     \mbox{\hyperlink{s2n__connection_8h_aa54bc347d58b0a9763319705d699ae02a9019222c114ccb3aa5d1a28903819bb5}{S2N\_NEW\_TICKET}}}
\DoxyCodeLine{52 \} \mbox{\hyperlink{s2n__connection_8h_aa54bc347d58b0a9763319705d699ae02}{s2n\_session\_ticket\_status}};}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection}{s2n\_connection}} \{}
\DoxyCodeLine{55     \textcolor{comment}{/* The configuration (cert, key .. etc ) */}}
\DoxyCodeLine{56     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__config}{s2n\_config}} *\mbox{\hyperlink{structs2n__connection_aa75e2d800e48e9ac65c964e2b5401478}{config}};}
\DoxyCodeLine{57 }
\DoxyCodeLine{58     \textcolor{comment}{/* Overrides Security Policy in config if non-\/null */}}
\DoxyCodeLine{59     \textcolor{keyword}{const} \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__security__policy}{s2n\_security\_policy}} *\mbox{\hyperlink{structs2n__connection_a8379db26924f70d15c61f174ab4a1379}{security\_policy\_override}};}
\DoxyCodeLine{60 }
\DoxyCodeLine{61     \textcolor{comment}{/* The user defined context associated with connection */}}
\DoxyCodeLine{62     \textcolor{keywordtype}{void} *\mbox{\hyperlink{structs2n__connection_af1b21c56d51e1cabd9ee3cee64784662}{context}};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64     \textcolor{comment}{/* The send and receive callbacks don't have to be the same (e.g. two pipes) */}}
\DoxyCodeLine{65     \mbox{\hyperlink{s2n_8h_ad8ae4eeefcfc81bc4daf429512612687}{s2n\_send\_fn}} *\mbox{\hyperlink{structs2n__connection_ad4cff12cbb0eedb0768b794c525b2a90}{send}};}
\DoxyCodeLine{66     \mbox{\hyperlink{s2n_8h_a0b5d6b77e35bf16aee077fe1c5860cc9}{s2n\_recv\_fn}} *\mbox{\hyperlink{structs2n__connection_ad6b754dd178b26844526d97017c25e20}{recv}};}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \textcolor{comment}{/* The context passed to the I/O callbacks */}}
\DoxyCodeLine{69     \textcolor{keywordtype}{void} *\mbox{\hyperlink{structs2n__connection_a1c96dea9b649e756c30a604265d07c07}{send\_io\_context}};}
\DoxyCodeLine{70     \textcolor{keywordtype}{void} *\mbox{\hyperlink{structs2n__connection_a158e4133150a8bb726c30d68a8f8b942}{recv\_io\_context}};}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     \textcolor{comment}{/* Has the user set their own I/O callbacks or is this connection using the}}
\DoxyCodeLine{73 \textcolor{comment}{     * default socket-\/based I/O set by s2n */}}
\DoxyCodeLine{74     uint8\_t \mbox{\hyperlink{structs2n__connection_af9562bc730cbd6754e68c07d1448b981}{managed\_io}};}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{comment}{/* Is this connection using CORK/SO\_RCVLOWAT optimizations? Only valid when the connection is using}}
\DoxyCodeLine{77 \textcolor{comment}{     * managed\_io}}
\DoxyCodeLine{78 \textcolor{comment}{     */}}
\DoxyCodeLine{79     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_acfefbd232fd81d7289c6dccbb9524371}{corked\_io}}:1;}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \textcolor{comment}{/* Session resumption indicator on client side */}}
\DoxyCodeLine{82     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_ae003072fe1fac57662cf375603b78472}{client\_session\_resumed}}:1;}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{comment}{/* Determines if we're currently sending or receiving in s2n\_shutdown */}}
\DoxyCodeLine{85     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_a67bd80288ffb8051296521f7f0ff9c30}{close\_notify\_queued}}:1;}
\DoxyCodeLine{86 }
\DoxyCodeLine{87     \textcolor{comment}{/* s2n does not support renegotiation.}}
\DoxyCodeLine{88 \textcolor{comment}{     * RFC5746 Section 4.3 suggests servers implement a minimal version of the}}
\DoxyCodeLine{89 \textcolor{comment}{     * renegotiation\_info extension even if renegotiation is not supported.}}
\DoxyCodeLine{90 \textcolor{comment}{     * Some clients may fail the handshake if a corresponding renegotiation\_info}}
\DoxyCodeLine{91 \textcolor{comment}{     * extension is not sent back by the server.}}
\DoxyCodeLine{92 \textcolor{comment}{     */}}
\DoxyCodeLine{93     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_a5a13b50329bf4672774f001ba97580a5}{secure\_renegotiation}}:1;}
\DoxyCodeLine{94     \textcolor{comment}{/* Was the EC point formats sent by the client */}}
\DoxyCodeLine{95     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_aeabf47cf83c86adf6861ccfae5f8c669}{ec\_point\_formats}}:1;}
\DoxyCodeLine{96 }
\DoxyCodeLine{97     \textcolor{comment}{/* whether the connection address is ipv6 or not */}}
\DoxyCodeLine{98     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_a3c2c842fdaeddde4f21e16010732a221}{ipv6}}:1;}
\DoxyCodeLine{99 }
\DoxyCodeLine{100     \textcolor{comment}{/* Whether server\_name extension was used to make a decision on cert selection.}}
\DoxyCodeLine{101 \textcolor{comment}{     * RFC6066 Section 3 states that server which used server\_name to make a decision}}
\DoxyCodeLine{102 \textcolor{comment}{     * on certificate or security settings has to send an empty server\_name.}}
\DoxyCodeLine{103 \textcolor{comment}{     */}}
\DoxyCodeLine{104     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_ab2fbfe3af668865ecc6d1c1896b05c3c}{server\_name\_used}}:1;}
\DoxyCodeLine{105 }
\DoxyCodeLine{106     \textcolor{comment}{/* If write fd is broken */}}
\DoxyCodeLine{107     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_aef3ebdc8b2ee61f712ca50d10c518fff}{write\_fd\_broken}}:1;}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     \textcolor{comment}{/* Track request extensions to ensure correct response extension behavior.}}
\DoxyCodeLine{110 \textcolor{comment}{     *}}
\DoxyCodeLine{111 \textcolor{comment}{     * We need to track client and server extensions separately because some}}
\DoxyCodeLine{112 \textcolor{comment}{     * extensions (like request\_status and other Certificate extensions) can}}
\DoxyCodeLine{113 \textcolor{comment}{     * be requested by the client, the server, or both.}}
\DoxyCodeLine{114 \textcolor{comment}{     */}}
\DoxyCodeLine{115     \mbox{\hyperlink{s2n__extension__type_8h_aab5f1a69ceb34fcf4464514cbbb0b738}{s2n\_extension\_bitfield}} \mbox{\hyperlink{structs2n__connection_adacc82057bf6b03e20fe22aef7648712}{extension\_requests\_sent}};}
\DoxyCodeLine{116     \mbox{\hyperlink{s2n__extension__type_8h_aab5f1a69ceb34fcf4464514cbbb0b738}{s2n\_extension\_bitfield}} \mbox{\hyperlink{structs2n__connection_acb5d2a07f8bb23b40d3d03d24f7ef51d}{extension\_requests\_received}};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118     \textcolor{comment}{/* Is this connection a client or a server connection */}}
\DoxyCodeLine{119     \mbox{\hyperlink{s2n_8h_a77a64e3b657f90d221c5faf99c643cdb}{s2n\_mode}} \mbox{\hyperlink{structs2n__connection_a8f9031cdae8b28b7f90d042fae0509ef}{mode}};}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{comment}{/* Does s2n handle the blinding, or does the application */}}
\DoxyCodeLine{122     \mbox{\hyperlink{s2n_8h_a364ad496c9dd42fd3117a2f9d3289e62}{s2n\_blinding}} \mbox{\hyperlink{structs2n__connection_a344d0363f0196610c1c0193d8fad3c23}{blinding}};}
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{comment}{/* A timer to measure the time between record writes */}}
\DoxyCodeLine{125     \textcolor{keyword}{struct }s2n\_timer \mbox{\hyperlink{structs2n__connection_a9b049263a4492430ce83a3f0db9db26c}{write\_timer}};}
\DoxyCodeLine{126 }
\DoxyCodeLine{127     \textcolor{comment}{/* last written time */}}
\DoxyCodeLine{128     uint64\_t \mbox{\hyperlink{structs2n__connection_a54192fd915b20789ce8579ad83c3fd17}{last\_write\_elapsed}};}
\DoxyCodeLine{129 }
\DoxyCodeLine{130     \textcolor{comment}{/* When fatal errors occurs, s2n imposes a pause before}}
\DoxyCodeLine{131 \textcolor{comment}{     * the connection is closed. If non-\/zero, this value tracks}}
\DoxyCodeLine{132 \textcolor{comment}{     * how many nanoseconds to pause -\/ which will be relative to}}
\DoxyCodeLine{133 \textcolor{comment}{     * the write\_timer value. */}}
\DoxyCodeLine{134     uint64\_t \mbox{\hyperlink{structs2n__connection_a7c621098036f555ea535b0c6cf629a6d}{delay}};}
\DoxyCodeLine{135 }
\DoxyCodeLine{136     \textcolor{comment}{/* The session id */}}
\DoxyCodeLine{137     uint8\_t \mbox{\hyperlink{structs2n__connection_ae9c9e192090a42f629e8f3e342af1da7}{session\_id}}[\mbox{\hyperlink{s2n__crypto__constants_8h_a29125d7c5bb81700b27164fbc9c92746}{S2N\_TLS\_SESSION\_ID\_MAX\_LEN}}];}
\DoxyCodeLine{138     uint8\_t \mbox{\hyperlink{structs2n__connection_af91d6cfc157c1644a571f3a4ef20fd93}{session\_id\_len}};}
\DoxyCodeLine{139 }
\DoxyCodeLine{140     \textcolor{comment}{/* The version advertised by the client, by the}}
\DoxyCodeLine{141 \textcolor{comment}{     * server, and the actual version we are currently}}
\DoxyCodeLine{142 \textcolor{comment}{     * speaking. */}}
\DoxyCodeLine{143     uint8\_t \mbox{\hyperlink{structs2n__connection_a4d421c0aa83093aa95a7a6a8f954a566}{client\_hello\_version}};}
\DoxyCodeLine{144     uint8\_t \mbox{\hyperlink{structs2n__connection_a06049aa02fd44cb1685f2864f006797b}{client\_protocol\_version}};}
\DoxyCodeLine{145     uint8\_t \mbox{\hyperlink{structs2n__connection_ab82988e331a8a2870c145021277a2e9f}{server\_protocol\_version}};}
\DoxyCodeLine{146     uint8\_t \mbox{\hyperlink{structs2n__connection_a95ccbc12357c12040153ca620bfbf5b2}{actual\_protocol\_version}};}
\DoxyCodeLine{147 }
\DoxyCodeLine{148     \textcolor{comment}{/* Flag indicating whether a protocol version has been}}
\DoxyCodeLine{149 \textcolor{comment}{     * negotiated yet. */}}
\DoxyCodeLine{150     uint8\_t \mbox{\hyperlink{structs2n__connection_a0e423d713ba72454ecbddac9a95fb29f}{actual\_protocol\_version\_established}};}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \textcolor{comment}{/* Our crypto parameters */}}
\DoxyCodeLine{153     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__crypto__parameters}{s2n\_crypto\_parameters}} \mbox{\hyperlink{structs2n__connection_ad8daf04314e13b29bb3c67e7bb81bcb1}{initial}};}
\DoxyCodeLine{154     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__crypto__parameters}{s2n\_crypto\_parameters}} \mbox{\hyperlink{structs2n__connection_aefe8341c9a107e776d18935fbae5d0d5}{secure}};}
\DoxyCodeLine{155 }
\DoxyCodeLine{156     \textcolor{comment}{/* Which set is the client/server actually using? */}}
\DoxyCodeLine{157     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__crypto__parameters}{s2n\_crypto\_parameters}} *\mbox{\hyperlink{structs2n__connection_a9de6986e260c8a24a1c173c862b0263c}{client}};}
\DoxyCodeLine{158     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__crypto__parameters}{s2n\_crypto\_parameters}} *\mbox{\hyperlink{structs2n__connection_a60c6a1e56990e684e3a6890ca676ac8a}{server}};}
\DoxyCodeLine{159 }
\DoxyCodeLine{160     \textcolor{comment}{/* Contains parameters needed during the handshake phase */}}
\DoxyCodeLine{161     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__handshake__parameters}{s2n\_handshake\_parameters}} \mbox{\hyperlink{structs2n__connection_ac0a1c9aaba954393d753f26179b6c6a3}{handshake\_params}};}
\DoxyCodeLine{162 }
\DoxyCodeLine{163     \textcolor{comment}{/* The PRF needs some storage elements to work with */}}
\DoxyCodeLine{164     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__prf__working__space}{s2n\_prf\_working\_space}} \mbox{\hyperlink{structs2n__connection_a3d38a03ab8bb2fbc1e12d9961e661faf}{prf\_space}};}
\DoxyCodeLine{165 }
\DoxyCodeLine{166     \textcolor{comment}{/* Whether to use client\_cert\_auth\_type stored in s2n\_config or in this s2n\_connection.}}
\DoxyCodeLine{167 \textcolor{comment}{     *}}
\DoxyCodeLine{168 \textcolor{comment}{     * By default the s2n\_connection will defer to s2n\_config-\/>client\_cert\_auth\_type on whether or not to use Client Auth.}}
\DoxyCodeLine{169 \textcolor{comment}{     * But users can override Client Auth at the connection level using s2n\_connection\_set\_client\_auth\_type() without mutating}}
\DoxyCodeLine{170 \textcolor{comment}{     * s2n\_config since s2n\_config can be shared between multiple s2n\_connections. */}}
\DoxyCodeLine{171     uint8\_t \mbox{\hyperlink{structs2n__connection_ab9e61978b01bfa44aed21538e402b033}{client\_cert\_auth\_type\_overridden}};}
\DoxyCodeLine{172 }
\DoxyCodeLine{173     \textcolor{comment}{/* Whether or not the s2n\_connection should require the Client to authenticate itself to the server. Only used if}}
\DoxyCodeLine{174 \textcolor{comment}{     * client\_cert\_auth\_type\_overridden is non-\/zero. */}}
\DoxyCodeLine{175     \mbox{\hyperlink{s2n_8h_a8757c094681bb8151329c8dc067106b8}{s2n\_cert\_auth\_type}} \mbox{\hyperlink{structs2n__connection_a2a4c78c7474f07118cae5017bd5677a4}{client\_cert\_auth\_type}};}
\DoxyCodeLine{176 }
\DoxyCodeLine{177     \textcolor{comment}{/* Our workhorse stuffers, used for buffering the plaintext}}
\DoxyCodeLine{178 \textcolor{comment}{     * and encrypted data in both directions.}}
\DoxyCodeLine{179 \textcolor{comment}{     */}}
\DoxyCodeLine{180     uint8\_t \mbox{\hyperlink{structs2n__connection_a162e2918ea4493930141d3447f40e65b}{header\_in\_data}}[\mbox{\hyperlink{s2n__tls__parameters_8h_a7cc7782f30cb9ee302929d979826c557}{S2N\_TLS\_RECORD\_HEADER\_LENGTH}}];}
\DoxyCodeLine{181     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \mbox{\hyperlink{structs2n__connection_aefef8fa01abd44e997542b87f663b74e}{header\_in}};}
\DoxyCodeLine{182     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \mbox{\hyperlink{structs2n__connection_addca8933098512273dca87e5d8b319dd}{in}};}
\DoxyCodeLine{183     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \mbox{\hyperlink{structs2n__connection_ab7d690d1a02fbd7f5aad682df58a1901}{out}};}
\DoxyCodeLine{184     \textcolor{keyword}{enum} \{ \mbox{\hyperlink{structs2n__connection_ae781c5ea8694bb0f3bd9be70aa08e1ccae67d2491c0d1d9ba4428f60d0a7b4ee3}{ENCRYPTED}}, \mbox{\hyperlink{structs2n__connection_ae781c5ea8694bb0f3bd9be70aa08e1cca9424dc655caf861e1ab8d69eb23373b9}{PLAINTEXT}} \} \mbox{\hyperlink{structs2n__connection_abef3dd3f55c1029bf22e374a3d0aa5d5}{in\_status}};}
\DoxyCodeLine{185 }
\DoxyCodeLine{186     \textcolor{comment}{/* How much of the current user buffer have we already}}
\DoxyCodeLine{187 \textcolor{comment}{     * encrypted and sent or have pending for the wire but have}}
\DoxyCodeLine{188 \textcolor{comment}{     * not acknowledged to the user.}}
\DoxyCodeLine{189 \textcolor{comment}{     */}}
\DoxyCodeLine{190     ssize\_t \mbox{\hyperlink{structs2n__connection_a62e11f3145d58cb6c0c9da44d0fc95f2}{current\_user\_data\_consumed}};}
\DoxyCodeLine{191 }
\DoxyCodeLine{192     \textcolor{comment}{/* An alert may be fragmented across multiple records,}}
\DoxyCodeLine{193 \textcolor{comment}{     * this stuffer is used to re-\/assemble.}}
\DoxyCodeLine{194 \textcolor{comment}{     */}}
\DoxyCodeLine{195     uint8\_t \mbox{\hyperlink{structs2n__connection_a9bbe82ce3dfe9ea619a205a4bcbd9993}{alert\_in\_data}}[\mbox{\hyperlink{s2n__tls__parameters_8h_acf0815e20ae2239c2542f1a429c3dda1}{S2N\_ALERT\_LENGTH}}];}
\DoxyCodeLine{196     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \mbox{\hyperlink{structs2n__connection_a21ae54796a98b4d8083f0948124dd111}{alert\_in}};}
\DoxyCodeLine{197 }
\DoxyCodeLine{198     \textcolor{comment}{/* An alert may be partially written in the outbound}}
\DoxyCodeLine{199 \textcolor{comment}{     * direction, so we keep this as a small 2 byte queue.}}
\DoxyCodeLine{200 \textcolor{comment}{     *}}
\DoxyCodeLine{201 \textcolor{comment}{     * We keep separate queues for alerts generated by}}
\DoxyCodeLine{202 \textcolor{comment}{     * readers (a response to an alert from a peer) and writers (an}}
\DoxyCodeLine{203 \textcolor{comment}{     * intentional shutdown) so that the s2n reader and writer}}
\DoxyCodeLine{204 \textcolor{comment}{     * can be separate duplex I/O threads.}}
\DoxyCodeLine{205 \textcolor{comment}{     */}}
\DoxyCodeLine{206     uint8\_t \mbox{\hyperlink{structs2n__connection_a47015153fd6fa042b12642f8ac107421}{reader\_alert\_out\_data}}[\mbox{\hyperlink{s2n__tls__parameters_8h_acf0815e20ae2239c2542f1a429c3dda1}{S2N\_ALERT\_LENGTH}}];}
\DoxyCodeLine{207     uint8\_t \mbox{\hyperlink{structs2n__connection_aaffd7599067da92896807f80ebd3a820}{writer\_alert\_out\_data}}[\mbox{\hyperlink{s2n__tls__parameters_8h_acf0815e20ae2239c2542f1a429c3dda1}{S2N\_ALERT\_LENGTH}}];}
\DoxyCodeLine{208     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \mbox{\hyperlink{structs2n__connection_a93b05e0bebc13959812feb04d0e938fe}{reader\_alert\_out}};}
\DoxyCodeLine{209     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \mbox{\hyperlink{structs2n__connection_a6dbeeb786c32111b49760bc54f05f7bd}{writer\_alert\_out}};}
\DoxyCodeLine{210 }
\DoxyCodeLine{211     \textcolor{comment}{/* Our handshake state machine */}}
\DoxyCodeLine{212     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__handshake}{s2n\_handshake}} \mbox{\hyperlink{structs2n__connection_a0f83cbb681c8d9c59c58b5d82f0d968e}{handshake}};}
\DoxyCodeLine{213 }
\DoxyCodeLine{214     \textcolor{comment}{/* Maximum outgoing fragment size for this connection. Does not limit}}
\DoxyCodeLine{215 \textcolor{comment}{     * incoming record size.}}
\DoxyCodeLine{216 \textcolor{comment}{     *}}
\DoxyCodeLine{217 \textcolor{comment}{     * This value is updated when:}}
\DoxyCodeLine{218 \textcolor{comment}{     *   1. s2n\_connection\_prefer\_low\_latency is set}}
\DoxyCodeLine{219 \textcolor{comment}{     *   2. s2n\_connection\_prefer\_throughput is set}}
\DoxyCodeLine{220 \textcolor{comment}{     *   3. TLS Maximum Fragment Length extension is negotiated}}
\DoxyCodeLine{221 \textcolor{comment}{     *}}
\DoxyCodeLine{222 \textcolor{comment}{     * Default value: S2N\_DEFAULT\_FRAGMENT\_LENGTH}}
\DoxyCodeLine{223 \textcolor{comment}{     */}}
\DoxyCodeLine{224     uint16\_t \mbox{\hyperlink{structs2n__connection_a01e247ad5dc84c01f2929a1ac6df9063}{max\_outgoing\_fragment\_length}};}
\DoxyCodeLine{225 }
\DoxyCodeLine{226     \textcolor{comment}{/* The number of bytes to send before changing the record size. }}
\DoxyCodeLine{227 \textcolor{comment}{     * If this value > 0 then dynamic TLS record size is enabled. Otherwise, the feature is disabled (default). }}
\DoxyCodeLine{228 \textcolor{comment}{     */}}
\DoxyCodeLine{229     uint32\_t \mbox{\hyperlink{structs2n__connection_aed8b16185503b75e09f4098bf89b0f67}{dynamic\_record\_resize\_threshold}};}
\DoxyCodeLine{230 }
\DoxyCodeLine{231     \textcolor{comment}{/* Reset record size back to a single segment after threshold seconds of inactivity */}}
\DoxyCodeLine{232     uint16\_t \mbox{\hyperlink{structs2n__connection_a2202060f3a422e7b65f7bfec897bdd62}{dynamic\_record\_timeout\_threshold}};}
\DoxyCodeLine{233 }
\DoxyCodeLine{234     \textcolor{comment}{/* number of bytes consumed during application activity */}}
\DoxyCodeLine{235     uint64\_t \mbox{\hyperlink{structs2n__connection_a69b67f75f8599c41d1a6d2ecb2264a79}{active\_application\_bytes\_consumed}};}
\DoxyCodeLine{236 }
\DoxyCodeLine{237     \textcolor{comment}{/* Negotiated TLS extension Maximum Fragment Length code */}}
\DoxyCodeLine{238     uint8\_t \mbox{\hyperlink{structs2n__connection_a45cf8f00e8dfe76ad165a3a0f67102ff}{mfl\_code}};}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     \textcolor{comment}{/* Keep some accounting on each connection */}}
\DoxyCodeLine{241     uint64\_t \mbox{\hyperlink{structs2n__connection_a358a054c2fd5548e701138c338f51deb}{wire\_bytes\_in}};}
\DoxyCodeLine{242     uint64\_t \mbox{\hyperlink{structs2n__connection_a45be651acf1a1384cee942a2363724f2}{wire\_bytes\_out}};}
\DoxyCodeLine{243 }
\DoxyCodeLine{244     \textcolor{comment}{/* Is the connection open or closed ? We use C's only}}
\DoxyCodeLine{245 \textcolor{comment}{     * atomic type as both the reader and the writer threads}}
\DoxyCodeLine{246 \textcolor{comment}{     * may declare a connection closed.}}
\DoxyCodeLine{247 \textcolor{comment}{     *}}
\DoxyCodeLine{248 \textcolor{comment}{     * A connection can be gracefully closed or hard-\/closed.}}
\DoxyCodeLine{249 \textcolor{comment}{     * When gracefully closed the reader or the writer mark}}
\DoxyCodeLine{250 \textcolor{comment}{     * the connection as closing, and then the writer will}}
\DoxyCodeLine{251 \textcolor{comment}{     * send an alert message before closing the connection}}
\DoxyCodeLine{252 \textcolor{comment}{     * and marking it as closed.}}
\DoxyCodeLine{253 \textcolor{comment}{     *}}
\DoxyCodeLine{254 \textcolor{comment}{     * A hard-\/close goes straight to closed with no alert}}
\DoxyCodeLine{255 \textcolor{comment}{     * message being sent.}}
\DoxyCodeLine{256 \textcolor{comment}{     */}}
\DoxyCodeLine{257     sig\_atomic\_t \mbox{\hyperlink{structs2n__connection_a529fc3bb7f5bf5f4d90848b1cf6f083f}{closing}};}
\DoxyCodeLine{258     sig\_atomic\_t \mbox{\hyperlink{structs2n__connection_adbea0c1a6647e32ba469186866927d49}{closed}};}
\DoxyCodeLine{259 }
\DoxyCodeLine{260     \textcolor{comment}{/* TLS extension data */}}
\DoxyCodeLine{261     \textcolor{keywordtype}{char} \mbox{\hyperlink{structs2n__connection_a6d6fcb53603209f9c35ddb87e13573c4}{server\_name}}[\mbox{\hyperlink{s2n__tls__parameters_8h_ac44565170294b74f687996bbc2beba63}{S2N\_MAX\_SERVER\_NAME}} + 1];}
\DoxyCodeLine{262 }
\DoxyCodeLine{263     \textcolor{comment}{/* The application protocol decided upon during the client hello.}}
\DoxyCodeLine{264 \textcolor{comment}{     * If ALPN is being used, then:}}
\DoxyCodeLine{265 \textcolor{comment}{     * In server mode, this will be set by the time client\_hello\_cb is invoked.}}
\DoxyCodeLine{266 \textcolor{comment}{     * In client mode, this will be set after is\_handshake\_complete(connection) is true.}}
\DoxyCodeLine{267 \textcolor{comment}{     */}}
\DoxyCodeLine{268     \textcolor{keywordtype}{char} \mbox{\hyperlink{structs2n__connection_a03eaa8888b506845c4c1e82e11cf69fd}{application\_protocol}}[256];}
\DoxyCodeLine{269 }
\DoxyCodeLine{270     \textcolor{comment}{/* OCSP stapling response data */}}
\DoxyCodeLine{271     \mbox{\hyperlink{s2n_8h_a7d38e45340d223d0100a2d4bc0526635}{s2n\_status\_request\_type}} \mbox{\hyperlink{structs2n__connection_af64a5ebdbde1fe3d3aa39bfed4585d8a}{status\_type}};}
\DoxyCodeLine{272     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__connection_a887849141598a490ed8da83b16f96746}{status\_response}};}
\DoxyCodeLine{273 }
\DoxyCodeLine{274     \textcolor{comment}{/* Certificate Transparency response data */}}
\DoxyCodeLine{275     \mbox{\hyperlink{s2n_8h_ae8f37b612310a3594b019b88ebd8fa1a}{s2n\_ct\_support\_level}} \mbox{\hyperlink{structs2n__connection_a04579480fa29cb9b38736d586a555bac}{ct\_level\_requested}};}
\DoxyCodeLine{276     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__connection_a45c12e19491a1e934a1610989d7cdb44}{ct\_response}};}
\DoxyCodeLine{277 }
\DoxyCodeLine{278     \textcolor{comment}{/* QUIC transport parameters data: https://tools.ietf.org/html/draft-\/ietf-\/quic-\/tls-\/29\#section-\/8.2 */}}
\DoxyCodeLine{279     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__connection_ac505b3515925f07181a84960e1f5b885}{our\_quic\_transport\_parameters}};}
\DoxyCodeLine{280     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__connection_ac9777bbdb0f14c4fe99fe2006acbaa77}{peer\_quic\_transport\_parameters}};}
\DoxyCodeLine{281 }
\DoxyCodeLine{282     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__client__hello}{s2n\_client\_hello}} \mbox{\hyperlink{structs2n__connection_a10c57c50fcc897eb5a9f90a9fc5f4582}{client\_hello}};}
\DoxyCodeLine{283 }
\DoxyCodeLine{284     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__x509__validator}{s2n\_x509\_validator}} \mbox{\hyperlink{structs2n__connection_a9144869d537c0acb3836f242835d2bc9}{x509\_validator}};}
\DoxyCodeLine{285 }
\DoxyCodeLine{286     \textcolor{comment}{/* After a connection is created this is the verification function that should always be used. At init time,}}
\DoxyCodeLine{287 \textcolor{comment}{     * the config should be checked for a verify callback and each connection should default to that. However,}}
\DoxyCodeLine{288 \textcolor{comment}{     * from the user's perspective, it's sometimes simpler to manage state by attaching each validation function/data}}
\DoxyCodeLine{289 \textcolor{comment}{     * to the connection, instead of globally to a single config.*/}}
\DoxyCodeLine{290     \mbox{\hyperlink{s2n_8h_a8aa56850695a02753f726ea9860ec383}{s2n\_verify\_host\_fn}} \mbox{\hyperlink{structs2n__connection_abbb6b20afc660d15bb0e37e6e846ee4c}{verify\_host\_fn}};}
\DoxyCodeLine{291     \textcolor{keywordtype}{void} *\mbox{\hyperlink{structs2n__connection_a5d3326b485ca89ed30b437112886518d}{data\_for\_verify\_host}};}
\DoxyCodeLine{292     uint8\_t \mbox{\hyperlink{structs2n__connection_a64d9288a457ed53559b4c2fd315801b7}{verify\_host\_fn\_overridden}};}
\DoxyCodeLine{293 }
\DoxyCodeLine{294     \textcolor{comment}{/* Session ticket data */}}
\DoxyCodeLine{295     \mbox{\hyperlink{s2n__connection_8h_aa54bc347d58b0a9763319705d699ae02}{s2n\_session\_ticket\_status}} \mbox{\hyperlink{structs2n__connection_a335adfb7257fa32883569203660b6644}{session\_ticket\_status}};}
\DoxyCodeLine{296     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__connection_a6f344d1dc6e94e7f82def66ec80e1e3b}{client\_ticket}};}
\DoxyCodeLine{297     uint32\_t \mbox{\hyperlink{structs2n__connection_a3af0137532e8ef7e5e90abc3ec013b5e}{ticket\_lifetime\_hint}};}
\DoxyCodeLine{298 }
\DoxyCodeLine{299     \textcolor{comment}{/* Session ticket extension from client to attempt to decrypt as the server. */}}
\DoxyCodeLine{300     uint8\_t \mbox{\hyperlink{structs2n__connection_a9705672ead44eabfea04f6811360ab95}{ticket\_ext\_data}}[\mbox{\hyperlink{s2n__resume_8h_aeb793331a0819decb946d10dbecc5a0e}{S2N\_TICKET\_SIZE\_IN\_BYTES}}];}
\DoxyCodeLine{301     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \mbox{\hyperlink{structs2n__connection_acedf072cc45ee3b12a0b7daa9b3b9af2}{client\_ticket\_to\_decrypt}};}
\DoxyCodeLine{302 }
\DoxyCodeLine{303     \textcolor{comment}{/* application protocols overridden */}}
\DoxyCodeLine{304     \textcolor{keyword}{struct }s2n\_blob \mbox{\hyperlink{structs2n__connection_ad758cc7d59ddf3290a825cd1d3843050}{application\_protocols\_overridden}};}
\DoxyCodeLine{305 }
\DoxyCodeLine{306     \textcolor{comment}{/* Cookie extension data */}}
\DoxyCodeLine{307     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} \mbox{\hyperlink{structs2n__connection_a1e6a048461347c882f75e9677fe58f0c}{cookie\_stuffer}};}
\DoxyCodeLine{308 }
\DoxyCodeLine{309     \textcolor{comment}{/* Key update data */}}
\DoxyCodeLine{310     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structs2n__connection_a22476df5ae33b03beafdc42a3930b100}{key\_update\_pending}}:1;}
\DoxyCodeLine{311 }
\DoxyCodeLine{312     \textcolor{comment}{/* Bitmap to represent preferred list of keyshare for client to generate and send keyshares in the ClientHello message.}}
\DoxyCodeLine{313 \textcolor{comment}{     * The least significant bit (lsb), if set, indicates that the client must send an empty keyshare list.}}
\DoxyCodeLine{314 \textcolor{comment}{     * Each bit value in the bitmap indiciates the corresponding curve in the ecc\_preferences list for which a key share needs to be generated.}}
\DoxyCodeLine{315 \textcolor{comment}{     * The order of the curves represented in the bitmap is obtained from the security\_policy-\/>ecc\_preferences.}}
\DoxyCodeLine{316 \textcolor{comment}{     * Setting and manipulating this value requires security\_policy to be configured prior.}}
\DoxyCodeLine{317 \textcolor{comment}{     * */}}
\DoxyCodeLine{318     uint8\_t \mbox{\hyperlink{structs2n__connection_abb59c9f919788fa6dce918d88b5b24fb}{preferred\_key\_shares}};}
\DoxyCodeLine{319 \};}
\DoxyCodeLine{320 }
\DoxyCodeLine{321 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a1c1702970a75cd1a6879829f40492e77}{s2n\_connection\_is\_managed\_corked}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *\mbox{\hyperlink{structs2n__connection}{s2n\_connection}});}
\DoxyCodeLine{322 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a3ee0b87bce5bcd659b7e4ab101714fdf}{s2n\_connection\_is\_client\_auth\_enabled}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *\mbox{\hyperlink{structs2n__connection}{s2n\_connection}});}
\DoxyCodeLine{323 }
\DoxyCodeLine{324 \textcolor{comment}{/* Kill a bad connection */}}
\DoxyCodeLine{325 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a746324b4543d50af7ebedc3ed91fbc57}{s2n\_connection\_kill}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{326 }
\DoxyCodeLine{327 \textcolor{comment}{/* Send/recv a stuffer to/from a connection */}}
\DoxyCodeLine{328 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a60d10402f1a17f1080a50af85de495fa}{s2n\_connection\_send\_stuffer}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, uint32\_t \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}});}
\DoxyCodeLine{329 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_aa09fef2757e14e9bae358aa90212c172}{s2n\_connection\_recv\_stuffer}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__stuffer}{s2n\_stuffer}} *stuffer, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, uint32\_t \mbox{\hyperlink{aws-c-iot_2include_2aws_2iotdevice_2external_2c_j_s_o_n_8h_a0f1e4ab31fd4f3ca4329091911f1f1af}{len}});}
\DoxyCodeLine{330 }
\DoxyCodeLine{331 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_abd1a922e99f7efaa2182553382b36219}{s2n\_connection\_get\_cipher\_preferences}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__cipher__preferences}{s2n\_cipher\_preferences}} **cipher\_preferences);}
\DoxyCodeLine{332 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a7961c8ac81f8fc68f982de66ce31639e}{s2n\_connection\_get\_security\_policy}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__security__policy}{s2n\_security\_policy}} **security\_policy);}
\DoxyCodeLine{333 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a0a21acf27a789aaa4418350185a9732f}{s2n\_connection\_get\_kem\_preferences}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__kem__preferences}{s2n\_kem\_preferences}} **kem\_preferences);}
\DoxyCodeLine{334 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_ae94e144639633c26cc11f465b934c7ef}{s2n\_connection\_get\_signature\_preferences}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__signature__preferences}{s2n\_signature\_preferences}} **signature\_preferences);}
\DoxyCodeLine{335 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a612a4d56638b62797f7bee2721625f20}{s2n\_connection\_get\_ecc\_preferences}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__ecc__preferences}{s2n\_ecc\_preferences}} **ecc\_preferences);}
\DoxyCodeLine{336 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a8c28e2a436292bf53bd9bdf5c73f2bcd}{s2n\_connection\_get\_protocol\_preferences}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} s2n\_blob **protocol\_preferences);}
\DoxyCodeLine{337 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_af0fc5d18abb00e3b39cd5a26b7ff4283}{s2n\_connection\_set\_client\_auth\_type}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \mbox{\hyperlink{s2n_8h_a8757c094681bb8151329c8dc067106b8}{s2n\_cert\_auth\_type}} cert\_auth\_type);}
\DoxyCodeLine{338 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a3564311ca985b9a847682b654d6802a4}{s2n\_connection\_get\_client\_auth\_type}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \mbox{\hyperlink{s2n_8h_a8757c094681bb8151329c8dc067106b8}{s2n\_cert\_auth\_type}} *client\_cert\_auth\_type);}
\DoxyCodeLine{339 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a2ad3cb7bd2c77416c9ae62e737ce200b}{s2n\_connection\_get\_client\_cert\_chain}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, uint8\_t **der\_cert\_chain\_out, uint32\_t *cert\_chain\_len);}
\DoxyCodeLine{340 uint8\_t \mbox{\hyperlink{s2n__connection_8h_aee85e526f23c9cee193ec46c80de86fa}{s2n\_connection\_get\_protocol\_version}}(\textcolor{keyword}{const} \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{341 \textcolor{comment}{/* `none` keyword represents a list of empty keyshares */}}
\DoxyCodeLine{342 \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection_8h_a644c9d74736c0ea0f9405033506beeaa}{s2n\_connection\_set\_keyshare\_by\_name\_for\_testing}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* curve\_name);}

\end{DoxyCode}
