\hypertarget{thread__shared_8c}{}\doxysection{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/common/source/thread\+\_\+shared.c File Reference}
\label{thread__shared_8c}\index{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/common/source/thread\_shared.c@{crt/aws-\/crt-\/cpp/crt/aws-\/c-\/common/source/thread\_shared.c}}
{\ttfamily \#include $<$aws/common/private/thread\+\_\+shared.\+h$>$}\newline
{\ttfamily \#include $<$aws/common/clock.\+h$>$}\newline
{\ttfamily \#include $<$aws/common/condition\+\_\+variable.\+h$>$}\newline
{\ttfamily \#include $<$aws/common/linked\+\_\+list.\+h$>$}\newline
{\ttfamily \#include $<$aws/common/mutex.\+h$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{thread__shared_8c_a9da00f418d9b4c83332da9e54f4b2004}{aws\+\_\+thread\+\_\+increment\+\_\+unjoined\+\_\+count}} (void)
\item 
void \mbox{\hyperlink{thread__shared_8c_adf5afe0e8f3efb85e50463bf982aadb2}{aws\+\_\+thread\+\_\+decrement\+\_\+unjoined\+\_\+count}} (void)
\item 
size\+\_\+t \mbox{\hyperlink{thread__shared_8c_a5964ea886be0e3dbe0b9c11c551c10ab}{aws\+\_\+thread\+\_\+get\+\_\+managed\+\_\+thread\+\_\+count}} (void)
\item 
static \mbox{\hyperlink{preamble_8h_a1062901a7428fdd9c7f180f5e01ea056}{bool}} \mbox{\hyperlink{thread__shared_8c_a2cf207b79f6340376378ebf9f71cddcb}{s\+\_\+one\+\_\+or\+\_\+fewer\+\_\+managed\+\_\+threads\+\_\+unjoined}} (void $\ast$context)
\item 
void \mbox{\hyperlink{thread__shared_8c_aa8781779571eb88f647ebba5b42f9195}{aws\+\_\+thread\+\_\+set\+\_\+managed\+\_\+join\+\_\+timeout\+\_\+ns}} (uint64\+\_\+t timeout\+\_\+in\+\_\+ns)
\item 
void \mbox{\hyperlink{thread__shared_8c_ab267e689cf8788a0a9ea6dcfcba68f93}{aws\+\_\+thread\+\_\+join\+\_\+all\+\_\+managed}} (void)
\item 
void \mbox{\hyperlink{thread__shared_8c_a172ba4846672754862f3975320ff731b}{aws\+\_\+thread\+\_\+pending\+\_\+join\+\_\+add}} (struct \mbox{\hyperlink{structaws__linked__list__node}{aws\+\_\+linked\+\_\+list\+\_\+node}} $\ast$node)
\item 
void \mbox{\hyperlink{thread__shared_8c_a3e58b9aeb25ae61f11861dd6b9c8a008}{aws\+\_\+thread\+\_\+initialize\+\_\+thread\+\_\+management}} (void)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static struct \mbox{\hyperlink{structaws__mutex}{aws\+\_\+mutex}} \mbox{\hyperlink{thread__shared_8c_a6530298433ef493bb48c379bf9277dc1}{s\+\_\+managed\+\_\+thread\+\_\+lock}} = \mbox{\hyperlink{preamble_8h_a82cd305754a1424bf8139695ab9dd6e1}{AWS\+\_\+\+MUTEX\+\_\+\+INIT}}
\item 
static struct \mbox{\hyperlink{structaws__condition__variable}{aws\+\_\+condition\+\_\+variable}} \mbox{\hyperlink{thread__shared_8c_aa26ff297fe492ebf89e345bdaf5e481d}{s\+\_\+managed\+\_\+thread\+\_\+signal}} = \mbox{\hyperlink{condition__variable_8h_a5effb5909f01b8f646e71f1a11e31657}{AWS\+\_\+\+CONDITION\+\_\+\+VARIABLE\+\_\+\+INIT}}
\item 
static uint64\+\_\+t \mbox{\hyperlink{thread__shared_8c_a4587069005778410917324866c56604c}{s\+\_\+default\+\_\+managed\+\_\+join\+\_\+timeout\+\_\+ns}} = 0
\item 
static uint32\+\_\+t \mbox{\hyperlink{thread__shared_8c_a8fe230ba9ddb1f035cf73ab82f56ec23}{s\+\_\+unjoined\+\_\+thread\+\_\+count}} = 0
\item 
static struct \mbox{\hyperlink{structaws__linked__list}{aws\+\_\+linked\+\_\+list}} \mbox{\hyperlink{thread__shared_8c_a9e1e935f5add7d96877d2044acd84496}{s\+\_\+pending\+\_\+join\+\_\+managed\+\_\+threads}}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{thread__shared_8c_adf5afe0e8f3efb85e50463bf982aadb2}\label{thread__shared_8c_adf5afe0e8f3efb85e50463bf982aadb2}} 
\index{thread\_shared.c@{thread\_shared.c}!aws\_thread\_decrement\_unjoined\_count@{aws\_thread\_decrement\_unjoined\_count}}
\index{aws\_thread\_decrement\_unjoined\_count@{aws\_thread\_decrement\_unjoined\_count}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{aws\_thread\_decrement\_unjoined\_count()}{aws\_thread\_decrement\_unjoined\_count()}}
{\footnotesize\ttfamily void aws\+\_\+thread\+\_\+decrement\+\_\+unjoined\+\_\+count (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Decrements the count of unjoined threads in the managed thread system. Used by managed threads and event loop threads. Additional usage requires the user to join corresponding threads themselves and correctly increment/decrement even in the face of launch/join errors.

\mbox{\hyperlink{thread_8h_ad070f3a4af8c56037362ccbae6720091}{aws\+\_\+thread\+\_\+join\+\_\+all\+\_\+managed()}} will not return until this count has gone to zero. \mbox{\Hypertarget{thread__shared_8c_a5964ea886be0e3dbe0b9c11c551c10ab}\label{thread__shared_8c_a5964ea886be0e3dbe0b9c11c551c10ab}} 
\index{thread\_shared.c@{thread\_shared.c}!aws\_thread\_get\_managed\_thread\_count@{aws\_thread\_get\_managed\_thread\_count}}
\index{aws\_thread\_get\_managed\_thread\_count@{aws\_thread\_get\_managed\_thread\_count}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{aws\_thread\_get\_managed\_thread\_count()}{aws\_thread\_get\_managed\_thread\_count()}}
{\footnotesize\ttfamily size\+\_\+t aws\+\_\+thread\+\_\+get\+\_\+managed\+\_\+thread\+\_\+count (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Gets the current managed thread count \mbox{\Hypertarget{thread__shared_8c_a9da00f418d9b4c83332da9e54f4b2004}\label{thread__shared_8c_a9da00f418d9b4c83332da9e54f4b2004}} 
\index{thread\_shared.c@{thread\_shared.c}!aws\_thread\_increment\_unjoined\_count@{aws\_thread\_increment\_unjoined\_count}}
\index{aws\_thread\_increment\_unjoined\_count@{aws\_thread\_increment\_unjoined\_count}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{aws\_thread\_increment\_unjoined\_count()}{aws\_thread\_increment\_unjoined\_count()}}
{\footnotesize\ttfamily void aws\+\_\+thread\+\_\+increment\+\_\+unjoined\+\_\+count (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Increments the count of unjoined threads in the managed thread system. Used by managed threads and event loop threads. Additional usage requires the user to join corresponding threads themselves and correctly increment/decrement even in the face of launch/join errors.

\mbox{\hyperlink{thread_8h_ad070f3a4af8c56037362ccbae6720091}{aws\+\_\+thread\+\_\+join\+\_\+all\+\_\+managed()}} will not return until this count has gone to zero. \mbox{\Hypertarget{thread__shared_8c_a3e58b9aeb25ae61f11861dd6b9c8a008}\label{thread__shared_8c_a3e58b9aeb25ae61f11861dd6b9c8a008}} 
\index{thread\_shared.c@{thread\_shared.c}!aws\_thread\_initialize\_thread\_management@{aws\_thread\_initialize\_thread\_management}}
\index{aws\_thread\_initialize\_thread\_management@{aws\_thread\_initialize\_thread\_management}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{aws\_thread\_initialize\_thread\_management()}{aws\_thread\_initialize\_thread\_management()}}
{\footnotesize\ttfamily void aws\+\_\+thread\+\_\+initialize\+\_\+thread\+\_\+management (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Initializes the managed thread system. Called during library init. \mbox{\Hypertarget{thread__shared_8c_ab267e689cf8788a0a9ea6dcfcba68f93}\label{thread__shared_8c_ab267e689cf8788a0a9ea6dcfcba68f93}} 
\index{thread\_shared.c@{thread\_shared.c}!aws\_thread\_join\_all\_managed@{aws\_thread\_join\_all\_managed}}
\index{aws\_thread\_join\_all\_managed@{aws\_thread\_join\_all\_managed}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{aws\_thread\_join\_all\_managed()}{aws\_thread\_join\_all\_managed()}}
{\footnotesize\ttfamily void aws\+\_\+thread\+\_\+join\+\_\+all\+\_\+managed (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Blocking call that waits for all managed threads to complete their join call. This can only be called from the main thread or a non-\/managed thread.

This gets called automatically from library cleanup.

By default the wait is unbounded, but that default can be overridden via \mbox{\hyperlink{thread_8h_a2a3937766e7167ed28b2e74ef403e80a}{aws\+\_\+thread\+\_\+set\+\_\+managed\+\_\+join\+\_\+timeout\+\_\+ns()}} \mbox{\Hypertarget{thread__shared_8c_a172ba4846672754862f3975320ff731b}\label{thread__shared_8c_a172ba4846672754862f3975320ff731b}} 
\index{thread\_shared.c@{thread\_shared.c}!aws\_thread\_pending\_join\_add@{aws\_thread\_pending\_join\_add}}
\index{aws\_thread\_pending\_join\_add@{aws\_thread\_pending\_join\_add}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{aws\_thread\_pending\_join\_add()}{aws\_thread\_pending\_join\_add()}}
{\footnotesize\ttfamily void aws\+\_\+thread\+\_\+pending\+\_\+join\+\_\+add (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structaws__linked__list__node}{aws\+\_\+linked\+\_\+list\+\_\+node}} $\ast$}]{node }\end{DoxyParamCaption})}

Adds a thread (wrapper embedding a linked list node) to the global list of threads that have run to completion and need a join in order to know that the OS has truly finished with the thread. 
\begin{DoxyParams}{Parameters}
{\em node} & linked list node embedded in the thread wrapper \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{thread__shared_8c_aa8781779571eb88f647ebba5b42f9195}\label{thread__shared_8c_aa8781779571eb88f647ebba5b42f9195}} 
\index{thread\_shared.c@{thread\_shared.c}!aws\_thread\_set\_managed\_join\_timeout\_ns@{aws\_thread\_set\_managed\_join\_timeout\_ns}}
\index{aws\_thread\_set\_managed\_join\_timeout\_ns@{aws\_thread\_set\_managed\_join\_timeout\_ns}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{aws\_thread\_set\_managed\_join\_timeout\_ns()}{aws\_thread\_set\_managed\_join\_timeout\_ns()}}
{\footnotesize\ttfamily void aws\+\_\+thread\+\_\+set\+\_\+managed\+\_\+join\+\_\+timeout\+\_\+ns (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{timeout\+\_\+in\+\_\+ns }\end{DoxyParamCaption})}

Overrides how long, in nanoseconds, that aws\+\_\+thread\+\_\+join\+\_\+all\+\_\+managed will wait for threads to complete. A value of zero will result in an unbounded wait. \mbox{\Hypertarget{thread__shared_8c_a2cf207b79f6340376378ebf9f71cddcb}\label{thread__shared_8c_a2cf207b79f6340376378ebf9f71cddcb}} 
\index{thread\_shared.c@{thread\_shared.c}!s\_one\_or\_fewer\_managed\_threads\_unjoined@{s\_one\_or\_fewer\_managed\_threads\_unjoined}}
\index{s\_one\_or\_fewer\_managed\_threads\_unjoined@{s\_one\_or\_fewer\_managed\_threads\_unjoined}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{s\_one\_or\_fewer\_managed\_threads\_unjoined()}{s\_one\_or\_fewer\_managed\_threads\_unjoined()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{preamble_8h_a1062901a7428fdd9c7f180f5e01ea056}{bool}} s\+\_\+one\+\_\+or\+\_\+fewer\+\_\+managed\+\_\+threads\+\_\+unjoined (\begin{DoxyParamCaption}\item[{void $\ast$}]{context }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{thread__shared_8c_a4587069005778410917324866c56604c}\label{thread__shared_8c_a4587069005778410917324866c56604c}} 
\index{thread\_shared.c@{thread\_shared.c}!s\_default\_managed\_join\_timeout\_ns@{s\_default\_managed\_join\_timeout\_ns}}
\index{s\_default\_managed\_join\_timeout\_ns@{s\_default\_managed\_join\_timeout\_ns}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{s\_default\_managed\_join\_timeout\_ns}{s\_default\_managed\_join\_timeout\_ns}}
{\footnotesize\ttfamily uint64\+\_\+t s\+\_\+default\+\_\+managed\+\_\+join\+\_\+timeout\+\_\+ns = 0\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{thread__shared_8c_a6530298433ef493bb48c379bf9277dc1}\label{thread__shared_8c_a6530298433ef493bb48c379bf9277dc1}} 
\index{thread\_shared.c@{thread\_shared.c}!s\_managed\_thread\_lock@{s\_managed\_thread\_lock}}
\index{s\_managed\_thread\_lock@{s\_managed\_thread\_lock}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{s\_managed\_thread\_lock}{s\_managed\_thread\_lock}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structaws__mutex}{aws\+\_\+mutex}} s\+\_\+managed\+\_\+thread\+\_\+lock = \mbox{\hyperlink{preamble_8h_a82cd305754a1424bf8139695ab9dd6e1}{AWS\+\_\+\+MUTEX\+\_\+\+INIT}}\hspace{0.3cm}{\ttfamily [static]}}

Copyright Amazon.\+com, Inc. or its affiliates. All Rights Reserved. SPDX-\/\+License-\/\+Identifier\+: Apache-\/2.\+0. \mbox{\Hypertarget{thread__shared_8c_aa26ff297fe492ebf89e345bdaf5e481d}\label{thread__shared_8c_aa26ff297fe492ebf89e345bdaf5e481d}} 
\index{thread\_shared.c@{thread\_shared.c}!s\_managed\_thread\_signal@{s\_managed\_thread\_signal}}
\index{s\_managed\_thread\_signal@{s\_managed\_thread\_signal}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{s\_managed\_thread\_signal}{s\_managed\_thread\_signal}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structaws__condition__variable}{aws\+\_\+condition\+\_\+variable}} s\+\_\+managed\+\_\+thread\+\_\+signal = \mbox{\hyperlink{condition__variable_8h_a5effb5909f01b8f646e71f1a11e31657}{AWS\+\_\+\+CONDITION\+\_\+\+VARIABLE\+\_\+\+INIT}}\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{thread__shared_8c_a9e1e935f5add7d96877d2044acd84496}\label{thread__shared_8c_a9e1e935f5add7d96877d2044acd84496}} 
\index{thread\_shared.c@{thread\_shared.c}!s\_pending\_join\_managed\_threads@{s\_pending\_join\_managed\_threads}}
\index{s\_pending\_join\_managed\_threads@{s\_pending\_join\_managed\_threads}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{s\_pending\_join\_managed\_threads}{s\_pending\_join\_managed\_threads}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structaws__linked__list}{aws\+\_\+linked\+\_\+list}} s\+\_\+pending\+\_\+join\+\_\+managed\+\_\+threads\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{thread__shared_8c_a8fe230ba9ddb1f035cf73ab82f56ec23}\label{thread__shared_8c_a8fe230ba9ddb1f035cf73ab82f56ec23}} 
\index{thread\_shared.c@{thread\_shared.c}!s\_unjoined\_thread\_count@{s\_unjoined\_thread\_count}}
\index{s\_unjoined\_thread\_count@{s\_unjoined\_thread\_count}!thread\_shared.c@{thread\_shared.c}}
\doxysubsubsection{\texorpdfstring{s\_unjoined\_thread\_count}{s\_unjoined\_thread\_count}}
{\footnotesize\ttfamily uint32\+\_\+t s\+\_\+unjoined\+\_\+thread\+\_\+count = 0\hspace{0.3cm}{\ttfamily [static]}}

