\hypertarget{s2n__connection__evp__digests_8h_source}{}\doxysection{s2n\+\_\+connection\+\_\+evp\+\_\+digests.\+h}
\label{s2n__connection__evp__digests_8h_source}\index{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_connection\_evp\_digests.h@{crt/aws-\/crt-\/cpp/crt/s2n/tls/s2n\_connection\_evp\_digests.h}}
\mbox{\hyperlink{s2n__connection__evp__digests_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{}).}}
\DoxyCodeLine{5 \textcolor{comment}{ * You may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * A copy of the License is located at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *  http://aws.amazon.com/apache2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * or in the "{}license"{} file accompanying this file. This file is distributed}}
\DoxyCodeLine{11 \textcolor{comment}{ * on an "{}AS IS"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either}}
\DoxyCodeLine{12 \textcolor{comment}{ * express or implied. See the License for the specific language governing}}
\DoxyCodeLine{13 \textcolor{comment}{ * permissions and limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{ */}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__connection_8h}{tls/s2n\_connection.h}}"{}}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__prf_8h}{tls/s2n\_prf.h}}"{}}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{s2n__hash_8h}{crypto/s2n\_hash.h}}"{}}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection__prf__handles}{s2n\_connection\_prf\_handles}} \{}
\DoxyCodeLine{24     \textcolor{comment}{/* TLS PRF HMAC p\_hash */}}
\DoxyCodeLine{25     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}} \mbox{\hyperlink{structs2n__connection__prf__handles_a6e0000ad3f64ae8155a4ba04777440cf}{p\_hash\_s2n\_hmac}};}
\DoxyCodeLine{26 }
\DoxyCodeLine{27     \textcolor{comment}{/* TLS PRF EVP p\_hash */}}
\DoxyCodeLine{28     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__evp__hmac__state}{s2n\_evp\_hmac\_state}} \mbox{\hyperlink{structs2n__connection__prf__handles_aaeeaef012c2a3f286ffc1edcee6a29c6}{p\_hash\_evp\_hmac}};}
\DoxyCodeLine{29 \};}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection__hash__handles}{s2n\_connection\_hash\_handles}} \{}
\DoxyCodeLine{32     \textcolor{comment}{/* Handshake hash states */}}
\DoxyCodeLine{33     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a8f23e28f950e151bf73c262695f117aa}{md5}};}
\DoxyCodeLine{34     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_aba0ba8ca67aece7524094fc3cb17ab53}{sha1}};}
\DoxyCodeLine{35     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_aaa1e12ec279c415d1e289c84a353799f}{sha224}};}
\DoxyCodeLine{36     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_ac2991f6e78d2d155dc0681b4ac3b4423}{sha256}};}
\DoxyCodeLine{37     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a09da3607129e6fdee87469706d5d0853}{sha384}};}
\DoxyCodeLine{38     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a9603106bf902d0e8df15991a94cd922e}{sha512}};}
\DoxyCodeLine{39     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a2ae90736c75dcfa62c9d1856d55409d8}{md5\_sha1}};}
\DoxyCodeLine{40     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a4fbfcd91a1324ba418ddc0e2803346d3}{ccv\_hash\_copy}};}
\DoxyCodeLine{41     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a4e3f16757626e35f3ab8457a86020d0b}{prf\_md5\_hash\_copy}};}
\DoxyCodeLine{42     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a1fe150b2443683bd2c77f77359fd30db}{prf\_sha1\_hash\_copy}};}
\DoxyCodeLine{43     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a8b9e0f31839cc5872534058837245961}{prf\_tls12\_hash\_copy}};}
\DoxyCodeLine{44     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_ad7018231505b2da5ab7df2b3487fd921}{server\_finished\_copy}};}
\DoxyCodeLine{45     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a1d45548ead679928aabd74cab40519ee}{prf\_md5}};}
\DoxyCodeLine{46 }
\DoxyCodeLine{47     \textcolor{comment}{/* SSLv3 PRF hash states */}}
\DoxyCodeLine{48     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a2bd39c101ddefd81f60e0b3960d00dbc}{prf\_sha1}};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{comment}{/* Initial signature hash states */}}
\DoxyCodeLine{51     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a8c133cd1cc030c038ca3e38722366923}{initial\_signature\_hash}};}
\DoxyCodeLine{52     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hash__evp__digest}{s2n\_hash\_evp\_digest}} \mbox{\hyperlink{structs2n__connection__hash__handles_a7c79606d479cb76ea442504ba6de8050}{secure\_signature\_hash}};}
\DoxyCodeLine{53 \};}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{comment}{/* Allocationg new EVP structs is expensive, so we back them up here and reuse them */}}
\DoxyCodeLine{56 \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__connection__hmac__handles}{s2n\_connection\_hmac\_handles}} \{}
\DoxyCodeLine{57     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}} \mbox{\hyperlink{structs2n__connection__hmac__handles_a6cada6cb397def629c0a5b1f2220a321}{initial\_client}};}
\DoxyCodeLine{58     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}} \mbox{\hyperlink{structs2n__connection__hmac__handles_a534d2b2a483ef3a535dd94292c4289c4}{initial\_client\_copy}};}
\DoxyCodeLine{59     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}} \mbox{\hyperlink{structs2n__connection__hmac__handles_a18a4e32354d51a131c4a49abfdb97275}{initial\_server}};}
\DoxyCodeLine{60     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}} \mbox{\hyperlink{structs2n__connection__hmac__handles_ac82e762603d8eb64d73a6da5fa3060a7}{secure\_client}};}
\DoxyCodeLine{61     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}} \mbox{\hyperlink{structs2n__connection__hmac__handles_a9b97ef71979da8a1f103e4da262ce848}{secure\_client\_copy}};}
\DoxyCodeLine{62     \textcolor{keyword}{struct }\mbox{\hyperlink{structs2n__hmac__evp__backup}{s2n\_hmac\_evp\_backup}} \mbox{\hyperlink{structs2n__connection__hmac__handles_a49f4c5e466276632afccb3c5b4ef1df2}{secure\_server}};}
\DoxyCodeLine{63 \};}
\DoxyCodeLine{64 }
\DoxyCodeLine{65 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection__evp__digests_8h_a962cfedf9a5ffad0b2ea7348135a5c97}{s2n\_connection\_save\_prf\_state}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection__prf__handles}{s2n\_connection\_prf\_handles}} *prf\_handles, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{66 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection__evp__digests_8h_a430353277789f762cc3aeaf557c3ed17}{s2n\_connection\_save\_hash\_state}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection__hash__handles}{s2n\_connection\_hash\_handles}} *hash\_handles, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{67 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection__evp__digests_8h_a700bb6f8022aa923a7a4b716032df7cf}{s2n\_connection\_save\_hmac\_state}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection__hmac__handles}{s2n\_connection\_hmac\_handles}} *hmac\_handles, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn);}
\DoxyCodeLine{68 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection__evp__digests_8h_a2a81f93a73b6653aee74974b5891a146}{s2n\_connection\_restore\_prf\_state}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection__prf__handles}{s2n\_connection\_prf\_handles}} *prf\_handles);}
\DoxyCodeLine{69 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection__evp__digests_8h_a010a13ba375937a4808e98e41569edd8}{s2n\_connection\_restore\_hash\_state}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection__hash__handles}{s2n\_connection\_hash\_handles}} *hash\_handles);}
\DoxyCodeLine{70 \textcolor{keyword}{extern} \textcolor{keywordtype}{int} \mbox{\hyperlink{s2n__connection__evp__digests_8h_a08df112c1bdc57311b5b5dad1d0080e1}{s2n\_connection\_restore\_hmac\_state}}(\textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection}{s2n\_connection}} *conn, \textcolor{keyword}{struct} \mbox{\hyperlink{structs2n__connection__hmac__handles}{s2n\_connection\_hmac\_handles}} *hmac\_handles);}

\end{DoxyCode}
